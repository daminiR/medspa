<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxe Medical Spa - Complete System Workflows</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
        }

        .nav-tab {
            padding: 20px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #333;
        }

        .nav-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 40px;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 60px;
        }

        .section-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .section-subtitle {
            font-size: 1.5em;
            color: #555;
            margin: 30px 0 15px;
        }

        /* Workflow Boxes */
        .workflow-container {
            display: grid;
            gap: 20px;
            margin: 30px 0;
        }

        .workflow-row {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .box {
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 20px;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
        }

        .box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .box.app {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        .box.user {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
        }

        .box.action {
            background: #f8f9fa;
            border-color: #28a745;
        }

        .box.automation {
            background: #fff3cd;
            border-color: #ffc107;
            border-style: dashed;
        }

        .box.automation::before {
            content: "‚ö° AUTO";
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ffc107;
            color: #333;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .box.database {
            background: #e7f3ff;
            border-color: #2196F3;
        }

        .box-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .box-subtitle {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .arrow {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }

        .arrow.down {
            writing-mode: vertical-lr;
            margin: 10px auto;
            display: block;
            text-align: center;
        }

        /* App Grid */
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .app-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 3px solid #667eea;
        }

        .app-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .app-card ul {
            list-style: none;
            padding: 0;
        }

        .app-card li {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .app-card li:last-child {
            border-bottom: none;
        }

        .app-card li::before {
            content: "‚úì ";
            color: #28a745;
            font-weight: bold;
            margin-right: 8px;
        }

        /* User Journey */
        .journey {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .journey-step {
            display: flex;
            align-items: start;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .journey-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .journey-content h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .journey-content p {
            color: #666;
            line-height: 1.6;
        }

        .journey-automation {
            background: #fff3cd;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 3px solid #ffc107;
        }

        .journey-automation::before {
            content: "‚ö° ";
            font-weight: bold;
        }

        /* Integration Points */
        .integration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .integration-card {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #667eea;
        }

        .integration-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .integration-card .trigger {
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }

        .integration-card .trigger strong {
            color: #28a745;
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-box {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .workflow-row {
                flex-direction: column;
            }

            .arrow {
                transform: rotate(90deg);
            }

            .nav-tab {
                padding: 15px 20px;
                font-size: 0.9em;
            }
        }

        /* Highlight gaps */
        .gap {
            background: #ffe0e0;
            border-color: #dc3545;
            border-style: dashed;
        }

        .gap::after {
            content: "‚ö†Ô∏è GAP";
            position: absolute;
            top: -10px;
            right: -10px;
            background: #dc3545;
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .note {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
            margin: 20px 0;
        }

        .note strong {
            color: #2196F3;
        }

        /* Edge Cases & Exceptions */
        .box.exception {
            background: #ffe5e5;
            border-color: #ff6b6b;
            border-style: dashed;
            border-width: 2px;
        }

        .box.exception::before {
            content: "‚ö†Ô∏è EDGE";
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff6b6b;
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .box.fallback {
            background: #fff8e1;
            border-color: #ff9800;
            border-width: 2px;
        }

        .box.fallback::before {
            content: "üîÑ FALLBACK";
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff9800;
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .arrow.fallback {
            color: #ff9800;
            opacity: 0.6;
        }

        .arrow.error {
            color: #dc3545;
        }

        /* Collapsible Edge Cases */
        .edge-cases-container {
            margin: 20px 0;
            border: 2px solid #ff9800;
            border-radius: 10px;
            overflow: hidden;
        }

        .edge-cases-header {
            background: linear-gradient(135deg, #ff9800, #ff6b6b);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 1.1em;
        }

        .edge-cases-header:hover {
            background: linear-gradient(135deg, #ff6b6b, #ff9800);
        }

        .edge-cases-header::after {
            content: "‚ñº";
            transition: transform 0.3s;
        }

        .edge-cases-header.collapsed::after {
            transform: rotate(-90deg);
        }

        .edge-cases-content {
            background: #fff8f0;
            padding: 20px;
            display: none;
        }

        .edge-cases-content.expanded {
            display: block;
        }

        .edge-case-item {
            background: white;
            border-left: 4px solid #ff6b6b;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .edge-case-item h5 {
            color: #ff6b6b;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .edge-case-item .problem {
            color: #d32f2f;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .edge-case-item .solution {
            color: #388e3c;
            margin-top: 8px;
        }

        .edge-case-item .solution::before {
            content: "‚úì Solution: ";
            font-weight: bold;
        }

        .edge-case-item .human-needed {
            color: #1976d2;
            margin-top: 8px;
            font-style: italic;
        }

        .edge-case-item .human-needed::before {
            content: "üë§ ";
        }

        /* Reality Check Badges */
        .reality-badge {
            display: inline-block;
            background: #ff6b6b;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-left: 10px;
            font-weight: 600;
        }

        .reality-badge.common {
            background: #ff9800;
        }

        .reality-badge.rare {
            background: #9e9e9e;
        }

        /* Voice AI Specific Styles */
        .hero-voice {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 40px;
            text-align: center;
        }

        .hero-voice h2 {
            font-size: 2.2em;
            margin-bottom: 15px;
        }

        .hero-voice p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .use-case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .use-case-card {
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .use-case-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .use-case-card.high-value {
            border-color: #28a745;
            background: linear-gradient(135deg, #e7f9ed 0%, #ffffff 100%);
        }

        .use-case-card.medium-value {
            border-color: #ffc107;
            background: linear-gradient(135deg, #fff8e1 0%, #ffffff 100%);
        }

        .use-case-card.avoid {
            border-color: #dc3545;
            background: linear-gradient(135deg, #ffe5e5 0%, #ffffff 100%);
        }

        .use-case-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 20px;
        }

        .use-case-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }

        .value-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            white-space: nowrap;
        }

        .value-badge.high {
            background: #28a745;
            color: white;
        }

        .value-badge.medium {
            background: #ffc107;
            color: #333;
        }

        .value-badge.low {
            background: #dc3545;
            color: white;
        }

        .use-case-description {
            color: #666;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .workflow-example {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .workflow-example h4 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .workflow-step {
            display: flex;
            align-items: start;
            margin: 12px 0;
            padding: 12px;
            background: white;
            border-radius: 8px;
        }

        .step-icon {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 0.9em;
        }

        .step-icon.ai {
            background: #f093fb;
        }

        .step-icon.human {
            background: #28a745;
        }

        .benefits-list {
            list-style: none;
            padding: 0;
        }

        .benefits-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .benefits-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.3em;
        }

        .concerns-list {
            list-style: none;
            padding: 0;
        }

        .concerns-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            color: #d32f2f;
        }

        .concerns-list li::before {
            content: "‚ö†";
            position: absolute;
            left: 0;
            font-size: 1.3em;
        }

        .tech-stack {
            background: #e7f3ff;
            border: 2px solid #2196F3;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .tech-stack h3 {
            color: #2196F3;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .tech-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }

        .tech-item strong {
            color: #2196F3;
        }

        .cost-estimate {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .cost-estimate h3 {
            color: #f57c00;
            margin-bottom: 15px;
        }

        .implementation-priority {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 5px solid #667eea;
        }

        .priority-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        /* Implementation Roadmap Specific Styles */
        .currently-building {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .currently-building h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .current-feature-card {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .current-feature-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .current-feature-title {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .status-badge {
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1em;
        }

        .status-not-started { background: #ffe5e5; color: #dc3545; }
        .status-in-progress { background: #fff8e1; color: #ff9800; }
        .status-complete { background: #e8f5e9; color: #28a745; }
        .status-needs-revision { background: #e3f2fd; color: #2196f3; }
        .status-blocked { background: #f5f5f5; color: #757575; }

        .progress-section {
            margin: 20px 0;
        }

        .progress-bar-container {
            background: #e9ecef;
            border-radius: 20px;
            height: 30px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-bar-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .requirements-checklist {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .requirements-checklist h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            background: #f0f0f0;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }

        .checkbox-item.checked {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .expand-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
        }

        .expand-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .feature-details-expanded {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e9ecef;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .detail-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .detail-card h4 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.2em;
        }

        .roadmap-queue {
            margin-top: 40px;
        }

        .queue-item {
            background: white;
            border: 2px solid #e9ecef;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .queue-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .queue-item .priority-number {
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
        }

        .queue-item-content {
            flex: 1;
            margin: 0 20px;
        }

        .queue-item-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .queue-item-meta {
            color: #666;
            font-size: 0.9em;
        }

        .quick-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .quick-link-btn {
            padding: 8px 16px;
            background: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }

        .quick-link-btn:hover {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè• Luxe Medical Spa EMR</h1>
            <p>Complete System Blueprint: Architecture ‚Ä¢ Workflows ‚Ä¢ Voice AI Strategy</p>
            <p style="font-size: 0.95em; opacity: 0.9; margin-top: 10px;">‚úì Ideal Workflows &nbsp; ‚Ä¢ &nbsp; ‚ö†Ô∏è Real-World Edge Cases &nbsp; ‚Ä¢ &nbsp; üîÑ Fallback Mechanisms &nbsp; ‚Ä¢ &nbsp; üé§ Voice AI Integration</p>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="roadmap">üî® Implementation Roadmap</button>
            <button class="nav-tab" data-tab="overview">System Overview</button>
            <button class="nav-tab" data-tab="patient-journey">Patient Journey</button>
            <button class="nav-tab" data-tab="booking">Booking Flows</button>
            <button class="nav-tab" data-tab="treatment">Treatment Flow</button>
            <button class="nav-tab" data-tab="billing">Billing & Payments</button>
            <button class="nav-tab" data-tab="voice-ai">üé§ Voice AI Strategy</button>
            <button class="nav-tab" data-tab="competitors">üèÜ Competitive Analysis</button>
            <button class="nav-tab" data-tab="gaps">Opportunities & Gaps</button>
            <button class="nav-tab" data-tab="integrations">üîå Integrations</button>
            <button class="nav-tab" data-tab="testing">üß™ Testing Checklist</button>
        </div>

        <!-- IMPLEMENTATION ROADMAP TAB -->
        <div class="tab-content active" id="roadmap">
            <div class="section">
                <!-- RECENTLY COMPLETED -->
                <div class="recently-completed" style="margin-bottom: 40px;">
                    <h2 style="color: #28a745;">‚úÖ Recently Completed</h2>
                    <div class="current-feature-card" style="border-left: 5px solid #28a745; background: #f8fff8;">
                        <div class="current-feature-header">
                            <div class="current-feature-title">Virtual Waiting Room - SMS Check-In</div>
                            <div class="status-badge" style="background: #28a745; color: white;">‚úÖ MVP Complete (85%)</div>
                        </div>
                        <p style="color: #666; margin-top: 10px;">Core functionality working: Queue dashboard, patient check-in page, SMS notifications. Edge cases and real-time WebSocket can be added in v1.1.</p>
                        <div style="margin-top: 15px;">
                            <strong>Files Created:</strong>
                            <code style="display: block; background: #e9ecef; padding: 10px; border-radius: 5px; margin-top: 5px; font-size: 0.85em;">
                                waiting-room/page.tsx ‚Ä¢ check-in/page.tsx ‚Ä¢ api/waiting-room/* ‚Ä¢ lib/twilio.ts
                            </code>
                        </div>
                    </div>
                </div>

                <!-- PHASE I: Currently Building -->
                <div class="currently-building">
                    <h2>üéØ PHASE I: Currently Building</h2>
                    <div class="current-feature-card" id="current-feature">
                        <div class="current-feature-header">
                            <div class="current-feature-title">Express Booking - SMS Quick Book with Payment</div>
                            <div class="status-badge status-in-progress">üü° In Progress (0%)</div>
                        </div>

                        <div class="progress-section">
                            <strong>Progress:</strong>
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" style="width: 0%;">0% Complete</div>
                            </div>
                        </div>

                        <p style="color: #666; margin: 15px 0;"><strong>What it does:</strong> Staff creates quick appointment ‚Üí Patient gets SMS link ‚Üí Patient enters info, adds card, accepts policy ‚Üí Booking confirmed. Reduces booking errors and back-and-forth.</p>

                        <button class="expand-btn" onclick="toggleFeatureDetails()">üìã View Full Specs & Checklist</button>

                        <div id="feature-details" style="display: none;" class="feature-details-expanded">
                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>üìã Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Database: Add expressBooking fields to appointments (status: pending/confirmed/expired, expiresAt, linkToken)</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>API: POST /api/express-booking/create - Creates pending appointment + generates unique link</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>API: GET /api/express-booking/[token] - Returns appointment details for patient form</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>API: POST /api/express-booking/[token]/complete - Patient submits form + payment</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>SMS: Send booking link via Twilio when staff creates express booking</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Patient Page: /book/[token] - Mobile-friendly form (name, email, phone, card, policy acceptance)</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Stripe: Collect card on file OR charge deposit</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Staff UI: "Express Book" toggle in appointment creation modal</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Calendar: Show "Pending" appointments with different color/style</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Auto-Expire: Background job cancels expired bookings + sends SMS notification</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Resend Link: Staff can resend SMS if patient didn't receive</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" onchange="updateProgress()">
                                            <span>Manual Complete: Staff can manually mark as confirmed</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="detail-card">
                                    <h4>üîß Technical Specs</h4>
                                    <p><strong>API Endpoints:</strong></p>
                                    <ul class="benefits-list">
                                        <li>POST /api/express-booking/create</li>
                                        <li>GET /api/express-booking/[token]</li>
                                        <li>POST /api/express-booking/[token]/complete</li>
                                        <li>POST /api/express-booking/[token]/resend</li>
                                        <li>POST /api/express-booking/[token]/cancel</li>
                                    </ul>
                                    <p style="margin-top: 15px;"><strong>Database Fields (on appointments):</strong></p>
                                    <ul class="benefits-list">
                                        <li>expressBookingToken: string (unique UUID)</li>
                                        <li>expressBookingStatus: 'pending' | 'confirmed' | 'expired' | 'cancelled'</li>
                                        <li>expressBookingExpiresAt: DateTime</li>
                                        <li>expressBookingSentAt: DateTime</li>
                                        <li>requireDeposit: boolean</li>
                                        <li>depositAmount: number</li>
                                    </ul>
                                    <p style="margin-top: 15px;"><strong>Patient Booking Page:</strong></p>
                                    <ul class="benefits-list">
                                        <li>apps/admin/src/app/book/[token]/page.tsx</li>
                                        <li>Mobile-optimized, works without login</li>
                                        <li>Stripe Elements for card collection</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>üì± Patient Flow</h4>
                                    <ol style="margin-left: 20px; color: #333;">
                                        <li>Receives SMS: "Hi Sarah! Complete your Botox booking: [link]. Expires in 30 min."</li>
                                        <li>Clicks link ‚Üí Opens mobile-friendly form</li>
                                        <li>Enters: Full name, email, phone confirmation</li>
                                        <li>Adds credit card (Stripe Elements)</li>
                                        <li>Reads & accepts cancellation policy</li>
                                        <li>Clicks "Confirm Booking"</li>
                                        <li>Sees confirmation + appointment details</li>
                                        <li>Receives confirmation SMS</li>
                                    </ol>
                                </div>

                                <div class="detail-card">
                                    <h4>üë©‚Äçüíº Staff Flow</h4>
                                    <ol style="margin-left: 20px; color: #333;">
                                        <li>Opens calendar ‚Üí Clicks time slot</li>
                                        <li>Enters: Patient first name, phone, service</li>
                                        <li>Toggles ON "Express Booking"</li>
                                        <li>Optionally sets: Expiry time, deposit required</li>
                                        <li>Clicks "Send Booking Link"</li>
                                        <li>Appointment appears on calendar as "Pending" (yellow)</li>
                                        <li>When patient completes ‚Üí Status changes to "Confirmed" (green)</li>
                                        <li>If expired ‚Üí Status changes to "Cancelled" (red) + slot freed</li>
                                    </ol>
                                </div>
                            </div>

                            <div class="detail-card" style="margin-top: 20px;">
                                <h4>‚ö†Ô∏è Edge Cases</h4>
                                <ul class="concerns-list">
                                    <li>Patient tries to complete after expiry ‚Üí Show "Link expired" + prompt to call clinic</li>
                                    <li>Payment fails ‚Üí Show error, allow retry, don't confirm booking</li>
                                    <li>Patient closes page mid-flow ‚Üí Booking stays pending until expiry</li>
                                    <li>Staff resends link ‚Üí Invalidate old token, generate new one</li>
                                    <li>Duplicate booking attempt ‚Üí Check for existing pending booking first</li>
                                </ul>
                            </div>

                            <div class="detail-card" style="margin-top: 20px;">
                                <h4>üß™ Testing Checklist</h4>
                                <div class="requirements-checklist">
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Staff creates express booking ‚Üí Patient receives SMS with link</span>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Patient completes form ‚Üí Appointment changes to Confirmed</span>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Patient adds card ‚Üí Card saved on file in Stripe</span>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Booking expires ‚Üí Auto-cancelled + patient notified</span>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Staff resends link ‚Üí New link works, old link invalid</span>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox">
                                        <span>Test: Calendar shows Pending vs Confirmed correctly</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE II: High Priority Features -->
                <div class="roadmap-queue">
                    <h2 class="section-title">‚ö° PHASE II: High Priority Features (Competitive & High ROI)</h2>
                    <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Voice AI features and competitive gaps. Click each item to expand and see exact prompt to give Claude Code.</p>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-1')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">1</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üé§ SMS Reply Suggestions (AI-Powered)</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ ROI: Saves 1-2 min per SMS √ó 50-100 texts/day = 1.5-3 hours/day ‚Ä¢ üéØ BUILD ORDER: #18</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-1" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build an AI-powered SMS Reply Suggestions feature for our medical spa EMR.

<b>WHAT IT DOES:</b>
When a patient sends us an SMS, the system should use AI (Claude API) to draft 2-3 appropriate reply options. Staff selects the best option, edits if needed, and sends.

<b>REQUIREMENTS:</b>
1. <b>Backend - AI Integration:</b>
   - Integrate Claude API with HIPAA BAA
   - Create endpoint: POST /api/ai/analyze-sms
   - Create endpoint: POST /api/ai/suggest-reply
   - Analyze patient message for intent (booking, question, concern, complaint, emergency)
   - Analyze sentiment (positive, neutral, negative, urgent)
   - Detect emergency keywords (can't breathe, severe pain, allergic reaction) ‚Üí immediate alert
   - Store conversation context (last 5 messages with this patient)
   - Generate 2-3 contextual reply suggestions

2. <b>Frontend - Staff SMS Dashboard:</b>
   - SMS inbox view showing all patient conversations
   - Click patient ‚Üí Show conversation history
   - When new message arrives:
     * Display patient message
     * Show "AI Suggestions" section with 2-3 reply options
     * Each option has "Use This" button
     * Allow editing before sending
     * Send button
   - Flag urgent messages with red highlight
   - Emergency keywords ‚Üí Show red modal alert

3. <b>Reply Templates by Intent:</b>
   - Booking request ‚Üí "I'd love to book you! What service and when works best?"
   - Rescheduling ‚Üí "No problem! What day/time works better?"
   - Service question ‚Üí "Great question! [Service] is [description]. Want to book a consultation?"
   - Aftercare concern ‚Üí "That's normal! Continue icing 10 min/hour. Call if worsens: (555) 100-0000"
   - Angry/upset ‚Üí "I sincerely apologize. Can I call you in 10 mins to make this right?"
   - Emergency ‚Üí "This may be urgent. If trouble breathing, CALL 911. I'm calling you now."

4. <b>Testing:</b>
   - Test: Patient texts "I want to book Botox" ‚Üí AI suggests 3 booking replies
   - Test: Patient texts "My face is swollen" ‚Üí AI detects urgency, alerts staff
   - Test: Angry message ‚Üí AI suggests empathetic response
   - Test: Emergency keywords ‚Üí Immediate alert modal

<b>DELIVERABLES:</b>
- Claude API integration with HIPAA compliance
- Two API endpoints (analyze-sms, suggest-reply)
- SMS dashboard UI with AI suggestions
- Emergency detection system
- All tests passing

<b>TECH STACK:</b>
- Backend: Next.js API routes
- AI: Claude API (Anthropic)
- Frontend: React
- Database: Prisma + PostgreSQL

Start by creating the backend AI integration endpoints, then the frontend dashboard. Let me know when each part is complete so I can test it.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Claude API integration with HIPAA BAA signed</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/ai/analyze-sms endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/ai/suggest-reply endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Intent analysis (booking, question, concern, emergency)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Sentiment analysis (positive, neutral, negative, urgent)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Emergency keyword detection</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Conversation context storage (last 5 messages)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>SMS inbox UI</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>AI suggestions display (2-3 options)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"Use This" button for each suggestion</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Edit capability before sending</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Urgent message red highlighting</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Emergency alert modal</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 4 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Time per SMS reply: 2-3 min ‚Üí 15-30 sec</li>
                                        <li>50-100 texts/day = 1.5-3 hours saved daily</li>
                                        <li>Staff satisfaction with reply quality</li>
                                        <li>Emergency detection accuracy: 100%</li>
                                        <li>AI suggestion acceptance rate: >60%</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-2')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">2</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üé§ Phone Booking Assistant (Voice AI)</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ ROI: Highest ‚Ä¢ Saves 2-3 min per call √ó 20-30 calls/day ‚Ä¢ üéØ BUILD ORDER: #19</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-2" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a Phone Booking Assistant that uses AI to auto-fill booking forms while front desk is on the phone.

<b>WHAT IT DOES:</b>
When front desk answers a booking call, AI listens in real-time, extracts patient name, service type, preferred date/time, and phone number. It auto-fills the booking form while staff talks. Staff reviews and confirms.

<b>REQUIREMENTS:</b>
1. <b>Backend - Voice Integration:</b>
   - Integrate Twilio Voice API + Stream
   - Integrate OpenAI Whisper API for speech-to-text (~$0.006/min)
   - Create endpoint: POST /api/voice/stream - receives audio stream
   - Create endpoint: POST /api/voice/extract-booking-data
   - Real-time transcription of phone call
   - Extract: patient name, service type, preferred date/time, phone number
   - Return confidence scores for each field (e.g., 95% confident on name)
   - Handle vague requests ("I want Botox soon" ‚Üí flag for manual date selection)

2. <b>Frontend - Live Call Assistant:</b>
   - Add "Live Call Assistant" panel on booking page
   - Real-time transcription display (updates as call progresses)
   - Auto-filled fields show with confidence scores:
     * Patient Name: [auto-filled] (95% confident)
     * Service: [auto-filled] (90% confident)
     * Preferred Date: [auto-filled or "Please clarify with patient"]
     * Phone: [auto-filled] (98% confident)
   - Edit/confirm buttons for each field
   - "Book Appointment" final confirmation button
   - Call summary log saved to patient record

3. <b>AI Data Extraction:</b>
   - Match service names to service catalog (fuzzy matching)
   - Parse dates: "next Tuesday", "this week", "March 15th"
   - Validate phone numbers (format check)
   - Handle multi-turn conversations (patient asks questions mid-booking)

4. <b>HIPAA Compliance:</b>
   - Sign BAA with Twilio, OpenAI Whisper, Claude
   - TLS encryption for audio transmission
   - Delete audio recordings after processing (within 24 hours)
   - Keep only text transcripts
   - Access controls + audit logs

5. <b>Testing:</b>
   - Test: Call "I'm Sarah, I want Botox next Tuesday at 2pm" ‚Üí All fields auto-filled
   - Test: Vague date "sometime this week" ‚Üí Flag for manual selection
   - Test: Service not in catalog ‚Üí Show closest matches
   - Test: 10 real booking calls, measure time savings

<b>DELIVERABLES:</b>
- Twilio Voice + Whisper integration
- Real-time transcription endpoint
- Data extraction endpoint
- Live Call Assistant UI panel
- HIPAA compliance (BAA signed, encryption, deletion policy)
- All tests passing

<b>TECH STACK:</b>
- Twilio Voice API + Stream
- OpenAI Whisper API (speech-to-text)
- Claude API (data extraction)
- Next.js API routes
- React frontend

Start with backend voice streaming, then add data extraction, then frontend panel.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Twilio Voice API + Stream integration</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>OpenAI Whisper API integration</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/voice/stream endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/voice/extract-booking-data endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Real-time transcription working</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Extract patient name with confidence</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Extract service type (match to catalog)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Extract date/time (handle natural language)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Extract phone number (validate format)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Live Call Assistant UI panel</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-filled fields with confidence scores</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Edit/confirm capability</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>HIPAA compliance (BAAs signed)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Audio deletion after 24 hours</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 4 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Time per call: 3-5 min ‚Üí 1-2 min</li>
                                        <li>20-30 calls/day = 40-90 min saved daily</li>
                                        <li>Data accuracy: >90% for name, phone, service</li>
                                        <li>Cost: ~$0.18 per call (Whisper API)</li>
                                        <li>ROI: 2.2x (saves $320/month, costs $141/month)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-3')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">3</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üé§ Treatment Charting Dictation (Voice AI)</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ ROI: High ‚Ä¢ Saves 4-5 min per treatment √ó 30 treatments/day = 2-2.5 hours/day ‚Ä¢ üéØ BUILD ORDER: #20</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-3" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a Treatment Charting Dictation feature for the iPad app that allows practitioners to dictate treatment notes and have AI structure them into SOAP format.

<b>WHAT IT DOES:</b>
During or after treatment, practitioner speaks their notes naturally. AI transcribes and structures into SOAP format (Subjective, Objective, Assessment, Plan). AI extracts product names/quantities and auto-populates the "Products Used" section. Practitioner reviews, edits if needed, and finalizes.

<b>CONTEXT - SOAP Notes Format:</b>
SOAP is the medical standard for treatment documentation:
- <b>S (Subjective):</b> What patient reports - their concerns, symptoms, goals, medical history relevant to today
- <b>O (Objective):</b> What practitioner observes - skin condition, measurements, vitals, areas to treat
- <b>A (Assessment):</b> Clinical evaluation - is patient good candidate, contraindications, risk factors
- <b>P (Plan):</b> Treatment performed - products used, quantities, injection sites, aftercare given, follow-up plan

<b>EXAMPLE DICTATION:</b>
"Patient wants forehead and crow's feet treated. She's been getting Botox for two years with good results. Skin looks good, no bruising or contraindications. I'm treating forehead with 20 units Botox and crow's feet with 12 units each side, total 44 units. Applied ice before and after. Gave her standard Botox aftercare instructions. Plan to follow up in two weeks to assess results."

<b>AI SHOULD STRUCTURE AS:</b>
S: Patient requests treatment for forehead and crow's feet. Previous Botox treatments for 2 years with good results.
O: Skin condition normal, no bruising, no contraindications observed.
A: Appropriate candidate for Botox treatment.
P: Forehead: 20 units Botox. Crow's feet: 12 units per side (24 units total). Total: 44 units. Ice applied pre/post treatment. Standard Botox aftercare instructions provided. Follow-up in 2 weeks.
Products Used: Botox - 44 units

<b>REQUIREMENTS:</b>

1. <b>iPad App - Voice Input UI:</b>
   - Add "Dictate" button on SOAP notes page (apps/treatment-ipad/src/app/chart/[id]/page.tsx)
   - Two modes: "Dictate" (voice) vs "Type" (keyboard) - toggle button
   - When "Dictate" active:
     * Show red recording indicator
     * Display real-time transcription as practitioner speaks
     * "Stop" button to finish dictation
     * Show "Processing..." spinner while AI structures notes
   - Display structured SOAP notes in separate fields (S, O, A, P)
   - Display extracted products in "Products Used" section
   - Allow practitioner to edit any field before finalizing
   - Auto-save every 30 seconds during dictation

2. <b>Backend - Voice Processing:</b>
   - Use Browser Web Speech API (built into Chrome/Safari on iPad) for initial capture
   - Fallback: OpenAI Whisper API for better accuracy (~$0.006/min)
   - Create endpoint: POST /api/ai/transcribe-treatment
   - Create endpoint: POST /api/ai/structure-soap
   - Send transcript to Claude API with prompt: "Structure this treatment note into SOAP format"
   - Return structured JSON: {subjective: "", objective: "", assessment: "", plan: "", products: [{name: "", quantity: "", unit: ""}]}

3. <b>AI Product Extraction:</b>
   - Detect product names: Botox, Dysport, Juvederm, Restylane, Sculptra, Kybella, etc.
   - Extract quantities and units:
     * "20 units Botox" ‚Üí {name: "Botox", quantity: 20, unit: "units"}
     * "1 syringe Juvederm" ‚Üí {name: "Juvederm", quantity: 1, unit: "syringe"}
     * "2 vials Sculptra" ‚Üí {name: "Sculptra", quantity: 2, unit: "vials"}
   - Match product names to inventory (fuzzy matching - handle "Botox" vs "Botulinum Toxin")
   - If product not in inventory: flag for manual review but still add to chart

4. <b>Voice Commands (Optional Enhancement):</b>
   - "Next section" ‚Üí moves cursor from Subjective to Objective, etc.
   - "Add product" ‚Üí opens product entry mode
   - "Correct that" ‚Üí allows re-dictation of last sentence

5. <b>Handling Corrections Mid-Dictation:</b>
   - If practitioner says "Actually, I used 22 units, not 20" ‚Üí AI should update quantity
   - If practitioner says "Scratch that" or "Delete that" ‚Üí AI removes last sentence
   - Keep raw transcript + structured version so practitioner can see what was said

6. <b>Medical Terminology Accuracy:</b>
   - Train/prompt AI to handle common medical terms:
     * Anatomical areas: glabella, nasion, crow's feet, nasolabial folds, marionette lines
     * Medical abbreviations: PRN (as needed), BID (twice daily), QD (once daily)
     * Product names with different spellings
   - If AI is unsure: flag word/phrase with [VERIFY] tag for practitioner review

7. <b>Auto-save & Recovery:</b>
   - Auto-save transcript every 30 seconds to local storage (iPad)
   - If iPad crashes: recover from last auto-save when reopened
   - Sync to server when internet available (offline-first architecture)
   - Show "Unsaved changes" indicator if not synced

8. <b>HIPAA Compliance:</b>
   - Audio can be processed through Whisper API (get BAA from OpenAI)
   - Transcript stored in HIPAA-compliant database
   - No audio files stored permanently (only text transcripts)
   - All processing encrypted in transit (TLS)
   - Audit log: who dictated, when, from what device

9. <b>Testing:</b>
   - Test: Dictate full treatment ‚Üí Verify SOAP structure accuracy (>90%)
   - Test: Dictate product "20 units Botox" ‚Üí Verify extraction: {name: "Botox", quantity: 20, unit: "units"}
   - Test: Say "Actually, change that to 22 units" ‚Üí Verify quantity updates
   - Test: Dictate with background noise ‚Üí Verify transcription still accurate
   - Test: iPad offline ‚Üí Verify auto-save to local storage, sync when back online
   - Test: 10 real treatments with 3 different practitioners ‚Üí Measure time savings and satisfaction

<b>DELIVERABLES:</b>
- "Dictate" button on iPad SOAP notes page
- Real-time transcription display
- AI SOAP structuring (POST /api/ai/structure-soap)
- Product extraction (name, quantity, unit)
- Editable structured notes display (S, O, A, P fields)
- Auto-save every 30 seconds
- Offline support with sync when online
- HIPAA compliance (BAA, encryption, audit logs)
- All 6 tests passing

<b>TECH STACK:</b>
- Frontend: React Native or React (iPad app)
- Voice Input: Browser Web Speech API (primary), OpenAI Whisper API (fallback)
- AI Processing: Claude API (Anthropic) for SOAP structuring
- Backend: Next.js API routes
- Database: Prisma + PostgreSQL
- Offline: IndexedDB or AsyncStorage for local caching

<b>FILE LOCATIONS:</b>
- iPad app charting page: apps/treatment-ipad/src/app/chart/[id]/page.tsx (or similar)
- Backend API: apps/admin/src/app/api/ai/structure-soap/route.ts
- Database: Add fields to Treatment/Chart table for SOAP sections

<b>IMPLEMENTATION ORDER:</b>
1. Add "Dictate" button + voice recording UI on iPad
2. Integrate Browser Web Speech API for transcription
3. Create backend endpoint for SOAP structuring (Claude API)
4. Add product extraction logic
5. Display structured notes in editable fields
6. Implement auto-save and offline support
7. Add HIPAA compliance (encryption, audit logs)
8. Test with real practitioners

Start with the iPad UI and voice recording, then move to backend AI processing. Let me know when each phase is complete so I can test.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>"Dictate" button on iPad SOAP notes page</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Real-time transcription display</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Browser Web Speech API integration</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>OpenAI Whisper API fallback</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/ai/structure-soap endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Claude API integration for SOAP structuring</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Product name extraction (Botox, Juvederm, etc.)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Quantity & unit extraction (20 units, 1 syringe)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Fuzzy matching to inventory catalog</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Editable S-O-A-P fields display</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Handle corrections ("actually, change to 22 units")</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Medical terminology accuracy</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-save every 30 seconds</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Offline support (local storage)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Sync when back online</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>HIPAA compliance (BAA signed, encryption)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Audit logging (who, when, device)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 6 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Charting time: 5-7 min ‚Üí 30-60 sec</li>
                                        <li>30 treatments/day = 2-2.5 hours saved daily</li>
                                        <li>SOAP structuring accuracy: >90%</li>
                                        <li>Product extraction accuracy: >95%</li>
                                        <li>Practitioner satisfaction: 8/10 or higher</li>
                                        <li>Transcription word error rate: <5%</li>
                                        <li>Cost: ~$0.30 per treatment (Whisper + Claude API)</li>
                                    </ul>
                                    <h4 style="margin-top: 20px;">üí° Example Use Case</h4>
                                    <p style="font-size: 0.9em; color: #666; line-height: 1.6;">
                                        Dr. Smith finishes Botox treatment. Instead of typing for 5 minutes, she taps "Dictate", speaks for 1 minute describing the treatment naturally. AI structures it into perfect SOAP format, extracts "44 units Botox" automatically. She reviews, makes one small edit, and finalizes. Total time: 90 seconds vs. 5 minutes.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-4')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">4</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìÖ Calendar Time Blocks</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1 week ‚Ä¢ Competitive Gap ‚Ä¢ Mango Mint has this, we don't ‚Ä¢ Essential for lunch/meetings/PTO ‚Ä¢ üéØ BUILD ORDER: #11</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-4" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a Calendar Time Blocks feature that allows staff and practitioners to block off time on the calendar for lunch, meetings, personal time, and out-of-office.

<b>WHAT IT DOES:</b>
Staff/practitioners can create time blocks on the calendar that prevent bookings during those times. Blocks can be one-time or recurring (e.g., every Tuesday 12-1pm for lunch). Blocks show visually on the calendar with color-coding by type. System prevents patients from booking during blocked times.

<b>WHY WE NEED THIS:</b>
Competitors like Mango Mint have this feature. Right now, we have to manually remember lunch breaks and can't block time for meetings. This leads to double-bookings and scheduling conflicts.

<b>USE CASES:</b>
1. Dr. Smith wants lunch every weekday 12-1pm ‚Üí Create recurring block
2. Front desk has staff meeting every Monday 9-10am ‚Üí Create recurring block
3. Dr. Jones has dental appointment on March 15 at 2pm ‚Üí Create one-time block
4. Practitioner on vacation April 1-7 ‚Üí Create multi-day block
5. Temporary schedule change: Dr. Smith leaving early on Friday ‚Üí Create one-time afternoon block

<b>REQUIREMENTS:</b>

1. <b>Database Schema:</b>
   Create table: calendar_blocks
   Fields:
   - id (UUID, primary key)
   - practitioner_id (foreign key to practitioners table) - which practitioner's calendar
   - location_id (foreign key to locations table, if multi-location)
   - start_time (DateTime) - when block starts
   - end_time (DateTime) - when block ends
   - reason (enum: 'lunch', 'meeting', 'personal', 'out_of_office', 'other')
   - description (text, optional) - e.g., "Dentist appointment"
   - color (string) - hex color for visual display
   - is_recurring (boolean) - is this a recurring block?
   - recurrence_pattern (JSON, nullable) - {frequency: 'daily'|'weekly'|'monthly', days_of_week: [0,1,2,3,4], end_date: DateTime}
   - created_by (foreign key to users table) - who created this block
   - created_at (DateTime)
   - updated_at (DateTime)

2. <b>Frontend - Calendar UI Updates:</b>
   - Existing calendar shows appointments ‚Üí Update to also show time blocks
   - Time blocks render as colored rectangles spanning the blocked time
   - Color-coding by reason:
     * Lunch: Light orange (#FFE0B2)
     * Meeting: Light blue (#BBDEFB)
     * Personal: Light purple (#E1BEE7)
     * Out of Office: Light red (#FFCDD2)
     * Other: Light gray (#E0E0E0)
   - Blocks show on all calendar views: Day view, Week view, Month view
   - Blocks slightly transparent (80% opacity) to differentiate from appointments
   - Hover on block ‚Üí Show tooltip with reason + description
   - Click on block ‚Üí Open "Edit Block" modal

3. <b>Creating a Time Block:</b>
   - Add "Block Time" button on calendar (next to "New Appointment" button)
   - Click "Block Time" ‚Üí Opens "Create Time Block" modal
   - Modal fields:
     * Practitioner: Dropdown (default to selected practitioner on calendar)
     * Date: Date picker
     * Start Time: Time picker (e.g., 12:00 PM)
     * End Time: Time picker (e.g., 1:00 PM)
     * Reason: Dropdown (Lunch, Meeting, Personal, Out of Office, Other)
     * Description: Text input (optional, e.g., "Client consultation")
     * Recurring: Checkbox ‚Üí If checked, show recurrence options
   - Recurrence options (if "Recurring" checked):
     * Frequency: Radio buttons (Daily, Weekly, Monthly)
     * Days of Week: Checkboxes (Mon, Tue, Wed, Thu, Fri, Sat, Sun) - only if Weekly
     * Ends: Radio buttons ("Never", "On date [date picker]", "After X occurrences")
   - "Save" button ‚Üí Validates and creates block(s)

4. <b>Validation & Conflict Detection:</b>
   - Before creating block, check if there are existing appointments during that time
   - If conflicts found:
     * Show warning modal: "There are 2 appointments during this time. Creating this block will not cancel existing appointments. Continue?"
     * Options: "Cancel" or "Create Anyway"
   - If creating recurring block: Check future conflicts for all occurrences
   - If many conflicts (>5): Show count + "View conflicts" link to see list

5. <b>Editing a Time Block:</b>
   - Click on block ‚Üí Opens "Edit Time Block" modal
   - Show all same fields as create, pre-filled
   - If recurring block: Show option "Edit: This block only / This and future blocks / All blocks in series"
   - "Save" button ‚Üí Updates block(s)
   - "Delete" button (red) ‚Üí Prompts for confirmation, then deletes

6. <b>Deleting a Time Block:</b>
   - Click "Delete" in edit modal
   - If one-time block: "Delete this block? [Cancel] [Delete]"
   - If recurring block: "Delete: [This block only] [This and future blocks] [All blocks in series] [Cancel]"
   - After deletion: Remove from calendar immediately

7. <b>Booking Prevention:</b>
   - Update booking flow to check for time blocks
   - Before allowing booking: Query calendar_blocks table for conflicts
   - If selected time slot is blocked:
     * Frontend: Grayed out on availability calendar (not clickable)
     * Backend: API returns 400 error "Time slot unavailable - blocked for [reason]"
   - Online booking portal: Don't show blocked times as available

8. <b>API Endpoints:</b>
   - POST /api/calendar/blocks - Create new time block
   - GET /api/calendar/blocks?practitioner_id=X&start_date=Y&end_date=Z - Get blocks for date range
   - PUT /api/calendar/blocks/:id - Update time block
   - DELETE /api/calendar/blocks/:id - Delete time block
   - POST /api/calendar/blocks/:id/occurrences - For recurring blocks, generate all occurrences

9. <b>Permissions & Security:</b>
   - Practitioners can create blocks on their own calendar
   - Managers/admins can create blocks on any practitioner's calendar
   - Front desk can create blocks with manager approval (optional setting)
   - Regular staff cannot create blocks (optional setting)
   - Audit log: Track who created, edited, deleted each block

10. <b>Recurring Block Logic:</b>
    - When recurring block created: Generate individual block records for next 6 months
    - Daily: Create block for every day until end date
    - Weekly: Create block for selected days of week (e.g., Mon + Wed + Fri)
    - Monthly: Create block on same date each month (e.g., 15th of every month)
    - Cron job: Runs nightly to generate new recurring blocks for next 6 months (rolling window)

11. <b>Multi-Location Support:</b>
    - If your practice has multiple locations: Each block is location-specific
    - Block on Dr. Smith's Downtown calendar doesn't block Westside calendar
    - Dropdown: Select location when creating block

12. <b>Edge Cases to Handle:</b>
    - Block with existing appointments ‚Üí Warning but allow creation
    - Overlapping blocks ‚Üí Warning but allow (e.g., lunch + meeting both at noon)
    - Past date blocks ‚Üí Don't allow (or show warning "This is in the past")
    - All-day block ‚Üí Special case: start_time = 9am, end_time = 6pm (or practice hours)
    - Multi-day block (vacation) ‚Üí Allow end_date > start_date, render across multiple days
    - Timezone handling (if multi-location across timezones) ‚Üí Store in UTC, display in local timezone

13. <b>Visual Design:</b>
    - Time blocks should be visually distinct from appointments
    - Appointments: Solid color, opaque
    - Time blocks: Lighter color, slightly transparent (80% opacity), dashed border
    - Small icon in top-left corner indicating block type: üçΩÔ∏è (lunch), üìÖ (meeting), üèñÔ∏è (out of office)
    - Show practitioner name if viewing multi-practitioner calendar

14. <b>Testing:</b>
    - Test: Create one-time lunch block 12-1pm ‚Üí Block shows on calendar
    - Test: Create recurring weekly block (Mon-Fri 12-1pm) ‚Üí 5 blocks show this week
    - Test: Try to book appointment during blocked time ‚Üí Booking prevented, shows error
    - Test: Edit recurring block "This and future" ‚Üí Only future blocks updated
    - Test: Delete recurring block "All in series" ‚Üí All blocks removed
    - Test: Create block with existing appointment ‚Üí Warning shown but allows creation
    - Test: Block on one practitioner doesn't affect other practitioners
    - Test: Permissions - practitioner can only block own calendar, manager can block anyone's

<b>DELIVERABLES:</b>
- calendar_blocks database table with all fields
- "Block Time" button on calendar
- "Create Time Block" modal with all fields + recurrence
- Blocks display on calendar (day/week/month views) with color-coding
- Edit block functionality
- Delete block functionality (one-time vs. recurring options)
- Booking prevention (frontend + backend validation)
- 4 API endpoints (CREATE, GET, UPDATE, DELETE)
- Recurring block generation logic
- Permissions system
- All 8 tests passing

<b>TECH STACK:</b>
- Backend: Next.js API routes
- Database: Prisma + PostgreSQL
- Frontend: React + Calendar component (existing)
- Styling: Tailwind CSS (or existing styles)

<b>FILE LOCATIONS:</b>
- Database schema: prisma/schema.prisma (add calendar_blocks model)
- API routes: apps/admin/src/app/api/calendar/blocks/route.ts
- Frontend calendar: apps/admin/src/components/Calendar.tsx (or similar)
- Create block modal: apps/admin/src/components/CreateTimeBlockModal.tsx (new file)

<b>IMPLEMENTATION ORDER:</b>
1. Create database schema (calendar_blocks table)
2. Create API endpoints (POST, GET, PUT, DELETE)
3. Add "Block Time" button to calendar UI
4. Create "Create Time Block" modal UI
5. Implement block creation (one-time first, then recurring)
6. Update calendar rendering to show blocks
7. Add edit/delete functionality
8. Implement booking prevention validation
9. Add permissions logic
10. Test all scenarios

Start with database and backend API, then move to frontend UI. Let me know when each phase is complete.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>calendar_blocks database table created</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"Block Time" button on calendar</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"Create Time Block" modal UI</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Practitioner selection dropdown</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Date + time pickers (start/end)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Reason dropdown (lunch, meeting, personal, etc.)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Recurring checkbox + recurrence options</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Conflict detection (warn if existing appointments)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Blocks display on calendar (day/week/month views)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Color-coding by reason type</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Hover tooltip (reason + description)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Click to edit block modal</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Edit options (this only, this and future, all)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Delete with confirmation</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Booking prevention (frontend + backend)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Recurring block generation (next 6 months)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Permissions (practitioners vs. managers)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/calendar/blocks endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>GET /api/calendar/blocks endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>PUT /api/calendar/blocks/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>DELETE /api/calendar/blocks/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 8 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Zero double-bookings during lunch/meetings</li>
                                        <li>Time to create block: <30 seconds</li>
                                        <li>Recurring blocks generate correctly (100% accuracy)</li>
                                        <li>Staff satisfaction: "Much easier to manage schedule"</li>
                                        <li>Competitive parity with Mango Mint</li>
                                    </ul>
                                    <h4 style="margin-top: 20px;">üí° Example Use Cases</h4>
                                    <ul style="font-size: 0.9em; color: #666; line-height: 1.8; list-style: none; padding: 0;">
                                        <li><strong>Daily Lunch:</strong> Dr. Smith clicks "Block Time", selects 12-1pm, checks "Recurring" ‚Üí "Weekly" ‚Üí Mon-Fri ‚Üí "Never ends". Creates 5 blocks per week forever.</li>
                                        <li><strong>Vacation:</strong> Front desk blocks Dr. Jones April 1-7 "Out of Office". System prevents all bookings that week.</li>
                                        <li><strong>Last-Minute Meeting:</strong> Manager needs to block 3-4pm today for emergency staff meeting. Creates block, system warns "2 appointments exist", manager proceeds anyway and manually reschedules those 2 patients.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-5')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">5</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üîÑ Repeating Appointments</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ Competitive Gap ‚Ä¢ Essential for Botox (every 3-4 months) & treatment series (6 laser sessions) ‚Ä¢ üéØ BUILD ORDER: #12</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-5" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a Repeating Appointments feature that allows patients to schedule recurring appointments or treatment series (e.g., Botox every 3 months, or 6 laser sessions 4 weeks apart).

<b>WHAT IT DOES:</b>
When booking an appointment, staff can mark it as "repeating" and set up a series. System creates multiple future appointments automatically with the same service, practitioner, day/time. Supports both maintenance treatments (Botox every 3 months) and treatment series (6 laser sessions). Tracks progress (Session 3 of 6). Offers package pricing discounts.

<b>WHY WE NEED THIS:</b>
- <b>Botox patients:</b> Come back every 3-4 months like clockwork. Currently we manually book each time.
- <b>Laser treatments:</b> Require 6 sessions, 4-6 weeks apart for best results. Patients want all 6 booked upfront.
- <b>Microneedling:</b> Series of 4 treatments, 4 weeks apart.
- <b>Chemical peels:</b> 4-6 treatments, 2-4 weeks apart.
- <b>Revenue benefit:</b> Lock in $1,800 upfront (6 sessions) instead of hoping patient books each time.
- <b>Patient benefit:</b> Secure preferred time slot, package discount, see progress tracking.

<b>REAL-WORLD USE CASES:</b>
1. <b>Botox Maintenance:</b> Sarah gets Botox every 3 months. Books appointment today, staff checks "Repeat every 3 months, 4 times". System creates appointments for March 15, June 15, Sept 15, Dec 15.
2. <b>Laser Hair Removal:</b> John needs 6 sessions, 4 weeks apart. Books session 1, staff checks "Treatment series: 6 sessions, 4 weeks apart". System creates all 6 appointments. Charges $1,200 upfront (package rate) vs. $250/session individually.
3. <b>Flexible Series:</b> Emma doing microneedling (4 sessions). Books session 1, doesn't pre-book the rest. After session 1, staff says "Book your next session?" and creates session 2. Repeat after each visit.
4. <b>Change Series Midway:</b> Patient booked for Tuesdays 2pm, but work schedule changed. Staff edits series, changes all future appointments to Thursdays 5pm.

<b>REQUIREMENTS:</b>

1. <b>Database Schema:</b>
   Create table: appointment_series
   Fields:
   - id (UUID, primary key)
   - patient_id (foreign key)
   - service_id (foreign key) - what service (Laser, Botox, etc.)
   - practitioner_id (foreign key) - same practitioner for all appointments
   - total_sessions (integer) - total number of appointments in series (e.g., 6)
   - completed_sessions (integer, default 0) - how many completed so far
   - interval_weeks (integer) - weeks between appointments (4, 8, 12, 16)
   - interval_type (enum: 'weeks', 'months') - for clarity (4 weeks vs. 1 month)
   - package_price (decimal, nullable) - special pricing for booking all upfront (e.g., $1200 for 6)
   - individual_price (decimal) - regular per-session price (e.g., $250)
   - discount_percent (decimal, nullable) - calculated discount (e.g., 20% off)
   - series_start_date (date) - first appointment date
   - series_end_date (date, nullable) - last appointment date
   - status (enum: 'active', 'completed', 'cancelled', 'paused')
   - booking_mode (enum: 'all_upfront', 'book_as_you_go') - did patient pre-book all or booking after each?
   - notes (text, nullable) - special instructions
   - created_at, updated_at

   Update appointments table:
   - series_id (foreign key, nullable) - links appointment to series
   - session_number (integer, nullable) - 1, 2, 3, 4, 5, 6 (which session in series)
   - is_part_of_series (boolean, default false) - quick filter

2. <b>Frontend - Booking Flow:</b>
   - When creating appointment, add section "Repeat Appointment?"
   - Toggle switch: "Make this a repeating appointment"
   - When toggled ON, show:
     * <b>Type:</b> Radio buttons
       - "Maintenance (same interval)" - for Botox every 3 months
       - "Treatment Series (fixed number)" - for 6 laser sessions
     * <b>Frequency:</b> Dropdown
       - Every 2 weeks
       - Every 4 weeks
       - Every 6 weeks
       - Every 8 weeks
       - Every 3 months
       - Every 4 months
       - Every 6 months
       - Custom (enter weeks or months)
     * <b>Number of Appointments:</b>
       - If "Treatment Series": Number input (default 4, 6, or 8 based on service)
       - If "Maintenance": Number input + "or ongoing" checkbox
     * <b>Booking Mode:</b> Radio buttons
       - "Book all appointments now (recommended)" - creates all appointments immediately
       - "Book next appointment after each visit" - only creates next appointment when current one marked complete
     * <b>Package Pricing:</b> (if "Book all appointments now" selected)
       - Show calculation: "6 sessions √ó $250 = $1,500"
       - Show package discount: "Package rate: $1,200 (20% off)"
       - Checkbox: "Charge package rate now"
     * <b>Preview Calendar:</b> Button "Preview appointments" ‚Üí Shows calendar with all future appointments highlighted before confirming

3. <b>Creating the Series:</b>
   - Click "Save" ‚Üí System validates:
     * Check practitioner availability on all recurring dates
     * Flag any conflicts (practitioner blocked, holidays, unavailable)
     * If conflicts: Show list, allow user to adjust individual dates
   - If validation passes:
     * Create appointment_series record
     * If "Book all upfront": Create all appointments (1 through N)
     * If "Book as you go": Create only appointment #1
     * Link all appointments to series_id
     * Set session_number (1, 2, 3...)
     * Send confirmation SMS/Email listing all appointment dates
   - If package pricing selected:
     * Create invoice for full package amount
     * Mark as "pre-paid" so no charge at each visit

4. <b>Series Dashboard (Patient View):</b>
   - On patient profile, show "Treatment Series" section
   - List all active series:
     * "Laser Hair Removal: Session 3 of 6 (50% complete)"
     * Progress bar showing completion
     * List upcoming appointments with dates
     * "View all" link to see full series details
   - Click on series ‚Üí Opens series detail modal:
     * All appointments with dates and status (Completed ‚úì, Upcoming, Cancelled ‚úó)
     * Before/after photos from each session
     * Treatment notes from each session
     * Total paid vs. remaining balance
     * Option to reschedule future appointments
     * Option to cancel series (with refund calculation)

5. <b>Completing an Appointment in Series:</b>
   - When practitioner marks appointment complete:
     * Update appointment_series.completed_sessions += 1
     * If "book as you go" mode AND not last session: Auto-prompt "Book next session?"
     * Calculate progress: completed / total (e.g., 3/6 = 50%)
     * If last session completed: Update series.status = 'completed'
     * Send "Series progress" SMS: "You've completed 3 of 6 laser sessions! Next session: March 15"

6. <b>Editing a Series:</b>
   - Click on any appointment in series ‚Üí Opens edit modal
   - Show: "This is session 2 of 6 in a series"
   - Edit options:
     * <b>Edit this appointment only:</b> Change date/time/practitioner for just this one
     * <b>Edit this and future appointments:</b> Change all remaining appointments (e.g., change time from 2pm to 5pm)
     * <b>Edit all appointments in series:</b> Change all appointments including past (rare, but allowed)
   - When editing "this and future":
     * Apply changes to all appointments where session_number >= current
     * Preserve completed appointments as-is
   - Validation: Check practitioner availability on new dates

7. <b>Cancelling Mid-Series:</b>
   - Patient wants to cancel after session 3 of 6
   - Options:
     * <b>Cancel remaining appointments only:</b> Keep 1-3, cancel 4-6
     * <b>Cancel entire series:</b> Cancel all (including completed for refund purposes)
   - Refund calculation:
     * If package paid upfront: Refund unused sessions
     * Formula: (total_sessions - completed_sessions) / total_sessions √ó package_price
     * Example: Paid $1,200 for 6, completed 3, refund (6-3)/6 √ó $1,200 = $600
     * Show calculation to patient before confirming
   - Update series.status = 'cancelled'
   - Send cancellation confirmation SMS/Email

8. <b>Handling Practitioner Unavailability:</b>
   - When creating series, system checks practitioner calendar for all dates
   - If practitioner blocked on any date:
     * Flag that date in preview: "‚ö†Ô∏è Dr. Smith unavailable on July 15 (vacation)"
     * Options:
       - Auto-adjust: Move to nearest available date
       - Manual adjust: User selects alternative date
       - Skip: Don't book that session, create 5 instead of 6
   - If many conflicts (>3): Show full list, allow bulk adjustment

9. <b>Holiday/Weekend Handling:</b>
   - System knows major holidays (Dec 25, Jan 1, July 4, Thanksgiving)
   - If recurring date lands on holiday/closed day:
     * Auto-suggest next business day
     * Show warning: "Appointment would be on Dec 25 (closed). Moved to Dec 26."
     * Allow manual override if needed

10. <b>Same Day/Time Preference:</b>
    - Most patients want "same day, same time" (e.g., every Tuesday at 2pm)
    - When creating series, system tries to maintain exact day of week + time
    - If not possible (practitioner unavailable): Suggest closest alternative (same day, different time OR same time, different day)

11. <b>Package Pricing Configuration:</b>
    - In service settings, add "Package Pricing" section:
      * Service: Laser Hair Removal
      * Regular price: $250/session
      * 6-session package: $1,200 (save $300 = 20% off)
      * 8-session package: $1,500 (save $500 = 25% off)
    - When booking series, system auto-suggests package if available
    - Calculate savings and show to patient: "Save $300 by booking 6 sessions today"

12. <b>Series Progress Tracking:</b>
    - Patient portal shows series progress:
      * "Laser Hair Removal: 3 of 6 sessions complete (50%)"
      * Progress bar (visual)
      * Next appointment: March 15, 2024 at 2:00 PM
      * Photos: View before/after comparison across all sessions
    - Practitioner iPad shows series info when checking in patient:
      * "This is Sarah's 4th laser session (of 6)"
      * "Previous treatments: Jan 15, Feb 12, Mar 11"

13. <b>Reminders for Series:</b>
    - Each appointment in series gets its own reminder sequence (T-48hr, T-24hr, T-2hr)
    - Reminders mention series: "Reminder: Laser session 4 of 6 tomorrow at 2pm"
    - After last session: "Congratulations! You've completed all 6 sessions. Here's your before/after comparison."

14. <b>API Endpoints:</b>
    - POST /api/appointments/series - Create new appointment series
    - GET /api/appointments/series?patient_id=X - Get patient's series
    - GET /api/appointments/series/:id - Get series details
    - PUT /api/appointments/series/:id - Update series (edit appointments)
    - DELETE /api/appointments/series/:id - Cancel series
    - POST /api/appointments/series/:id/complete-session - Mark session complete, auto-book next if mode='book_as_you_go'
    - GET /api/appointments/series/:id/progress - Get progress (completed/total, photos, notes)

15. <b>Edge Cases:</b>
    - Patient misses session 3, comes back for session 4 ‚Üí System flags: "Session 3 was missed. Book make-up session?"
    - Patient wants to pause series (going on vacation) ‚Üí Add series.status = 'paused', don't send reminders
    - Treatment requires longer interval based on results ‚Üí Edit series, adjust interval from 4 weeks to 6 weeks for remaining
    - Patient completes series early (results achieved after 4 sessions instead of 6) ‚Üí Mark series complete, cancel remaining, refund
    - Practitioner leaves practice mid-series ‚Üí Reassign all future appointments to new practitioner

16. <b>Testing:</b>
    - Test: Book 6-session laser series, 4 weeks apart ‚Üí All 6 appointments created
    - Test: Complete session 3 ‚Üí Progress shows "3 of 6 (50%)", next appointment reminded
    - Test: Edit series "this and future", change time 2pm‚Üí5pm ‚Üí Only sessions 4-6 updated
    - Test: Cancel after session 3 ‚Üí Refund calculated: $600 (3 unused sessions)
    - Test: Practitioner unavailable on session 5 date ‚Üí Warning shown, manual adjustment required
    - Test: Book-as-you-go mode ‚Üí Only session 1 created, after complete staff sees "Book session 2?" prompt
    - Test: Package pricing ‚Üí $1,200 charged upfront, $0 due at each subsequent visit
    - Test: Patient portal shows series progress correctly

<b>DELIVERABLES:</b>
- appointment_series database table
- Updated appointments table (series_id, session_number, is_part_of_series)
- "Repeat Appointment" toggle in booking modal
- Series creation UI (type, frequency, count, mode, package pricing)
- Preview calendar before confirming
- Series dashboard (patient profile)
- Progress tracking (X of Y complete, %)
- Edit series options (this only, this and future, all)
- Cancel series with refund calculation
- Practitioner unavailability detection
- Holiday auto-adjustment
- Package pricing configuration (service settings)
- 6 API endpoints
- All 8 tests passing

<b>TECH STACK:</b>
- Backend: Next.js API routes
- Database: Prisma + PostgreSQL
- Frontend: React
- Calendar: Existing calendar component

<b>FILE LOCATIONS:</b>
- Database: prisma/schema.prisma (add appointment_series model, update appointments model)
- API: apps/admin/src/app/api/appointments/series/route.ts
- Booking modal: Update existing booking component to add "Repeat" section
- Series dashboard: apps/admin/src/components/SeriesDashboard.tsx (new)
- Patient portal series view: apps/patient-portal/src/app/series/[id]/page.tsx (new)

<b>IMPLEMENTATION ORDER:</b>
1. Create database schema (appointment_series, update appointments)
2. Create API endpoints (POST, GET, PUT, DELETE series)
3. Add "Repeat Appointment" section to booking modal UI
4. Implement series creation (all appointments at once)
5. Add series dashboard to patient profile
6. Implement edit/cancel series functionality
7. Add progress tracking and reminders
8. Implement "book-as-you-go" mode
9. Add package pricing logic
10. Handle edge cases (unavailability, holidays, pausing)
11. Test all scenarios

Start with database and backend series creation, then move to frontend booking UI, then series management. Let me know when each phase is complete.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>appointment_series database table</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Updated appointments table (series_id, session_number)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"Repeat Appointment" toggle in booking modal</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Type selector (Maintenance vs. Treatment Series)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Frequency dropdown (2 weeks, 4 weeks, 3 months, etc.)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Number of appointments input</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Booking mode (all upfront vs. book-as-you-go)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Package pricing display and calculation</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Preview calendar before confirming</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Practitioner availability validation</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Holiday conflict detection</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Series dashboard on patient profile</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Progress tracking (X of Y complete, %)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Edit series options (this only, this and future, all)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Cancel series with refund calculation</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Complete session ‚Üí Auto-update progress</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Book-as-you-go: Prompt for next session after complete</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Series reminders (each appointment gets reminders)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Package pricing configuration (service settings)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/appointments/series endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>GET /api/appointments/series/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>PUT /api/appointments/series/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>DELETE /api/appointments/series/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 8 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Package booking rate: >60% of laser patients book full series</li>
                                        <li>Revenue locked in upfront: ~$1,200/series √ó 20 series/month = $24K</li>
                                        <li>Treatment compliance: Series completion rate >85%</li>
                                        <li>Rebooking time saved: 5 min per patient √ó 50 patients/month = 4+ hours/month</li>
                                        <li>Patient satisfaction: "Love having it all scheduled!"</li>
                                    </ul>
                                    <h4 style="margin-top: 20px;">üí° Real Example</h4>
                                    <p style="font-size: 0.9em; color: #666; line-height: 1.6;">
                                        Sarah books laser session 1. Front desk asks "Want to book all 6 sessions now and save $300?" Sarah says yes. System creates appointments for next 5 months (Feb 1, Mar 1, Apr 5, May 3, Jun 7, Jul 5 - all Wednesdays at 2pm). Charges $1,200 upfront. Sarah gets confirmation SMS listing all 6 dates. After each session, Sarah gets progress update: "Session 3 of 6 complete (50%)! Next: Apr 5." Practice locks in $1,200 revenue immediately instead of hoping Sarah rebooks each time.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('priority-6')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">6</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üë• Group Booking</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 3-4 weeks ‚Ä¢ Competitive Gap ‚Ä¢ Mango Mint 8/10, we have 0/10 ‚Ä¢ For friends, couples, bridal parties ‚Ä¢ üéØ BUILD ORDER: #13</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="priority-6" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a Group Booking feature that allows multiple patients to book appointments together (friends, couples, bridal parties) with group discounts and coordinated scheduling.

<b>WHAT IT DOES:</b>
Staff can create a "group appointment" where multiple patients (2-10) are booked for the same day/time or staggered times. Each person can get a different service (Sarah: Botox, Amy: Filler, Lisa: Facial) or all same service. System manages one coordinator as primary contact for confirmations. Offers group discounts (10% off for 3+ people). Handles individual or group payment. If one person cancels, others continue.

<b>WHY WE NEED THIS:</b>
- <b>Competitive gap:</b> Mango Mint has this (8/10 rating), we don't (0/10)
- <b>Common scenarios:</b> Bride + 4 bridesmaids before wedding, mother-daughter appointments, couples, office groups
- <b>Revenue boost:</b> Group bookings = higher total $ per time slot ($1,500 for 3 people vs. $500 for 1)
- <b>Group discounts drive bookings:</b> "Book 3+ friends, everyone saves 10%"
- <b>Social marketing:</b> Groups share experience on social media (free advertising)

<b>REAL-WORLD USE CASES:</b>
1. <b>Bridal Party:</b> Bride + 4 bridesmaids want pre-wedding treatments. Book for Saturday 10am. Bride gets Botox ($400), 2 bridesmaids get lip filler ($350 each), 2 get facials ($150 each). Total: $1,500. Group discount 10% = $1,350. Bride is coordinator, pays for everyone. All check in separately but linked as group.

2. <b>Couples:</b> Husband and wife both want Botox. Book together for Thursday 6pm (after work). Same service, same time, different practitioners (if available). Individual billing. Both get 10% group discount. Wife is coordinator for confirmations.

3. <b>Mother-Daughter:</b> Mom wants Botox, daughter wants lip filler. Book together Saturday 2pm. Staggered times (Mom 2pm, Daughter 2:30pm, same practitioner). Individual billing. Mom is coordinator.

4. <b>Office Party:</b> 6 coworkers want "spa day" as team building. Mix of services: 3 facials, 2 Botox, 1 filler. Booked for Friday afternoon, staggered every 30 min. Office pays (one invoice). Office manager is coordinator.

<b>REQUIREMENTS:</b>

1. <b>Database Schema:</b>
   Create table: group_appointments
   Fields:
   - id (UUID, primary key)
   - coordinator_patient_id (foreign key) - primary contact person
   - group_name (string, nullable) - e.g., "Sarah's Bridal Party"
   - discount_percent (decimal) - group discount (e.g., 10)
   - discount_amount (decimal) - total $ saved
   - total_original_price (decimal) - sum of all services before discount
   - total_discounted_price (decimal) - after discount
   - payment_mode (enum: 'individual', 'group', 'split') - how they're paying
   - payment_status (enum: 'pending', 'partial', 'paid') - payment tracking
   - coordinator_pays_all (boolean) - true if coordinator paying for everyone
   - status (enum: 'confirmed', 'partially_confirmed', 'cancelled')
   - notes (text, nullable)
   - created_at, updated_at

   Update appointments table:
   - group_id (foreign key, nullable) - links appointment to group
   - is_part_of_group (boolean, default false) - quick filter
   - individual_confirmed (boolean) - did this specific person confirm? (vs. coordinator confirming for all)

2. <b>Frontend - Group Booking Flow:</b>
   - Add "Book Group Appointment" button on calendar (next to "New Appointment")
   - Click ‚Üí Opens "Create Group Booking" modal
   - <b>Step 1: Group Details</b>
     * Group Name: Text input (optional, e.g., "Sarah's Bridal Party")
     * Coordinator: Search patient or create new
     * Number of people: Dropdown (2-10)
   - <b>Step 2: Add Participants</b>
     * For each person:
       - Search existing patient or "Create New Patient"
       - Select service from dropdown
       - Select practitioner (or "Any available")
       - Start time (same for all OR staggered)
     * "Add Another Person" button (up to 10)
     * Remove person button (X)
   - <b>Step 3: Scheduling</b>
     * Date picker
     * Timing options:
       - "All at same time" (requires multiple practitioners if >1 person)
       - "Staggered (15 min apart)"
       - "Staggered (30 min apart)"
       - "Custom times" (select time for each person individually)
     * System validates: Check practitioner availability for all
     * If parallel bookings: Check if enough treatment rooms/practitioners
   - <b>Step 4: Pricing & Discounts</b>
     * Show each person's service + price
     * Subtotal: $X,XXX
     * Group discount (auto-calculated based on number of people):
       - 2 people: 5% off
       - 3-4 people: 10% off
       - 5+ people: 15% off
     * Total after discount: $X,XXX (saved $XXX)
     * Payment mode:
       - "Each person pays individually"
       - "Coordinator pays for everyone"
       - "Split bill evenly"
   - <b>Step 5: Review & Confirm</b>
     * Summary table showing all participants, services, times, prices
     * Total cost breakdown
     * "Confirm Group Booking" button

3. <b>Creating the Group:</b>
   - Click "Confirm" ‚Üí System:
     * Create group_appointments record
     * Create individual appointment for each person
     * Link all appointments to group_id
     * Check practitioner availability (error if conflicts)
     * Calculate total prices and discounts
     * If "coordinator pays all": Create one invoice for full amount
     * If "individual": Create separate invoices per person
     * Send confirmation SMS to coordinator: "Group booking confirmed! 5 people on Saturday at 10am. Total: $1,350"
     * Send individual confirmation SMS to each participant: "You're booked with Sarah's group on Saturday 10am for Botox ($360 after group discount)"

4. <b>Group Dashboard (Coordinator View):</b>
   - On coordinator's patient profile, show "Group Bookings" section
   - List all groups they're coordinating:
     * "Sarah's Bridal Party - 5 people - Sat Mar 15 at 10am"
     * Status: 3 confirmed, 2 pending
     * Total cost: $1,350
   - Click on group ‚Üí Opens group detail modal:
     * List all participants with names, services, times, confirmation status
     * Send reminder to all
     * Add/remove person (if before appointment)
     * Cancel entire group
     * View invoices

5. <b>Individual Check-In & Treatment:</b>
   - Each person in group checks in separately
   - When checking in: System shows "Part of Sarah's group (5 people)"
   - Practitioner iPad shows: "This is Amy, part of Sarah's bridal party group"
   - Each person charted separately
   - Each person's treatment marked complete separately
   - Group appointment not "complete" until all individuals complete

6. <b>Confirmations & Reminders:</b>
   - <b>Coordinator-only mode:</b>
     * All confirmations/reminders go to coordinator only
     * Coordinator replies for entire group: "C" to confirm all
   - <b>Individual mode:</b>
     * Each person gets their own confirmation/reminders
     * Each person can confirm individually
     * Coordinator sees status: "3 of 5 confirmed"
   - T-48hr reminder: "Reminder: Your group appointment (5 people) is Saturday at 10am"
   - T-24hr: "Final reminder: Tomorrow at 10am. 4 of 5 confirmed."
   - T-2hr: "Your group appointment starts in 2 hours!"

7. <b>Cancellations & Changes:</b>
   - <b>One person cancels:</b>
     * Their appointment cancelled
     * Others continue
     * Recalculate group discount (now 4 people instead of 5)
     * Adjust total price
     * Notify coordinator: "Amy cancelled. Your group is now 4 people. New total: $1,215"
   - <b>Coordinator cancels entire group:</b>
     * All appointments cancelled
     * Confirmation sent to all participants
     * Refund issued if paid
   - <b>Reschedule entire group:</b>
     * Change date/time for all
     * Check practitioner availability for all
     * Send update to everyone
   - <b>Add person after booking:</b>
     * Create new appointment, link to group
     * Recalculate discount
     * Send confirmation to new person

8. <b>Group Discount Configuration:</b>
   - In settings, add "Group Discount Rules":
     * 2 people: 5% off
     * 3-4 people: 10% off
     * 5-6 people: 15% off
     * 7+ people: 20% off
   - Can be overridden manually per group
   - Discount applies to each individual's service

9. <b>Payment Handling:</b>
   - <b>Coordinator pays all:</b>
     * Create one invoice with all services
     * Coordinator pays at checkout
     * Each participant shows "$0 due (paid by Sarah)"
   - <b>Individual payment:</b>
     * Each person gets their own invoice
     * Discount applied to each invoice
     * Each person pays at their checkout
   - <b>Split evenly:</b>
     * Total / number of people
     * Each person pays equal share regardless of service cost
     * Useful for office parties where company pays per person

10. <b>Practitioner Assignment:</b>
    - <b>Same practitioner for all:</b> If services allow (all facials)
    - <b>Different practitioners:</b> If parallel (3 people at 2pm = need 3 practitioners)
    - System checks: Do we have 3 available practitioners at 2pm?
    - If not enough: Suggest staggered times
    - Allow manual practitioner assignment per person

11. <b>Treatment Room Capacity:</b>
    - Each location has X treatment rooms
    - If booking 5 people at same time: Check if 5 rooms available
    - If not enough rooms: Error "Only 3 treatment rooms available at this time. Suggest staggering appointments."
    - Allow override if using non-treatment areas (e.g., larger party room)

12. <b>Group Types (Optional Enhancement):</b>
    - Pre-defined group packages:
      * "Bridal Party Package" - 1 bride + 4 bridesmaids, suggested services
      * "Couples Package" - 2 people, same service
      * "Girls Day Out" - 3-6 people, mix of services
    - Each package has suggested services and pricing
    - Staff can select package as template, customize from there

13. <b>API Endpoints:</b>
    - POST /api/appointments/group - Create group booking
    - GET /api/appointments/group/:id - Get group details
    - PUT /api/appointments/group/:id - Update group (add/remove person, change time)
    - DELETE /api/appointments/group/:id - Cancel entire group
    - PUT /api/appointments/group/:id/remove-person - Remove one person from group
    - PUT /api/appointments/group/:id/add-person - Add person to existing group
    - GET /api/appointments/group/:id/status - Get confirmation status (X of Y confirmed)

14. <b>Edge Cases:</b>
    - Group of 10 (max capacity) ‚Üí All 10 need same-time slots ‚Üí May not be possible
    - One person is existing patient, others are new ‚Üí Create new patient records during booking
    - Coordinator is not part of group (office manager booking for employees) ‚Üí Allow coordinator to not have appointment
    - Discount makes price negative (100% discount for promo) ‚Üí Cap at $0, don't allow negative
    - One person's service takes 2 hours, others 30 min ‚Üí Stagger end times, not start times
    - Payment dispute (coordinator paid, but one person wants refund) ‚Üí Refund to coordinator, coordinator handles with group
    - Practitioner calls in sick day-of with group of 5 ‚Üí Reassign all 5 to backup practitioner or reschedule entire group

15. <b>Reporting & Analytics:</b>
    - Track: Average group size
    - Track: Group booking revenue (higher $ per time slot)
    - Track: Most common group types (bridal, couples, friends)
    - Track: Group discount impact on revenue
    - Track: Group cancellation rate vs. individual

16. <b>Testing:</b>
    - Test: Book group of 3 (different services, same time) ‚Üí All 3 appointments created, 10% discount applied
    - Test: One person cancels ‚Üí Discount recalculated for 2 people (5% instead of 10%)
    - Test: Coordinator pays for all ‚Üí One invoice created for total
    - Test: Individual payment ‚Üí 3 separate invoices, each with discount
    - Test: Add 4th person after booking ‚Üí Group updated, discount recalculated to 10%
    - Test: Coordinator cancels entire group ‚Üí All 3 appointments cancelled, refund issued
    - Test: Not enough practitioners for parallel booking ‚Üí Error shown with stagger suggestion
    - Test: Reminders sent to all participants individually

<b>DELIVERABLES:</b>
- group_appointments database table
- Updated appointments table (group_id, is_part_of_group, individual_confirmed)
- "Book Group Appointment" button
- Multi-step group booking modal (5 steps)
- Participant management (add/remove people)
- Scheduling options (same time, staggered, custom)
- Group discount calculator
- Payment mode selector (coordinator pays all, individual, split)
- Group dashboard (coordinator view)
- Individual check-in (shows group affiliation)
- Confirmation/reminder handling (coordinator vs. individual)
- Cancel one person vs. entire group
- Practitioner/room availability validation
- Group discount configuration (settings)
- 7 API endpoints
- All 8 tests passing

<b>TECH STACK:</b>
- Backend: Next.js API routes
- Database: Prisma + PostgreSQL
- Frontend: React
- Calendar: Existing calendar component

<b>FILE LOCATIONS:</b>
- Database: prisma/schema.prisma (add group_appointments model, update appointments)
- API: apps/admin/src/app/api/appointments/group/route.ts
- Group booking modal: apps/admin/src/components/GroupBookingModal.tsx (new)
- Group dashboard: apps/admin/src/components/GroupDashboard.tsx (new)

<b>IMPLEMENTATION ORDER:</b>
1. Create database schema (group_appointments, update appointments)
2. Create API endpoints (POST, GET, PUT, DELETE group)
3. Build "Book Group Appointment" modal UI (5 steps)
4. Implement participant management (add/remove)
5. Add scheduling logic (same time vs. staggered)
6. Implement group discount calculator
7. Add payment mode handling (coordinator pays all, individual, split)
8. Build group dashboard (coordinator view)
9. Implement confirmation/reminder logic
10. Add cancellation logic (one person vs. entire group)
11. Implement practitioner/room availability checks
12. Test all scenarios

Start with database and backend group creation, then build the multi-step booking modal, then group management features. Let me know when each phase is complete.</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Requirements Checklist</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>group_appointments database table</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Updated appointments table (group_id, is_part_of_group)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"Book Group Appointment" button</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 1: Group details (name, coordinator, count)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 2: Add participants (search/create patients)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 2: Service selection per person</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 3: Scheduling (same time, staggered, custom)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 3: Practitioner availability validation</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 3: Treatment room capacity check</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 4: Group discount calculator (2=5%, 3-4=10%, 5+=15%)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 4: Payment mode (coordinator pays, individual, split)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Step 5: Review & confirm summary</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Group dashboard (coordinator view)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Participant list with confirmation status</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Add person after booking</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Remove person from group</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Cancel entire group</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Reschedule entire group</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Individual check-in (shows group affiliation)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Coordinator-only reminders option</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Individual reminders option</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Recalculate discount when person added/removed</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Group discount configuration (settings)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>POST /api/appointments/group endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>GET /api/appointments/group/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>PUT /api/appointments/group/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>DELETE /api/appointments/group/:id endpoint</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All 8 tests passing</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üéØ Success Metrics</h4>
                                    <ul class="benefits-list">
                                        <li>Group bookings: 10-15% of total appointments</li>
                                        <li>Average group size: 3-4 people</li>
                                        <li>Revenue per time slot: $500 (individual) ‚Üí $1,200 (group of 3)</li>
                                        <li>Group discount ROI: Give 10% off, get 3√ó revenue in same slot</li>
                                        <li>Social sharing: Groups post photos ‚Üí free marketing</li>
                                        <li>Competitive parity: Mango Mint level (8/10)</li>
                                    </ul>
                                    <h4 style="margin-top: 20px;">üí° Real Example</h4>
                                    <p style="font-size: 0.9em; color: #666; line-height: 1.6;">
                                        Bride calls: "I want to bring my 4 bridesmaids for pre-wedding treatments on Saturday." Front desk clicks "Book Group", adds bride (Sarah) as coordinator + 4 bridesmaids. Sarah wants Botox ($400), 2 bridesmaids want lip filler ($350 each), 2 want facials ($150 each). Total: $1,500. System applies 15% group discount (5 people) = $1,275. Sarah pays for everyone. All booked for Saturday 10am, staggered every 30 min. Each person gets individual reminder. Group shows on calendar as "Sarah's Bridal Party (5)". After treatments, all 5 post Instagram stories ‚Üí 2,000+ impressions of your spa.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE III: REVIEW & OPTIMIZE EXISTING FEATURES -->
                <div class="roadmap-queue" style="margin-top: 60px;">
                    <h2 class="section-title">üîç PHASE III: Review & Optimize Existing Features</h2>
                    <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Go through every built feature, verify it matches workflows, handles edge cases, and performs optimally. Click each item to expand full checklist.</p>

                    <!-- Calendar & Scheduling -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('calendar-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">7</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìÖ Calendar & Scheduling - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ 15+ edge cases to handle ‚Ä¢ Smart scheduling AI ‚Ä¢ üéØ BUILD ORDER: #1 (START HERE!)</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="calendar-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and optimize the Calendar & Scheduling system. This is NOT about building new features - it's about verifying existing functionality, fixing bugs, handling edge cases, and adding targeted enhancements.

<b>WHAT THIS IS:</b>
A comprehensive audit and optimization of the calendar/booking system. You'll test every feature, implement missing edge case handling, fix any bugs found, and add smart enhancements like visual indicators and better UX.

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything)</b>

1. <b>Multi-Practitioner Calendar Views:</b>
   - Open calendar, test day/week/month views
   - Verify all practitioners show correctly
   - Test switching between views (smooth transition?)
   - Test with 1 practitioner, 5 practitioners, 10 practitioners (performance test)
   - Check: Does calendar lag with many appointments? (Optimize if >500ms load time)
   - Test: Click different dates, verify appointments load correctly
   - <b>If broken/slow:</b> Fix rendering performance, add loading states, optimize database queries

2. <b>Click-to-Book Flow:</b>
   - Click empty time slot on calendar ‚Üí Booking modal opens
   - Test: Pre-filled with correct date/time/practitioner?
   - Test: Can search and select patient
   - Test: Service dropdown works
   - Test: "Save" creates appointment
   - Test: New appointment appears on calendar immediately (no refresh needed)
   - <b>If broken:</b> Fix modal opening, pre-fill logic, or calendar refresh

3. <b>Real-Time Availability:</b>
   - Book appointment for Dr. Smith at 2pm
   - Open booking modal for 2pm again ‚Üí Should show "Time slot unavailable"
   - Test online patient portal: Does 2pm disappear from available slots?
   - Test with multiple users booking simultaneously (race condition test)
   - <b>If broken:</b> Implement proper locking mechanism

4. <b>Double-Booking Prevention:</b>
   - **CRITICAL TEST:** Open 2 browser tabs, try to book same slot simultaneously
   - Expected: First one succeeds, second one sees "Just taken, here are alternatives"
   - Test: Lock time slot for 5 min during "booking in progress"
   - Test: Release lock if booking cancelled or payment fails
   - <b>If broken:</b> Implement database-level locking or transaction handling

5. <b>Auto-Confirmation SMS:</b>
   - Book appointment ‚Üí Verify SMS sent immediately
   - Check SMS content: Has date, time, practitioner name, service, location
   - Test: SMS includes calendar .ics attachment link
   - Test: Reply with "C" to confirm ‚Üí Updates appointment status to "confirmed"
   - <b>If broken:</b> Fix Twilio webhook, check SMS template, verify trigger

6. <b>Appointment Status Tracking:</b>
   - Book appointment ‚Üí Status: "scheduled"
   - Patient confirms ‚Üí Status: "confirmed"
   - Patient checks in ‚Üí Status: "arrived"
   - Treatment starts ‚Üí Status: "in-progress"
   - Treatment done ‚Üí Status: "complete"
   - Test: Each status change triggers correct actions
   - <b>If broken:</b> Fix status update logic, ensure database updates correctly

7. <b>Drag-and-Drop Rescheduling:</b>
   - Drag appointment to different time slot
   - Verify: Updates in database
   - Verify: Patient gets rescheduled confirmation SMS
   - Test: Can't drag to already-booked slot (shows error)
   - <b>If doesn't exist:</b> Add drag-and-drop functionality with calendar library

<b>PART 2: IMPLEMENT EDGE CASE HANDLING (10 Critical Scenarios)</b>

For each edge case, implement the solution if not already there:

1. <b>Race Condition Double Booking:</b>
   - Problem: Two people book same slot at exact same time
   - Solution to implement:
     * When booking starts: Lock slot in database with "reserved_until" timestamp (5 min from now)
     * Other bookings for this slot: Check if locked, if yes show "Just taken"
     * After booking completes: Clear lock
     * Cron job: Clear expired locks every 5 min (for abandoned bookings)
   - Database: Add "reserved_until" column to calendar or create "slot_locks" table
   - Test: Simulate 2 simultaneous bookings ‚Üí Only 1 succeeds

2. <b>Wrong Phone Number Entered:</b>
   - Problem: Typo in phone number ‚Üí Confirmation SMS bounces
   - Solution to implement:
     * Twilio webhook tracks SMS delivery status
     * If status = "failed" or "undelivered": Flag appointment as "UNCONFIRMED - Bad Phone"
     * Dashboard alert: "Appointment has invalid phone number"
     * Staff must call patient to verify
   - Add: Phone number validation (regex check) before booking
   - Test: Enter invalid phone ‚Üí System catches it OR flags after SMS fails

3. <b>Patient Never Confirms:</b>
   - Problem: Patient books but never responds to confirmations ‚Üí Likely no-show
   - Solution to implement:
     * Track confirmation status: "confirmed" vs. "unconfirmed"
     * Escalating reminders: T-48hr (SMS), T-24hr (SMS + Email), T-2hr (Final SMS with "Reply C to confirm")
     * Dashboard: Show appointments with "UNCONFIRMED" badge (yellow warning)
     * Manager reviews unconfirmed appointments daily
     * Calculate no-show risk: Unconfirmed + New patient = 60% risk
   - Test: Book appointment, don't confirm ‚Üí See escalating reminders

4. <b>Service Requires Consultation First:</b>
   - Problem: New patient books laser treatment, but policy requires free consultation first
   - Solution to implement:
     * Mark services as "requires_consultation" in service settings
     * When new patient books high-risk service: Show warning modal
     * "This service requires consultation first. Book consultation instead?"
     * Auto-switch booking to consultation
     * If patient ignores: Staff must call to reschedule
   - Test: New patient tries to book laser ‚Üí Warning shown, switched to consultation

5. <b>Payment Card Declined (Pre-Payment Required):</b>
   - Problem: New patients require pre-payment, card declines ‚Üí Booking fails
   - Solution to implement:
     * Booking form: Collect payment info
     * Attempt charge before confirming booking
     * If declined: Show error "Card declined. Please try another card or call us."
     * Hold time slot for 30 min (lock)
     * Send email with payment link to complete booking
   - Test: Enter declining card ‚Üí Booking fails gracefully, slot held temporarily

6. <b>Minor Patient (Under 18):</b>
   - Problem: 16-year-old tries to book Botox online (illegal without parent)
   - Solution to implement:
     * Intake form: Ask date of birth
     * If age < 18: Block online booking
     * Show: "Patients under 18 require parent/guardian. Please call us: (555) 100-0000"
     * All minor bookings must be phone-based with parent present
   - Test: Enter DOB showing age 16 ‚Üí Booking blocked with call instruction

7. <b>Walk-In During Fully Booked Day:</b>
   - Problem: Patient wants immediate Botox, calendar shows no availability
   - Solution to implement:
     * "Walk-In" button on calendar
     * Check: Can we squeeze in 15 min between appointments?
     * Check: Practitioner willing to stay late?
     * Check: Book at sister location today?
     * If all no: Show next available slot (tomorrow 2pm, Friday 10am)
   - Dashboard: Show "walk-in requests" queue for manager review

8. <b>System Crash During Booking:</b>
   - Problem: Server error mid-booking ‚Üí Patient loses progress
   - Solution to implement:
     * Show error: "Technical difficulty. Booking NOT completed. Try again or call us."
     * Log failed booking attempt with patient info
     * Background job: Send recovery email to patient "We noticed you tried to book. Click here: [link]"
     * Link: Pre-fills booking form with their info for quick retry
   - Test: Simulate server error during booking ‚Üí Recovery email sent

9. <b>Patient Books Wrong Location:</b>
   - Problem: Multi-location practice, patient books at wrong one
   - Solution to implement:
     * Confirmation SMS includes bold location info:
       "Your appointment is at DOWNTOWN location: 123 Main St. Map: [Google Maps link]"
     * If patient shows up at wrong location: Front desk sees appointment at different location
     * Coordinate: Can we transfer to this location? Or reschedule?
   - Test: Book at Location A ‚Üí Confirmation clearly states Location A with map

10. <b>3 AM SMS Booking Request:</b>
    - Problem: Patient texts "I want Botox" at 3am ‚Üí Staff not available
    - Solution to implement:
      * Detect time: If outside business hours (9am-6pm)
      * Auto-reply: "Thanks for your interest! We're currently closed. We'll respond at 9 AM tomorrow. You can book 24/7 at [online booking link]"
      * Flag message for staff review at 9am opening
      * First staff member: Reviews overnight messages, responds/books within 1 hour
    - Test: Send SMS at 3am ‚Üí Auto-reply sent, message flagged for 9am review

<b>PART 3: ADD ENHANCEMENTS (4 Major Improvements)</b>

1. <b>Visual Indicators (Status Colors):</b>
   - Implement color-coding on calendar appointments:
     * <span style="color: green;">Green</span> = Confirmed (patient replied "C")
     * <span style="color: orange;">Yellow</span> = Unconfirmed (no response yet)
     * <span style="color: red;">Red</span> = High no-show risk (unconfirmed + new patient + no payment)
     * <span style="color: blue;">Blue</span> = Checked in (patient arrived)
     * <span style="color: gray;">Gray</span> = Completed
   - Add legend at top of calendar
   - Test: Book appointment ‚Üí Shows yellow. Patient confirms ‚Üí Turns green.

2. <b>Smart Scheduling Suggestions (AI-Powered):</b>
   - When booking, AI suggests optimal time slots based on:
     * Patient history: Does Sarah always book mornings?
     * Practitioner efficiency: Dr. Smith works faster 2-5pm (20 min vs. 30 min per treatment)
     * Treatment type: Laser takes longer, suggest longer slots
   - Implementation:
     * Analyze past appointment data
     * Calculate: Average treatment duration per practitioner per service
     * When booking: "Recommended slots: 2pm (Dr. Smith is fastest then), 3pm, 4pm"
   - Start simple: Track historical data, add AI suggestions later

3. <b>Calendar Sync (.ics Download):</b>
   - Add "Add to Calendar" button in confirmation email/SMS
   - Generate .ics file with:
     * Event title: "Botox with Dr. Smith - Luxe Med Spa"
     * Date/time
     * Location: Address with map link
     * Description: Service, prep instructions, contact info
   - Test: Click "Add to Calendar" ‚Üí Opens Google/Apple/Outlook calendar, adds event

4. <b>Waitlist Integration (Preview for Future):</b>
   - Add "Join Waitlist" button when no availability
   - When cancellation occurs: Auto-notify waitlist patients
   - "Spot opened up on March 15 at 2pm! Reply YES to book"
   - First to reply gets the slot
   - (Note: Full waitlist feature in Phase IV, this is just basic integration)

<b>DELIVERABLES:</b>
- All 7 core features verified and working (or fixed if broken)
- All 10 edge cases implemented with proper error handling
- 4 enhancements added (visual indicators, smart suggestions, calendar sync, waitlist preview)
- Test report: List what was broken and how you fixed it
- Performance optimized (calendar loads <500ms with 100+ appointments)
- User experience improved (better error messages, clearer confirmations)

<b>TESTING CHECKLIST:</b>
After implementing fixes and enhancements, run these tests:
- [ ] Book appointment ‚Üí Appears on calendar correctly
- [ ] Try double-booking same slot ‚Üí Second one blocked
- [ ] Invalid phone number ‚Üí Flagged after SMS bounces
- [ ] Unconfirmed appointment ‚Üí Shows yellow on calendar
- [ ] Minor tries to book online ‚Üí Blocked with call instruction
- [ ] Walk-in during booked day ‚Üí Options shown (squeeze in, stay late, other location)
- [ ] Drag appointment to new slot ‚Üí Updates database, sends SMS
- [ ] Patient confirms via SMS "C" ‚Üí Turns green on calendar
- [ ] Click "Add to Calendar" ‚Üí .ics file downloads correctly
- [ ] Calendar with 500 appointments ‚Üí Loads in <500ms

<b>HOW TO APPROACH:</b>
1. First, TEST everything. Don't assume it works. Click through every feature.
2. Document what's broken or missing
3. Fix bugs first, then implement edge cases, then add enhancements
4. Test each fix/feature as you go
5. Provide me with a summary: "Found 3 bugs (double-booking, SMS not sending, drag-drop broken). Fixed all 3. Implemented 8 of 10 edge cases. Added visual indicators and calendar sync."

Let me know when you're ready to start, and we'll tackle this systematically. This is important - calendar is the heart of the system!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Multi-practitioner view (day/week/month) works smoothly</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Click-to-book UX is intuitive</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Real-time availability is accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Double-booking prevention tested (race conditions)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-confirmation SMS triggers correctly</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Appointment status tracking complete</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Drag-and-drop rescheduling works</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Race condition double booking ‚Üí Lock slot 5 min</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Wrong phone number ‚Üí Bounce detection, flag "Bad Phone"</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient never confirms ‚Üí Escalating reminders</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Service requires consultation ‚Üí Block new patients</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Payment card declined ‚Üí Hold slot 30 min</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Minor patient (under 18) ‚Üí Block online booking</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Walk-in during fully booked day ‚Üí Check squeeze-in</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>System crash during booking ‚Üí Recovery flow</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient books wrong location ‚Üí Confirmation includes map</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>3 AM SMS booking ‚Üí Auto-reply "We're closed"</span></label>
                                    </div>
                                </div>
                            </div>
                            <div class="detail-card" style="margin-top: 15px;">
                                <h4>üöÄ Enhancements to Add</h4>
                                <div class="requirements-checklist">
                                    <label class="checkbox-item"><input type="checkbox"><span>Smart scheduling suggestions (AI-powered)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Waitlist management automation</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Calendar sync (.ics download)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Visual indicators (green=confirmed, yellow=unconfirmed, red=high no-show risk)</span></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Patient Management -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('patient-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">8</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üë• Patient Management - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2 weeks ‚Ä¢ Lifetime value tracking ‚Ä¢ VIP auto-identification ‚Ä¢ üéØ BUILD ORDER: #2</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="patient-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Patient Management system. This is about verifying existing functionality, handling critical edge cases (data privacy, duplicate profiles, allergic reactions), and adding high-value enhancements (lifetime value tracking, VIP identification, at-risk flagging).

<b>WHAT THIS IS:</b>
A comprehensive audit of patient data management. You'll test search/filter performance with large datasets, implement GDPR/CCPA compliance, handle edge cases like duplicate profiles and deceased patients, and add analytics features that help identify VIP patients and prevent churn.

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything)</b>

1. <b>Patient List Search/Filter Performance:</b>
   - Test search with 10, 100, 1,000, 10,000 patient records
   - Search by: Name, Phone, Email, Tag
   - Test filters: "New patients", "VIP", "Last visit >90 days", "Has upcoming appointment"
   - Performance target: Results in <500ms for 10,000 patients
   - <b>If slow:</b> Add database indexes on searchable fields, implement pagination, add debounced search
   - Test: Type "Sarah" ‚Üí See results update in real-time

2. <b>Patient Profile Display:</b>
   - Open patient profile, verify all sections display:
     * Demographics (name, phone, email, DOB, address)
     * Medical history (allergies, conditions, medications, past procedures)
     * Treatment history (chronological list of all treatments with dates, practitioner, notes)
     * Before/after photos (organized by date and treatment type)
     * Upcoming appointments
     * Past invoices and payment history
     * Tags/categories
     * Notes (staff can add private notes)
   - Test: Does everything load correctly? Any missing data?
   - <b>If broken:</b> Fix data fetching, check database queries

3. <b>Medical History Forms (HIPAA Compliance):</b>
   - Verify forms are secure:
     * HTTPS only (no HTTP)
     * Data encrypted in transit (TLS 1.2+)
     * Data encrypted at rest in database
     * Access logs (who viewed what data, when)
     * Role-based permissions (only authorized staff can view medical data)
   - Test form submission: Patient fills out online ‚Üí Data appears in profile
   - <b>If not HIPAA-compliant:</b> Add encryption, access controls, audit logging

4. <b>Treatment History Accuracy:</b>
   - Verify chronological order (most recent first)
   - Check: All completed treatments appear
   - Check: Each entry has date, practitioner, service, notes, products used, photos
   - Test: Practitioner adds new treatment notes ‚Üí Appears in history immediately
   - <b>If incomplete:</b> Fix data model, ensure all treatment data saves correctly

5. <b>Before/After Photo Galleries:</b>
   - Verify photos organized by treatment type and date
   - Test: Upload photo ‚Üí Appears in gallery
   - Test: Side-by-side comparison mode works
   - Test: Photos tagged with treatment type (Botox, Laser, Filler)
   - Security: Patient can only see their own photos (not other patients')
   - <b>If broken:</b> Fix photo upload, check storage (S3/Cloudinary), verify permissions

6. <b>Tag Management:</b>
   - Test: Add tag to patient (e.g., "VIP", "Sensitive", "High-Value")
   - Test: Filter patients by tag
   - Test: Bulk tag operations (tag 10 patients as "VIP" at once)
   - Test: Remove tag
   - <b>If doesn't exist:</b> Implement tagging system (many-to-many relationship)

7. <b>Patient Portal Access:</b>
   - Test: Patient logs in with email + password
   - Verify: Patient sees only THEIR data (not other patients')
   - Test: Patient can view appointments, treatment history, photos, invoices
   - Test: Patient can update contact info
   - Security: Session timeout after 30 min inactive
   - <b>If broken:</b> Fix authentication, check permission logic

<b>PART 2: IMPLEMENT EDGE CASES (8 Critical Scenarios)</b>

1. <b>Duplicate Patient Profiles:</b>
   - Problem: Same patient created twice (Sarah Johnson and Sara Johnson, or same person booked twice with diff phone numbers)
   - Solution to implement:
     * Detection: When creating patient, check for similar names + same DOB or phone
     * Warning: "Possible duplicate: Sarah Johnson (555-1234) already exists. Is this the same person?"
     * Merge tool:
       - Admin can merge 2 profiles
       - Keep all appointment history from both
       - Keep all photos, notes, invoices
       - Merge contact info (take most recent)
       - Redirect all future references to primary profile
       - Archive duplicate profile (don't delete, for audit trail)
     * Database: Add "merged_into" field pointing to primary profile
   - Test: Create "Sarah Johnson" and "Sara Johnson" with same DOB ‚Üí System suggests they're duplicates ‚Üí Merge them ‚Üí All data consolidated

2. <b>Patient Name Change (Marriage, etc.):</b>
   - Problem: Patient gets married, changes last name Johnson ‚Üí Smith
   - Solution to implement:
     * "Edit Name" function in patient profile
     * Update name but PRESERVE all history
     * Audit log: "Name changed from Sarah Johnson to Sarah Smith on [date] by [staff member]"
     * Old name searchable for historical records
     * Database: Add "previous_names" JSON array field
   - Test: Change name ‚Üí History preserved, audit logged, old name still searchable

3. <b>Data Deletion Request (GDPR/CCPA Right to be Forgotten):</b>
   - Problem: Patient requests "Delete all my data"
   - Solution to implement:
     * Legal requirement: Must delete personal data within 30 days (GDPR) or 45 days (CCPA)
     * HOWEVER: Medical records must be kept for 7 years (HIPAA)
     * Solution: Anonymize, don't delete
     * Anonymization process:
       - Replace name with "Patient [ID]"
       - Remove phone, email, address
       - Keep treatment history (required by law)
       - Keep financial records (required for taxes)
       - Add flag: "data_anonymized" = true
       - Stop all marketing communications
     * Workflow:
       - Patient requests deletion
       - Manager reviews request
       - Click "Anonymize Patient Data"
       - System pseudonymizes personal info, preserves medical/financial
       - Email confirmation to patient
   - Test: Request deletion ‚Üí Data anonymized, medical records preserved, patient can't log into portal anymore

4. <b>Deceased Patient:</b>
   - Problem: Patient passes away, family notifies practice
   - Solution to implement:
     * Add "Mark as Deceased" option in patient profile
     * Prompts for: Date of death (optional), Notified by (family member)
     * Actions:
       - Set status = "deceased"
       - Stop ALL communications (no SMS, no email, no marketing)
       - Preserve all records (medical, financial) per legal requirements
       - Show "Deceased" badge prominently on profile
       - Prevent new bookings
       - Manager/admin only can see deceased patients (hidden from front desk by default)
     * Edge case: If deceased patient has upcoming appointment ‚Üí Auto-cancel, refund if prepaid
   - Test: Mark patient as deceased ‚Üí All comms stop, records preserved, can't book new appointments

5. <b>Allergic Reaction History (Critical Safety):</b>
   - Problem: Patient had allergic reaction to Restylane last year, practitioner needs to know before using filler today
   - Solution to implement:
     * RED ALERT BANNER on patient profile if allergies recorded
     * Medical history form: "Known allergies or reactions?"
     * If yes: List allergens (Restylane, Lidocaine, etc.)
     * Before treatment: Practitioner iPad shows BIG RED ALERT
       "‚ö†Ô∏è ALLERGY ALERT: Patient allergic to Restylane. Do not use!"
     * Before booking certain services: Check patient allergies
       - If patient allergic to filler and books filler ‚Üí Warning modal
     * Audit: Log every time allergy alert shown (proof of notification)
   - Database: Add "allergies" JSON array, "has_allergies" boolean flag for quick checks
   - Test: Add "Allergic to Lidocaine" ‚Üí Red banner on profile, iPad shows alert, practitioner confirms before treatment

6. <b>VIP Patient (Not Manually Tagged):</b>
   - Problem: We want to identify VIP patients but staff forgets to tag them
   - Solution to implement:
     * Auto-detect VIPs based on lifetime spend:
       - Calculate total_spent = SUM(all invoices)
       - If total_spent > $5,000 ‚Üí Auto-tag as "VIP"
       - If total_spent > $10,000 ‚Üí Auto-tag as "Premium VIP"
     * VIP benefits:
       - Priority in waitlist
       - Birthday gift/discount
       - Exclusive event invitations
       - Better service (manager handles their calls)
     * Dashboard: Show VIP badge on profile, calendar, check-in
     * Update calculation: Run nightly cron job to recalculate VIP status
   - Test: Patient spends $5,500 total ‚Üí Auto-tagged VIP, badge appears

7. <b>At-Risk Patient (Churn Prevention):</b>
   - Problem: Patient stops coming, we lose them to competitor
   - Solution to implement:
     * Detect at-risk patients:
       - Last visit > 90 days AND no future appointments = At risk
       - Bought package but unused credits expiring in 30 days = At risk
       - Cancelled last 2 appointments = At risk (frustrated?)
     * Flag them: Auto-tag "At Risk"
     * Manager dashboard: "At-Risk Patients" section
       - List of patients who haven't been back in 90+ days
       - Suggested action: "Send win-back offer" or "Call to check in"
     * Automated win-back: Send SMS after 90 days
       "We miss you! It's been 3 months since your last visit. Come back this month and get 15% off. Book now: [link]"
     * Track re-engagement success
   - Test: Patient's last visit was 92 days ago, no upcoming appointment ‚Üí Auto-tagged "At Risk", appears in manager dashboard

8. <b>Family/Relationship Linking:</b>
   - Problem: Mother and daughter both patients, we want to link them
   - Solution to implement:
     * Add "Relationships" section in patient profile
     * Link types: Spouse, Parent, Child, Sibling, Friend, Referral Source
     * Use cases:
       - Mother books appointment, mention "Your daughter Sarah was here last week"
       - Family discount (10% if 2 family members book together)
       - Cross-selling: "Your mom loves Botox, want to try?"
     * Implementation:
       - "Add Relationship" button ‚Üí Search patient, select relationship type
       - Bidirectional: If Sarah is Jane's daughter, Jane is Sarah's mother (auto-create reverse)
     * Privacy: Patients can't see relationships in portal (staff only)
   - Database: Create "patient_relationships" table (patient_id, related_patient_id, relationship_type)
   - Test: Link Sarah (daughter) to Jane (mother) ‚Üí Both profiles show relationship, staff sees it when checking in either

<b>PART 3: ADD ENHANCEMENTS (5 High-Value Features)</b>

1. <b>Lifetime Value Tracking (LTV):</b>
   - Calculate for each patient:
     * Total spent to date = SUM(all paid invoices)
     * Average visit value = total_spent / number_of_visits
     * Visit frequency = number_of_visits / months_as_patient
     * Projected LTV = avg_visit_value √ó visit_frequency √ó 36 months (3 years)
   - Display on patient profile:
     * "Lifetime Value: $8,450"
     * "Avg per visit: $350"
     * "Visits per year: 4"
     * "Projected 3-year value: $12,600"
   - Use case: Focus retention efforts on high-LTV patients
   - Test: Patient with 20 visits, $6,000 spent ‚Üí LTV calculated correctly

2. <b>Auto VIP Identification (Already covered in edge case #6):</b>
   - Implemented above

3. <b>At-Risk Flagging (Already covered in edge case #7):</b>
   - Implemented above

4. <b>Patient Segmentation for Marketing:</b>
   - Create smart lists:
     * "Botox patients (haven't been back in 3-4 months)" ‚Üí Send reminder "Time for touch-up!"
     * "Purchased package, 2+ sessions unused" ‚Üí Send "Use your credits before they expire"
     * "New patients (first visit <30 days ago)" ‚Üí Send "How was your experience? Leave a review"
     * "High-value (spent >$3K last year)" ‚Üí Invite to VIP event
   - Implementation:
     * Segment builder UI: Select filters (service type, last visit, spend amount, tag)
     * Preview count: "147 patients match"
     * Send SMS/Email to segment
     * Track: Open rate, click rate, booking rate
   - Test: Create segment "Botox patients, last visit 90-120 days ago" ‚Üí 23 patients, send win-back SMS

5. <b>Patient Search Enhancements (Smart Search):</b>
   - Fuzzy search:
     * "Sara" matches "Sarah"
     * "Jon" matches "John" or "Jonathan"
     * Handle typos: "Smth" matches "Smith"
   - Search by partial phone: "(555)" matches all (555-xxx-xxxx)
   - Search by appointment date: "Had appointment on March 15"
   - Search by service: "All Botox patients"
   - Recent searches: Show "Recently viewed patients" for quick access
   - Test: Type "Sara" ‚Üí "Sarah Johnson" appears in results

<b>DELIVERABLES:</b>
- All 7 core features verified and working
- All 8 edge cases implemented (duplicates, name change, data deletion, deceased, allergies, VIP, at-risk, family linking)
- 5 enhancements added (LTV tracking, auto-VIP, at-risk flagging, segmentation, smart search)
- HIPAA compliance verified (encryption, access logs, permissions)
- Performance optimized (search <500ms with 10K patients)
- Data privacy compliance (GDPR/CCPA anonymization process)
- Patient safety improved (allergy alerts, duplicate detection)

<b>TESTING CHECKLIST:</b>
- [ ] Search 10,000 patients by name ‚Üí Results <500ms
- [ ] Create duplicate patient ‚Üí System detects and suggests merge
- [ ] Merge 2 patient profiles ‚Üí All data consolidated correctly
- [ ] Change patient name ‚Üí History preserved, audit logged
- [ ] Request data deletion ‚Üí Data anonymized, medical records preserved
- [ ] Mark patient deceased ‚Üí All comms stop, records preserved
- [ ] Add allergy ‚Üí Red banner on profile, iPad shows alert
- [ ] Patient spends $5K+ ‚Üí Auto-tagged VIP
- [ ] Patient inactive 90+ days ‚Üí Auto-tagged "At Risk"
- [ ] Link mother-daughter ‚Üí Both profiles show relationship
- [ ] Calculate LTV ‚Üí Accurate based on spend history
- [ ] Create patient segment ‚Üí Filters work, accurate count
- [ ] Fuzzy search "Sara" ‚Üí Matches "Sarah"

<b>HOW TO APPROACH:</b>
1. Test patient list search/filter with realistic data (seed 10K test patients)
2. Verify HIPAA compliance (encryption, audit logs)
3. Implement critical edge cases first (allergies, deceased, data deletion)
4. Add enhancements (LTV, VIP, segmentation)
5. Test everything thoroughly
6. Provide summary: "All core features working. Implemented 8 edge cases. Added VIP auto-detection (42 patients auto-tagged), LTV calculation (average patient worth $4,200), at-risk flagging (18 patients need win-back). HIPAA-compliant."

This is critical - patient data is the foundation of the entire system. Handle with care!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient list search/filter with 10,000+ patients</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient profile displays all data correctly</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Medical history forms are HIPAA-compliant</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Treatment history chronological and complete</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Before/after photo galleries organized</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Tag management system works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient portal login and data access verified</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Duplicate profiles ‚Üí Merge tool</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient name change ‚Üí Update but preserve history</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Data deletion request ‚Üí Anonymize per GDPR/CCPA</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Deceased patient ‚Üí Mark, stop comms, preserve records</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Allergic reaction history ‚Üí Red alert banner</span></label>
                                    </div>
                                </div>
                            </div>
                            <div class="detail-card" style="margin-top: 15px;">
                                <h4>üöÄ Enhancements to Add</h4>
                                <div class="requirements-checklist">
                                    <label class="checkbox-item"><input type="checkbox"><span>Lifetime value tracking (total spent + projected)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Auto VIP identification (>$5K spent)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>At-risk patient flagging (credits unused 2 months)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Patient segmentation for marketing</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Family/relationship linking</span></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Treatment & Charting -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('treatment-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">9</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üíâ Treatment & Charting - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ 12+ edge cases ‚Ä¢ Chart templates ‚Ä¢ Auto-save ‚Ä¢ üéØ BUILD ORDER: #3</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="treatment-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Treatment & Charting system (iPad-based practitioner workflow). This is about verifying the SOAP note charting works flawlessly, implementing critical safety features (allergy alerts, emergency buttons), handling edge cases (iPad crashes, incomplete charts), and adding enhancements (chart templates, auto-save every 30 seconds).

<b>WHAT THIS IS:</b>
The iPad charting system is what practitioners use during/after treatments to document everything: SOAP notes (medical charting), before/after photos, products used, consent forms, and treatment completion. This is MISSION-CRITICAL because:
- Legal requirement: Medical documentation for HIPAA compliance
- Patient safety: Allergy alerts, medical history must be visible
- Inventory accuracy: Products logged = auto-deducted from stock
- Billing accuracy: What's charted = what gets invoiced
- Quality control: Before/after photos prove results

<b>WHY WE NEED THIS REVIEW:</b>
Practitioners use iPads in treatment rooms 30-50 times per day. If charting is slow, crashes, or data gets lost, it creates chaos. We need to test existing features, implement critical safety measures (allergic reaction button, wrong patient verification), and add time-saving enhancements (chart templates, auto-save).

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Allergic Reaction During Treatment</b>
   - Patient getting Restylane filler, suddenly hives appear (allergic reaction)
   - Practitioner needs to IMMEDIATELY:
     * Click "MEDICAL EMERGENCY" button (big red button always visible)
     * Auto-triggers: Call 911 (optional), alert manager, pause treatment timer
     * Document reaction: "Patient developed hives 2 min after injection, treatment discontinued, antihistamine administered"
     * Log products used up to that point
     * System marks treatment as "Medical Emergency - Incomplete"
     * Front desk notified to prepare for EMS arrival
   - <b>Current state:</b> No emergency button exists (CRITICAL GAP)
   - <b>Needed:</b> Add emergency workflow with one-tap access

2. <b>Scenario: iPad Crashes Mid-Treatment</b>
   - Practitioner 20 minutes into Botox treatment, typed detailed SOAP notes
   - iPad crashes (battery died, iOS update, app bug)
   - Practitioner restarts iPad, logs back in
   - <b>Expected:</b> All notes auto-saved, can resume where left off
   - <b>Current state:</b> Unknown if auto-save works reliably
   - <b>Test needed:</b> Force quit app, verify data recovery

3. <b>Scenario: Practitioner Forgets to Mark Chart Complete</b>
   - Treatment done at 2pm, practitioner gets busy, chart left open
   - 4pm (2 hours later): Patient wants to check out, but chart not finalized
   - Front desk can't bill until chart locked
   - <b>Needed:</b> Alert practitioner after 2 hours: "Chart for Sarah Johnson (Botox) still open. Please complete."
   - Auto-reminder every 30 min until resolved

4. <b>Scenario: Wrong Patient Selected on iPad</b>
   - Practitioner has 2 Sarahs back-to-back: Sarah Johnson 2pm, Sarah Williams 3pm
   - Accidentally opens Sarah Williams' chart at 2pm
   - Starts charting treatment for wrong patient
   - <b>Needed:</b> Photo ID verification screen before starting treatment:
     * Show patient photo from profile
     * "Is this the correct patient? YES / NO"
     * Extra protection: "Patient's date of birth?" (must enter correct DOB to proceed)

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything Works)</b>

1. <b>iPad Authentication & Practitioner Login:</b>
   - Test: Open iPad app, login with practitioner credentials (PIN or Face ID)
   - Verify: Each practitioner has their own login (can't see other practitioners' appointments)
   - Verify: Session timeout after 30 min inactive (HIPAA requirement)
   - Test: What happens if iPad stolen? Can manager remotely log out all sessions?
   - <b>Security needed:</b> 4-digit PIN or biometric (Face ID/Touch ID)
   - Test: Wrong PIN 3 times ‚Üí Lock account, manager must reset

2. <b>Today's Schedule View:</b>
   - After login, practitioner sees their schedule for today
   - Verify: List shows patient name, service, time, status (Checked In, In Progress, Completed)
   - Test: Click patient ‚Üí Opens their chart
   - Test: Real-time updates (if front desk checks in patient, iPad updates immediately)
   - <b>If not real-time:</b> Implement WebSocket or polling every 30 seconds

3. <b>SOAP Notes Structure:</b>
   - Verify all 4 sections exist:
     * <b>S (Subjective):</b> "Patient reports fine lines around eyes worsening, wants subtle improvement"
     * <b>O (Objective):</b> "Moderate crow's feet bilaterally, no contraindications noted"
     * <b>A (Assessment):</b> "Good candidate for Botox, 20-30 units total"
     * <b>P (Plan):</b> "Administered 24 units Botox (12 units per side), follow-up in 2 weeks"
   - Test: Each section has text input (supports 5,000+ characters for detailed notes)
   - Test: Tap "Voice Dictation" button ‚Üí Integrates with item #3 (Treatment Charting Dictation)
   - <b>Enhancement needed:</b> Chart templates (pre-filled SOAP notes for common procedures)

4. <b>Before/After Photo Capture:</b>
   - Test: "Take Before Photo" button ‚Üí Opens camera
   - Verify: Photo quality high-res (at least 1080p, ideally 4K for medical records)
   - Test: Take 3 before photos (front view, left profile, right profile)
   - Test: After treatment, "Take After Photo" button ‚Üí Camera with overlay showing before photo for alignment
   - Verify: Photos tagged with treatment type, date, practitioner
   - Test: Photos instantly sync to patient profile (visible in desktop app and patient portal)
   - <b>Critical:</b> Before photos REQUIRED before starting treatment (can't proceed without them)

5. <b>Photo Comparison (Side-by-Side View):</b>
   - Test: View before/after photos side-by-side with slider
   - Verify: Shows date taken, treatment type
   - Test: Export comparison (PDF or image) for patient to take home
   - Use case: "Here's your results after 2 weeks!"

6. <b>Digital Consent Forms:</b>
   - Before treatment, patient must sign consent
   - Test: iPad shows consent form for specific treatment (Botox consent, Laser consent, Filler consent)
   - Test: Patient signs on iPad touchscreen
   - Verify: Signature captured with timestamp, IP address, practitioner witness
   - Test: Can't start treatment until consent signed
   - <b>Legal requirement:</b> Consent must be clear, readable, stored securely
   - <b>Edge case:</b> Patient refuses to sign ‚Üí Treatment blocked, system flags "Consent Declined"

7. <b>Product Usage Logging:</b>
   - During treatment, practitioner logs products used:
     * Example: "Botox - 24 units", "Numbing cream - 1 application", "Gauze - 2 packs"
   - Test: Select product from dropdown, enter quantity, specify units (units/mL/applications)
   - Verify: Products logged show in real-time on invoice (front desk can see)
   - Test: If product requires lot number tracking (injectables), must enter lot # and expiration date
   - <b>Critical for safety:</b> If adverse reaction, we need lot number to report to manufacturer/FDA

8. <b>Auto-Inventory Deduction:</b>
   - When practitioner logs "Botox - 24 units", inventory should auto-deduct
   - Test: Check inventory before treatment (e.g., 200 units Botox in stock)
   - Log 24 units in treatment chart
   - Mark chart complete
   - Check inventory after (should show 176 units remaining)
   - <b>If not automatic:</b> Implement inventory webhook on chart lock
   - <b>Edge case:</b> Not enough inventory (only 10 units left but trying to log 24 units) ‚Üí Warning: "Low inventory. Confirm you used product from new vial?"

9. <b>Chart Locking (Finalization):</b>
   - After treatment, practitioner clicks "Mark Complete"
   - System prompts: "Review and confirm all information correct?"
   - Verify before locking:
     * SOAP notes filled out (all 4 sections have content)
     * Before photos taken (at least 1 photo required)
     * Products logged (at least 1 product required)
     * Consent signed (digital signature captured)
   - If anything missing ‚Üí Show error: "Cannot complete chart. Missing: Before photos, Consent signature"
   - Once locked: Chart becomes read-only (can't edit SOAP notes or products)
   - <b>Why lock?</b> Legal protection, billing accuracy, prevents retroactive changes
   - <b>Exception:</b> Manager can "Unlock Chart" with audit log entry (who unlocked, why, when)

10. <b>Front Desk Notification on Complete:</b>
    - When practitioner marks chart complete, front desk instantly notified
    - Test: Complete chart ‚Üí Front desk iPad/desktop shows "Sarah Johnson ready for checkout"
    - Verify: Front desk can immediately pull up invoice (auto-generated from chart)
    - Test: What if front desk already started checkout BEFORE chart complete? ‚Üí Real-time update, invoice recalculates

<b>PART 2: IMPLEMENT EDGE CASES (12 Critical Scenarios)</b>

1. <b>Allergic Reaction / Medical Emergency Button:</b>
   - <b>Problem:</b> Patient has severe allergic reaction during treatment (anaphylaxis, severe hives, difficulty breathing)
   - <b>Solution to implement:</b>
     * Add BIG RED "MEDICAL EMERGENCY" button always visible on screen (top-right corner)
     * When clicked:
       - Pause treatment timer
       - Pop-up: "What type of emergency? [Allergic Reaction] [Adverse Event] [Patient Injured] [Other]"
       - Auto-create incident report form
       - Send alert to manager: "MEDICAL EMERGENCY in Room 3 - Practitioner: Dr. Smith - Patient: Sarah Johnson"
       - Option to "Call 911" (one-tap, uses iPad cellular)
       - Treatment status ‚Üí "Medical Emergency - Incomplete"
       - Chart still can be completed later with notes: "Treatment discontinued due to allergic reaction. EMS called."
     * Database: Add "emergency_events" table (patient_id, treatment_id, emergency_type, timestamp, outcome, ems_called)
   - <b>Test:</b> Click emergency button ‚Üí Alert sent, incident form opens, manager notified within 10 seconds

2. <b>iPad Crashes / App Force Quits:</b>
   - <b>Problem:</b> Practitioner typing SOAP notes, iPad crashes (battery dies, iOS bug, app crash)
   - <b>Solution to implement:</b>
     * Auto-save every 30 seconds to local storage (IndexedDB) AND cloud (database)
     * On app restart: "You have an unsaved chart for Sarah Johnson. Restore? [YES] [NO]"
     * Restore all fields: SOAP notes, photos, products, timestamps
     * Show diff: "Last saved 45 seconds ago, recovered [X] characters"
   - <b>Technical implementation:</b>
     * Use localStorage or IndexedDB for offline persistence
     * Background sync every 30 sec (debounced to avoid excessive writes)
     * On component unmount/app background: Force save
   - <b>Test:</b>
     * Type 500 words in SOAP notes
     * Force quit app (swipe up in iOS task switcher)
     * Reopen app within 5 min ‚Üí All notes recovered
     * Reopen app after 24 hours ‚Üí Still recovered (no timeout)

3. <b>Forgot to Mark Chart Complete (Abandonment Alert):</b>
   - <b>Problem:</b> Practitioner finishes treatment, gets busy, forgets to mark chart complete for 2+ hours
   - <b>Solution to implement:</b>
     * Track chart open time: "Chart opened at 2:15pm"
     * If still open after 2 hours (4:15pm) ‚Üí Send alert to practitioner's iPad:
       "Chart for Sarah Johnson (Botox) still open after 2 hours. Please complete or cancel."
     * Send copy to manager dashboard: "Dr. Smith has 1 incomplete chart"
     * Repeat alert every 30 minutes until resolved
     * If chart open >8 hours (overnight) ‚Üí Manager gets urgent notification "Incomplete chart from yesterday"
   - <b>Database:</b> Add "chart_opened_at" timestamp, background job checks every 30 min
   - <b>Test:</b> Open chart, wait 2 hours (or set timer to 2 min for testing) ‚Üí Alert triggers

4. <b>Wrong Product Quantity Logged (Verification Before Lock):</b>
   - <b>Problem:</b> Practitioner meant to log "4 units Botox" but accidentally typed "40 units"
   - <b>Solution to implement:</b>
     * Before locking chart, show confirmation screen:
       "Review products used:
       - Botox: 40 units ‚ö†Ô∏è (High quantity - verify)
       - Numbing cream: 1 application ‚úì
       Total inventory value: $380"
     * If quantity > 2√ó typical amount for that service ‚Üí Flag with warning icon
     * Database: Track historical average per service (e.g., Botox usually 20-30 units, so 40 units = borderline, 100 units = clearly wrong)
     * Practitioner must confirm: "Yes, I used 40 units" or "No, let me edit"
   - <b>Why critical:</b> Prevents inventory errors, billing errors, potential patient safety issues
   - <b>Test:</b> Log 100 units Botox (clearly wrong) ‚Üí Warning shown, must confirm or edit

5. <b>Before Photos Not Taken (Make Required):</b>
   - <b>Problem:</b> Practitioner skips before photos, treats patient, realizes later can't prove results
   - <b>Solution to implement:</b>
     * Before photos REQUIRED for certain treatments: Botox, fillers, laser, microneedling (anything with visible results)
     * If treatment type requires photos and none taken ‚Üí Can't mark chart complete
     * Error message: "Before photos required for this treatment type. Please take at least 1 photo."
     * <b>Flexibility:</b> Manager can override (e.g., patient refused photos) with audit log: "Before photo requirement waived by Manager Jane - Reason: Patient declined consent"
   - <b>Database:</b> Add "requires_photos" flag to service types
   - <b>Test:</b> Try to complete Botox chart without photos ‚Üí Blocked, error shown

6. <b>Patient Changes Mind Mid-Treatment (Discontinued Option):</b>
   - <b>Problem:</b> Patient getting laser hair removal, finds it too painful, asks to stop halfway through
   - <b>Solution to implement:</b>
     * "Mark as Discontinued" button
     * Prompts: "Why was treatment discontinued? [Patient requested stop] [Medical concern] [Equipment failure] [Other]"
     * Allow notes: "Patient requested stop after 10 min due to pain level. Completed 1 of 3 zones."
     * System logs products used up to that point
     * Billing: Partial charge (e.g., if stopped halfway, charge 50% or hourly rate)
     * Chart still saved and locked (legal record)
     * Status: "Incomplete - Discontinued by Patient"
   - <b>Test:</b> Start treatment, mark as discontinued, verify partial billing, verify chart saved

7. <b>Wrong Patient Opened (Photo ID Verification):</b>
   - <b>Problem:</b> Practitioner has Sarah Johnson at 2pm, Sarah Williams at 3pm. Accidentally opens wrong Sarah's chart.
   - <b>Solution to implement:</b>
     * When opening chart, show verification screen:
       "Confirm patient identity:
       [Photo from patient profile - large, clear]
       Name: Sarah Johnson
       DOB: 05/12/1985
       Service: Botox - Forehead & Crows Feet
       Is this the correct patient? [YES] [NO]"
     * Extra security layer (optional): "Enter patient's date of birth to proceed: __/__/____"
       - Must type correct DOB (05/12/1985) to access chart
     * If wrong patient ‚Üí Go back to schedule, select correct patient
   - <b>Why critical:</b> HIPAA violation if charting in wrong patient record, medical errors if treating based on wrong history
   - <b>Test:</b> Open chart ‚Üí Photo verification shows, correct DOB required, can't proceed without confirmation

8. <b>Patient Refuses to Sign Consent (Block Treatment):</b>
   - <b>Problem:</b> Patient says "I don't want to sign anything, just do the treatment"
   - <b>Solution to implement:</b>
     * Consent required for ALL procedures (legal protection)
     * If patient refuses: Can't proceed with treatment
     * System flow:
       - Show consent form on iPad
       - Patient clicks "I refuse to sign"
       - Pop-up: "Treatment cannot proceed without signed consent. Please speak with practitioner or manager."
       - Chart status ‚Üí "Consent Declined - Treatment Not Performed"
       - Alert manager (some patients need extra explanation of why consent is required)
     * Option: Practitioner can print paper consent if patient prefers (scan and upload signature after)
   - <b>Test:</b> Try to start treatment without signed consent ‚Üí Blocked, error message shown

9. <b>Practitioner Running 45+ Min Late (Front Desk Alert):</b>
   - <b>Problem:</b> Practitioner scheduled for 2pm, 3pm, 4pm appointments. 2pm patient takes way longer (complex case). Now 45 min behind. 3pm and 4pm patients waiting, getting frustrated.
   - <b>Solution to implement:</b>
     * Track treatment duration: Chart opened at 2:15pm, expected end time 3pm (45 min treatment)
     * If still in treatment at 3pm (45 min late) ‚Üí Alert front desk:
       "Dr. Smith is 45 min behind schedule. Next patient: Sarah Williams (3pm Botox) waiting."
     * Front desk actions:
       - Offer to reschedule 3pm patient: "Doctor is running late, can we move you to tomorrow same time?"
       - Offer discount: "Sorry for the wait, we'll take 10% off today"
       - Keep patient informed: "Doctor is with previous patient, about 30 min wait. Can I get you water/coffee?"
     * Practitioner iPad also shows: "‚ö†Ô∏è You are 45 min behind schedule. 2 patients waiting."
   - <b>Database:</b> Track expected_end_time vs actual, send alerts at 30 min and 60 min delays
   - <b>Test:</b> Keep chart open 45+ min past expected ‚Üí Front desk and practitioner both alerted

10. <b>Product Not in System (Add Custom Product):</b>
    - <b>Problem:</b> Practitioner wants to log a new product not yet in the system (e.g., new brand of numbing cream)
    - <b>Solution to implement:</b>
      * When logging products, add "+ Add Custom Product" option
      * Prompts for:
        - Product name: "BLT Numbing Cream"
        - Quantity: "1 application"
        - Cost (optional): "$12"
      * Product logged in chart, but also added to "Products Pending Manager Review"
      * Manager later: Reviews custom products, adds to official catalog with SKU, inventory tracking, etc.
      * <b>Why needed:</b> Flexibility for new products, trials, or rarely-used items
    - <b>Test:</b> Add custom product "Test Product XYZ" ‚Üí Appears in chart, appears in manager's review queue

11. <b>Chart Locked But Needs Edit (Manager Unlock with Audit):</b>
    - <b>Problem:</b> Practitioner marks chart complete, realizes they forgot to log a product 10 min later
    - <b>Solution to implement:</b>
      * Charts locked by default after completion (can't edit)
      * Manager can unlock: "Unlock Chart" button (manager credentials required)
      * Prompt: "Why are you unlocking this chart? [Forgot to log product] [Incorrect dosage] [Need to add notes] [Other: ______]"
      * Audit log: "Chart unlocked by Manager Jane on 10/18/2025 at 3:45pm. Reason: Forgot to log product"
      * After edits: Re-lock chart, audit log: "Chart re-locked by Dr. Smith on 10/18/2025 at 3:50pm"
      * <b>Why needed:</b> Flexibility for honest mistakes, but maintain audit trail for compliance
    - <b>Test:</b> Lock chart, unlock as manager, edit, re-lock ‚Üí All actions logged

12. <b>No Internet Connection (Offline Mode):</b>
    - <b>Problem:</b> Wi-Fi goes down, iPad loses connection, practitioner still needs to chart
    - <b>Solution to implement:</b>
      * Full offline mode: Chart saved locally (IndexedDB)
      * Show banner: "‚ö†Ô∏è No internet connection. Charts saving locally and will sync when online."
      * When connection restored: Auto-sync all pending charts to database
      * Conflict resolution: If same chart edited offline on iPad and online on desktop ‚Üí Show diff, ask which version to keep
    - <b>Test:</b> Turn off Wi-Fi, complete chart, turn Wi-Fi back on ‚Üí Auto-syncs, no data loss

<b>PART 3: ADD ENHANCEMENTS (7 Time-Saving Features)</b>

1. <b>Chart Templates (Pre-Filled SOAP Notes):</b>
   - <b>Problem:</b> Practitioners type same SOAP notes 50 times: "Standard Botox for crow's feet and forehead"
   - <b>Solution to implement:</b>
     * Create templates for common procedures:
       - Botox - Forehead & Crow's Feet (template with typical dosages, standard notes)
       - Lip Filler - 1 Syringe (template with injection sites, expected outcomes)
       - Laser Hair Removal - Underarms (template with settings, aftercare)
     * When opening chart, option: "Use template?" ‚Üí Select template ‚Üí SOAP notes pre-filled
     * Practitioner edits as needed (adjust dosage, add specific patient details)
     * Time saved: 2-3 min per chart √ó 30 charts/day = 60-90 min saved daily
   - <b>Implementation:</b>
     * Database: "chart_templates" table (service_id, template_name, soap_subjective, soap_objective, soap_assessment, soap_plan)
     * UI: Dropdown "Load template" or auto-suggest based on service type
   - <b>Test:</b> Select "Botox" service ‚Üí Template auto-loads, edit as needed, save

2. <b>Auto-Save Every 30 Seconds (Already Covered in Edge Case #2):</b>
   - Implemented above (crash recovery)

3. <b>Voice Dictation Integration:</b>
   - Already built as Item #3 (Treatment Charting Dictation)
   - <b>Integration point:</b> Add "üé§ Dictate" button in each SOAP section
   - Click button ‚Üí Voice recording ‚Üí AI transcribes and structures into SOAP format
   - Test: Dictate 30-second treatment summary ‚Üí Auto-fills all 4 SOAP sections

4. <b>Quick Reference Guides (Treatment Protocols):</b>
   - <b>Problem:</b> Practitioner unsure of recommended Botox dosage for specific area
   - <b>Solution to implement:</b>
     * Add "üìñ Protocol" button in chart
     * Shows quick reference:
       "Botox - Forehead:
       - Recommended dosage: 10-20 units
       - Injection sites: 5 points across forehead
       - Onset: 3-5 days, peak: 10-14 days
       - Follow-up: 2 weeks"
     * Can view during treatment for guidance
     * Protocols maintained by medical director, updated regularly
   - <b>Database:</b> "treatment_protocols" table (service_id, dosage_range, technique, aftercare, contraindications)
   - <b>Test:</b> Open chart, click protocol ‚Üí Guidance shown inline

5. <b>Chart Comparison (View Previous Treatments):</b>
   - <b>Problem:</b> Patient getting 3rd Botox session, practitioner wants to see what was done last time
   - <b>Solution to implement:</b>
     * While charting, show "View Previous Charts" section
     * Displays last 3 treatments with dates:
       "Previous Botox treatments:
       - 07/15/2025: 24 units (12 forehead, 12 crow's feet) - Dr. Smith
       - 04/10/2025: 20 units (10 forehead, 10 crow's feet) - Dr. Jones"
     * Click to expand ‚Üí See full SOAP notes, photos, products
     * Use case: "Patient liked results from July, let's do same dosage"
   - <b>Test:</b> Open chart for patient with treatment history ‚Üí Previous charts shown, can view details

6. <b>Smart Product Suggestions (Based on Treatment Type):</b>
   - <b>Problem:</b> Practitioner logging products, scrolling through 200+ items to find "Botox"
   - <b>Solution to implement:</b>
     * When service is "Botox - Forehead", auto-suggest products:
       "Commonly used products for this service:
       - Botox (most used: 20-30 units)
       - Numbing cream
       - Gauze
       - Ice pack"
     * One-click add: Click "Botox" ‚Üí Prompts for quantity, adds to chart
     * Learns from historical data: If Dr. Smith always uses 24 units for forehead, pre-fill "24 units"
   - <b>Implementation:</b>
     * Query database: "What products are most used for this service?"
     * Sort by frequency, show top 5
     * Machine learning (optional): Personalized per practitioner
   - <b>Test:</b> Open Botox chart ‚Üí Botox, numbing cream, gauze auto-suggested ‚Üí One-click add

7. <b>Treatment Timer (Track Actual Duration):</b>
   - <b>Problem:</b> Don't know how long treatments actually take (important for scheduling optimization)
   - <b>Solution to implement:</b>
     * Auto-start timer when chart opened: "Treatment started at 2:17pm"
     * Auto-stop timer when chart marked complete: "Treatment completed at 3:02pm (45 minutes)"
     * Track duration in database
     * Analytics: "Average Botox treatment: 38 minutes" (helps optimize scheduling)
     * If treatment taking way longer than average ‚Üí Flag for manager: "This Botox session is 1.5 hours (avg: 38 min). Investigate."
   - <b>Test:</b> Open chart, wait 10 min, complete chart ‚Üí Duration logged accurately

<b>DELIVERABLES:</b>
- All 10 core features verified and working flawlessly
- All 12 edge cases implemented (emergency button, crash recovery, abandonment alerts, photo ID verification, consent blocking, wrong quantity warnings, discontinued treatments, late alerts, custom products, offline mode, manager unlock, chart comparison)
- 7 enhancements added (chart templates, auto-save, voice dictation, protocols, chart comparison, smart suggestions, timer)
- HIPAA compliance verified (chart locking, audit logs, session timeout, encrypted storage)
- Patient safety improved (allergy alerts, photo ID verification, medical emergency workflow)
- Practitioner efficiency increased (templates save 60-90 min/day, smart suggestions save 30-60 min/day)

<b>TESTING CHECKLIST:</b>
- [ ] iPad login works (PIN/Face ID, session timeout after 30 min)
- [ ] Today's schedule shows correct appointments in real-time
- [ ] SOAP notes support 5,000+ characters, voice dictation works
- [ ] Before/after photos captured at high-res, sync to cloud
- [ ] Side-by-side photo comparison works
- [ ] Digital consent signature captured, treatment blocked if unsigned
- [ ] Products logged correctly, lot numbers tracked for injectables
- [ ] Inventory auto-deducts on chart lock
- [ ] Chart locking validates all required fields (SOAP, photos, consent, products)
- [ ] Front desk notified instantly when chart marked complete
- [ ] Emergency button triggers alert, incident report, manager notification
- [ ] Auto-save every 30 sec, crash recovery tested (force quit app, data restored)
- [ ] Abandonment alert after 2 hours (chart left open)
- [ ] Product quantity verification (warn if >2√ó typical amount)
- [ ] Before photos required for photo-dependent treatments (Botox, fillers, laser)
- [ ] Discontinued treatment option (partial billing, audit log)
- [ ] Photo ID verification before accessing chart
- [ ] Consent refusal blocks treatment
- [ ] Late alert (45+ min behind) sent to front desk and practitioner
- [ ] Custom product can be added, appears in manager review queue
- [ ] Manager can unlock chart with audit log
- [ ] Offline mode works (save locally, auto-sync when online)
- [ ] Chart templates load, save time
- [ ] Treatment protocols viewable inline
- [ ] Previous charts viewable for comparison
- [ ] Smart product suggestions based on service type
- [ ] Treatment timer tracks duration accurately

<b>SUCCESS METRICS:</b>
- Chart completion time reduced by 30% (templates + smart suggestions)
- Zero data loss incidents (auto-save + crash recovery)
- Zero wrong-patient incidents (photo ID verification)
- Medical emergency response time <60 seconds (emergency button ‚Üí manager alert)
- Practitioner satisfaction score >8/10 (ease of use)
- 100% HIPAA compliance (chart locking, audit logs, encryption)

<b>HOW TO APPROACH:</b>
1. Set up test iPad with practitioner account
2. Seed test data (10 appointments for today)
3. Go through full workflow start-to-finish: Login ‚Üí Open chart ‚Üí Take photos ‚Üí Fill SOAP notes ‚Üí Log products ‚Üí Sign consent ‚Üí Mark complete
4. Test all 12 edge cases systematically (force crash, delay 2 hours, wrong quantity, etc.)
5. Implement missing features (emergency button, auto-save, verification screens)
6. Add enhancements (templates, protocols, comparison)
7. Performance test: Complete 10 charts back-to-back, measure time
8. Provide detailed report: "Tested all features. Found 3 bugs (listed below). Implemented emergency workflow, auto-save, templates. Average chart time reduced from 8 min to 5 min. All 12 edge cases handled. Ready for production."

This is the heart of clinical operations - get this right and practitioners will love the system!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>iPad authentication (PIN/Face ID) works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Today's schedule view on iPad accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>SOAP notes (S-O-A-P) structure complete</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Before/after photo quality acceptable</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Photo comparison (side-by-side) works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Digital consent signature capture tested</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Product usage logging accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-inventory deduction triggers</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Chart locking after completion verified</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Front desk notification on complete works</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Allergic reaction ‚Üí "Medical Emergency" button</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>iPad crashes ‚Üí Auto-save every 30 sec, restore</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Forgot to mark complete ‚Üí Alert after 2 hours</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Wrong product qty ‚Üí Confirmation before lock</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Before photos not taken ‚Üí Make required</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient changes mind mid-treatment ‚Üí "Discontinued" option</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Wrong patient ‚Üí Photo ID verification screen</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Refuses to sign consent ‚Üí Block treatment</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Practitioner 45+ min behind ‚Üí Alert front desk</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Product not in system ‚Üí "Add custom product"</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Billing & Payments -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('billing-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">10</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üí≥ Billing & Payments - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2 weeks ‚Ä¢ 15+ edge cases ‚Ä¢ Upsell automation ‚Ä¢ Payment plans ‚Ä¢ üéØ BUILD ORDER: #4</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="billing-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Billing & Payments system (checkout workflow, payment processing, invoicing). This is about verifying auto-invoice generation works perfectly, implementing critical edge cases (card declined with retry logic, refund workflows, payment plan autopay), handling disputed charges, and adding revenue-boosting enhancements (upsell automation, package recommendations, payment plan calculator).

<b>WHAT THIS IS:</b>
The billing system is the final touchpoint with every patient - where they pay for services, receive receipts, use package credits, set up payment plans, and purchase add-ons. This is MISSION-CRITICAL because:
- Revenue collection: Every dollar must be captured accurately
- Patient experience: Smooth checkout = happy patients, slow/confusing checkout = frustration
- Legal compliance: Receipts, refunds, disputed charges must follow regulations
- Accounting accuracy: QuickBooks sync, cash drawer reconciliation, tip tracking
- Upsell opportunity: Checkout is prime time to recommend packages, add-ons, memberships

<b>WHY WE NEED THIS REVIEW:</b>
Front desk staff process 30-50 checkouts per day. If card processing fails, refunds are complicated, or invoices are wrong, it creates patient complaints and lost revenue. We need to test existing features, implement critical safety measures (double-charge prevention, dispute workflows), and add revenue-boosting enhancements (smart upsells, payment plan calculator).

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Card Declined at Checkout</b>
   - Patient just had $450 Botox treatment, tries to pay with credit card
   - Card declined (insufficient funds)
   - Front desk needs to:
     * Show decline reason: "Card declined - Insufficient funds"
     * Offer alternatives: "Try different card? Pay with cash? Split payment (2 cards)? Set up payment plan?"
     * If patient has no other payment method: Create payment plan (3 monthly payments of $150)
     * Don't let patient leave without payment arrangement
   - <b>Current state:</b> Unknown if decline reasons shown, what alternatives offered
   - <b>Needed:</b> Clear error messages, alternative payment options, payment plan setup

2. <b>Scenario: Patient Disputes Charge 3 Days Later</b>
   - Patient calls: "I was charged $650 but I only got Botox which should be $450. What's the extra $200?"
   - Front desk needs to:
     * Pull up invoice instantly (search by patient name or date)
     * Show detailed breakdown: "Botox $450 + Lip Filler $200 = $650"
     * Pull up treatment chart: "You also got 0.5 syringe lip filler, see the chart notes and before/after photos"
     * If patient says "I didn't get lip filler, this is wrong": Escalate to manager
     * If legitimate error: Process refund
   - <b>Needed:</b> Detailed invoice with line items, link to treatment chart, easy refund workflow

3. <b>Scenario: Patient Wants Refund for Unused Package Credits</b>
   - Patient bought 6-session laser hair removal package ($1,800) 8 months ago
   - Used 4 sessions, has 2 sessions ($600 value) unused
   - Moving out of state, wants refund for unused sessions
   - Practice policy: Packages non-refundable (in fine print)
   - <b>Needed:</b> Manager can decide:
     * Offer store credit instead of refund (expires in 1 year, can gift to friend/family)
     * Offer partial refund (50% of unused value = $300)
     * Strict no refund (point to policy signed at purchase)
   - <b>System support needed:</b>
     * Show package purchase date, terms agreed to, signature
     * Manager approval workflow for refunds
     * If approved: Process refund, deactivate unused credits, add note "Refunded $300 for 2 unused sessions"

4. <b>Scenario: System Double-Charges Patient</b>
   - Patient checks credit card statement, sees TWO charges of $450 for same day
   - Bug: Checkout button clicked twice (slow system, impatient staff), charged twice
   - <b>Immediate action needed:</b>
     * Auto-detect duplicate charges (same patient, same amount, <5 min apart)
     * Auto-void second charge (before it settles)
     * Alert manager: "Duplicate charge detected and auto-voided for Sarah Johnson - $450"
     * Manager calls patient: "We detected a duplicate charge, already voided, you'll only see one $450 charge"
   - <b>Needed:</b> Duplicate detection, auto-void logic, manager alert

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything Works)</b>

1. <b>Auto-Invoice Generation from Treatment Chart:</b>
   - When practitioner marks chart complete, invoice auto-generated
   - Test: Complete Botox treatment chart with products logged
   - Verify invoice includes:
     * Service: "Botox - Forehead & Crow's Feet - $450"
     * Products: "Botox 24 units @ $18/unit = $432" (if billing per unit)
     * Practitioner: "Dr. Smith"
     * Date/time
     * Tax (if applicable)
     * Total due
   - Test: Add multiple services in one appointment (Botox + Lip Filler) ‚Üí Both appear on invoice
   - <b>If invoice wrong or incomplete:</b> Fix chart-to-invoice mapping, verify all products/services sync

2. <b>Card Processing (Stripe/Square Integration):</b>
   - Test: Process payment with credit card (Visa, Mastercard, Amex, Discover)
   - Verify: Card charged correctly, authorization appears instantly
   - Test: Chip card, swipe, contactless (Apple Pay/Google Pay), manual entry
   - Test: Declined card ‚Üí Show error message with reason
   - Test: Tip option:
     * Before payment: "Add tip for Dr. Smith? [15%] [20%] [Custom] [No Tip]"
     * If 20% selected on $450 bill ‚Üí Total $540 ($450 service + $90 tip)
     * Tip goes to practitioner (tracked separately for payroll)
   - <b>If card processing broken:</b> Check Stripe/Square API keys, webhook configuration, error handling

3. <b>Receipt Delivery (SMS + Email):</b>
   - After payment, patient receives receipt both ways
   - Test: Complete payment ‚Üí SMS sent within 30 seconds
     * SMS: "Thanks Sarah! Paid $450 for Botox at MedSpa. Receipt: [link]"
     * Link opens mobile-friendly receipt with itemized breakdown
   - Test: Email sent within 1 minute
     * Subject: "Receipt for Botox - $450 - MedSpa"
     * Attached: PDF receipt with logo, itemized services, payment method, date
   - Test: Patient has no email on file ‚Üí SMS only (no error)
   - Test: Patient has no phone ‚Üí Email only
   - <b>If receipts not sending:</b> Check Twilio (SMS) and email service (SendGrid/AWS SES) configuration

4. <b>QuickBooks Sync (Accounting Integration):</b>
   - Every invoice and payment syncs to QuickBooks automatically
   - Test: Process payment ‚Üí Check QuickBooks
     * Invoice created: "Sarah Johnson - Botox - $450"
     * Payment recorded: "Credit Card - $450 - 10/18/2025"
     * Customer: "Sarah Johnson" (auto-created if new)
     * Service items: "Botox" categorized correctly
   - Test: Refund ‚Üí QuickBooks shows credit memo
   - Test: Failed sync ‚Üí Retry logic, manual sync button, alert admin
   - <b>If sync not working:</b> Check QuickBooks API connection, OAuth token refresh, item mapping

5. <b>Cash Drawer Reconciliation (End of Day):</b>
   - At end of day, front desk counts cash, compares to system
   - Test: System shows "Cash Reconciliation Report":
     * Starting cash: $200 (drawer float)
     * Cash payments today: $1,350 (from 9 cash-paying patients)
     * Expected cash in drawer: $1,550
     * Actual cash counted: $_____ (front desk enters)
     * Difference: $0 (balanced!) or $-20 (short $20) or $+10 (over $10)
   - If balanced ‚Üí Close drawer, submit report
   - If off by >$10 ‚Üí Manager investigates: "Which transactions were cash? Any refunds missed?"
   - <b>If reconciliation broken:</b> Fix cash payment tracking, ensure all cash transactions logged

6. <b>Tip Tracking (Practitioner Payroll):</b>
   - When patient adds tip at checkout, tip attributed to practitioner
   - Test: Patient pays $450 service + $90 tip (20%) for Dr. Smith
   - Verify:
     * Invoice shows: Service $450, Tip $90, Total $540
     * Tip tagged to "Dr. Smith"
     * Tip appears in practitioner's payroll report: "Dr. Smith earned $540 in tips this week"
   - Test: Split tips (2 practitioners on same appointment) ‚Üí Each gets 50%
   - <b>Why critical:</b> Tips are taxable income, must be reported accurately
   - <b>If tip tracking broken:</b> Ensure tips separated from service charges, linked to practitioner ID

7. <b>FSA/HSA Eligibility Identification:</b>
   - Some services are FSA/HSA eligible (medical), others aren't (cosmetic)
   - Test: Invoice shows eligible items:
     * Botox for migraines (medical) ‚Üí FSA/HSA eligible ‚úì
     * Botox for wrinkles (cosmetic) ‚Üí NOT eligible ‚úó
     * Laser for acne scars (medical) ‚Üí FSA/HSA eligible ‚úì
     * Laser for tattoo removal (cosmetic) ‚Üí NOT eligible ‚úó
   - Test: Patient asks "Can I use HSA card?" ‚Üí System shows: "$300 of your $450 invoice is HSA-eligible"
   - Patient can split payment: $300 on HSA card, $150 on credit card
   - <b>Implementation:</b> Add "fsa_hsa_eligible" flag to services, auto-calculate eligible amount
   - <b>Test:</b> Mixed invoice (medical + cosmetic) ‚Üí Correctly identifies eligible portion

8. <b>Package Credit Deduction:</b>
   - Patient bought package: "6 Laser Sessions - $1,800"
   - Using 1 session today (normally $350/session)
   - Test: At checkout, system shows:
     * "You have 4 remaining sessions in your laser package"
     * "Apply 1 session credit to today's treatment? [YES] [NO]"
     * If YES ‚Üí Invoice shows: "Laser Hair Removal - Underarms: $0 (package credit used)"
     * Package credits: 4 ‚Üí 3 remaining
   - Test: Patient wants to use package for different service (bought laser, wants to use for facial)
     * If package flexible ‚Üí Allow (with confirmation)
     * If package locked to specific service ‚Üí Block: "This package is only for laser hair removal. Book laser or pay separately."
   - <b>If credit deduction broken:</b> Fix package tracking, ensure real-time credit updates

9. <b>Payment Plan Autopay Setup:</b>
   - Patient can't pay $1,200 upfront for treatment series, sets up 4 monthly payments of $300
   - Test: At checkout, "Set Up Payment Plan" option:
     * Enter amount: $1,200
     * Choose plan: [3 months - $400/mo] [6 months - $200/mo] [12 months - $100/mo]
     * Add interest? Practice policy: 0% if paid in 6 months, 5% if 12 months
     * Collect card: Save card on file for auto-billing
     * Schedule: 1st payment today, next payments on 15th of each month
     * Patient signs agreement (digital signature)
   - Test: 1st auto-payment date arrives ‚Üí System charges card automatically
   - Test: Card declines ‚Üí Retry next day, send SMS: "Your payment of $300 failed. Please update your card: [link]"
   - Test: After 3 failed attempts ‚Üí Suspend account, manager notified
   - <b>If payment plans broken:</b> Implement recurring billing schedule, retry logic, account suspension workflow

<b>PART 2: IMPLEMENT EDGE CASES (15 Critical Scenarios)</b>

1. <b>Card Declined ‚Üí Intelligent Retry + Alternative Payment Options:</b>
   - <b>Problem:</b> Card declined, patient embarrassed, front desk unsure what to do
   - <b>Solution to implement:</b>
     * Show decline reason (from Stripe/Square):
       - "Insufficient funds" ‚Üí Suggest: "Try different card or payment plan?"
       - "Card expired" ‚Üí Suggest: "Card expired. Do you have updated card?"
       - "Incorrect CVV" ‚Üí Suggest: "CVV incorrect. Please re-enter."
       - "Suspected fraud" ‚Üí Suggest: "Card flagged by bank. Call your bank or use different card."
     * Pop-up: "Payment failed - Insufficient funds. Options:
       1. Try different card
       2. Split payment (use 2 cards)
       3. Pay partial now, rest later (payment plan)
       4. Pay cash/check"
     * Track decline reason in database for analytics
   - <b>Test:</b> Use test card that declines ‚Üí Error shown with reason, alternatives offered

2. <b>Patient Disputes Charge ‚Üí Quick Invoice Lookup with Chart Link:</b>
   - <b>Problem:</b> Patient calls 3 days later: "Why was I charged $650? I only got Botox!"
   - <b>Solution to implement:</b>
     * Front desk searches: Patient name "Sarah Johnson"
     * Shows all recent invoices: "10/18/2025 - $650 - Botox + Lip Filler"
     * Click invoice ‚Üí Detailed breakdown:
       "Services:
       - Botox (24 units) - $450
       - Lip Filler (0.5 syringe) - $200
       Total: $650"
     * Link to treatment chart: "View Chart" button ‚Üí Opens full SOAP notes, before/after photos, consent signatures
     * If patient says "I didn't get lip filler": Show chart, photos, signature
     * If still disputed: Manager can investigate, issue refund if error found
   - <b>Test:</b> Search patient ‚Üí Find invoice ‚Üí View details ‚Üí Link to chart works

3. <b>Refund Request ‚Üí Manager Approval Workflow:</b>
   - <b>Problem:</b> Patient wants refund, front desk can't approve (policy: manager only)
   - <b>Solution to implement:</b>
     * Front desk can initiate refund request (not process):
       - Click "Request Refund" on invoice
       - Select reason: [Service unsatisfactory] [Duplicate charge] [Wrong service] [Other: _____]
       - Add notes: "Patient says Botox wore off after 1 week (expected 3-4 months). Wants full refund."
       - Send to manager for approval
     * Manager gets notification: "Refund request - Sarah Johnson - $450 - Reason: Service unsatisfactory"
     * Manager reviews:
       - View chart: Did treatment happen as described?
       - Check before/after photos: Was service performed correctly?
       - Review patient history: Is this a repeat complainer?
       - Decision: [Approve Full Refund] [Approve Partial Refund: $___] [Deny - Add reason]
     * If approved: Refund auto-processes to original payment method
     * Patient notified: "Your refund of $450 has been approved and will appear in 5-7 business days"
     * If denied: Manager calls patient to explain
   - <b>Database:</b> Add "refund_requests" table (invoice_id, requested_by, reason, status, manager_decision, refund_amount, processed_date)
   - <b>Test:</b> Request refund ‚Üí Manager approves ‚Üí Refund processes, patient notified

4. <b>Patient Leaves Without Paying ‚Üí Collections Workflow:</b>
   - <b>Problem:</b> Patient says "I forgot my wallet, I'll come back tomorrow" and never returns
   - <b>Solution to implement:</b>
     * Mark invoice as "Unpaid - Patient Left Without Paying"
     * Auto-send SMS same day: "Hi Sarah, you left without paying for your Botox treatment ($450). Please call us to arrange payment: (555) 123-4567"
     * If no response after 24 hours ‚Üí Send email with invoice attached
     * After 3 days ‚Üí Manager calls patient
     * After 7 days ‚Üí Send formal payment demand letter (via email + SMS)
     * After 14 days ‚Üí Options:
       1. Write off as bad debt (small amount <$100)
       2. Send to collections agency (large amount >$500)
       3. Block patient from future bookings until paid
     * Track: "Outstanding Invoices" report for manager
   - <b>Test:</b> Mark invoice unpaid ‚Üí Reminders sent on schedule, patient blocked from booking until paid

5. <b>Package Credits Expiring Soon ‚Üí Alerts (60/30/7 Days Before):</b>
   - <b>Problem:</b> Patient bought package, forgot to use it, credits expire, patient angry: "Why didn't you remind me?"
   - <b>Solution to implement:</b>
     * Track package expiration: "Purchased 08/01/2025, expires 02/01/2026 (6 months)"
     * Auto-send reminders:
       - <b>60 days before expiration (12/03/2025):</b> "Your laser package has 3 sessions left and expires in 60 days. Book now: [link]"
       - <b>30 days before (01/02/2026):</b> "REMINDER: 3 laser sessions expire in 30 days. Book ASAP: [link]"
       - <b>7 days before (01/25/2026):</b> "FINAL REMINDER: 3 laser sessions expire in 7 days! Book urgently: [link] or call (555) 123-4567"
     * Manager dashboard: "Packages Expiring This Month" report
       - List of patients with expiring credits
       - Suggest: "Call these patients to book appointments before they lose credits"
     * If patient misses deadline: Credits expire, but manager can extend (with approval): "Extended expiration by 30 days as courtesy"
   - <b>Test:</b> Set package to expire in 7 days ‚Üí Reminder SMS/email sent, appears on manager dashboard

6. <b>System Double-Charges Card ‚Üí Auto-Void + Manager Alert:</b>
   - <b>Problem:</b> Impatient staff clicks "Charge Card" twice (slow system), patient charged $450 twice
   - <b>Solution to implement:</b>
     * Detection: If same patient charged same amount within 5 minutes ‚Üí Flag as potential duplicate
     * Auto-void second charge immediately (before it settles with bank)
     * Alert manager: "‚ö†Ô∏è Duplicate charge detected and auto-voided:
       - Patient: Sarah Johnson
       - Amount: $450
       - Time: 2:15pm and 2:16pm (1 min apart)
       - Action: Second charge voided automatically"
     * Manager calls patient (proactive): "Hi Sarah, just to let you know our system detected a duplicate charge and automatically voided it. You'll only see one $450 charge on your card. Sorry for any confusion!"
     * Prevent: After clicking "Charge Card", disable button for 10 seconds (show "Processing...")
   - <b>Test:</b> Charge card twice within 1 minute ‚Üí Second charge auto-voided, manager alerted

7. <b>Payment Plan Autopay Fails ‚Üí Retry Logic + Account Suspension:</b>
   - <b>Problem:</b> Patient on payment plan, monthly autopay of $300 fails (card expired or insufficient funds)
   - <b>Solution to implement:</b>
     * Day 1 (payment due): Charge card ‚Üí Declined
     * Immediate action:
       - Send SMS: "Your payment of $300 failed. Reason: Insufficient funds. We'll retry tomorrow. Update card if needed: [link]"
       - Send email with same message
     * Day 2: Retry charge ‚Üí Still declined
       - Send SMS: "2nd attempt failed. Please update your payment method urgently: [link]"
     * Day 3: Retry charge ‚Üí Still declined
       - Send SMS: "FINAL ATTEMPT TODAY. Update card or call us: (555) 123-4567"
     * Day 4 (3 failed attempts):
       - Suspend account: "Cannot book new appointments until payment plan current"
       - Alert manager: "Sarah Johnson payment plan failed 3 times - $300 overdue - Account suspended"
       - Manager calls patient
     * After 14 days overdue: Options:
       1. Cancel payment plan, demand full balance
       2. Send to collections
       3. Work out new payment arrangement
   - <b>Database:</b> Track retry attempts, failed_payment_count, account_status
   - <b>Test:</b> Simulate failed autopay ‚Üí Retries on schedule, account suspended after 3 failures

8. <b>Cash Drawer Doesn't Balance ‚Üí Investigation Workflow:</b>
   - <b>Problem:</b> End of day cash count: Expected $1,550, actual $1,520 ($30 short)
   - <b>Solution to implement:</b>
     * System flags: "‚ö†Ô∏è Cash drawer $30 short"
     * Manager investigates:
       - Review all cash transactions today: List of 9 cash payments
       - Check: Any refunds given in cash? (Refund but didn't subtract from drawer?)
       - Check: Any discounts applied? (Discounted invoice but took full cash?)
       - Review: Was change given correctly?
     * Manager adds notes: "Investigated. Sarah paid $500 cash for $480 service, given $20 change. Likely short $30 due to incorrect change given to Michael (paid $100, should have received $15 change, may have received $45). Will retrain staff on cash handling."
     * Resolution: [Accept variance - staff error] [Staff repays shortage] [Investigate further]
     * Track: Cash variance report over time (if same staff member always short ‚Üí Performance issue)
   - <b>Test:</b> Enter cash count $30 short ‚Üí Investigation workflow opens, manager can add notes

9. <b>HSA Card Used for Cosmetic Service (Ineligible) ‚Üí Block or Warn:</b>
   - <b>Problem:</b> Patient wants to use HSA card for Botox for wrinkles (cosmetic = ineligible)
   - <b>Solution to implement:</b>
     * Before charging HSA card, check service eligibility:
       - Service: "Botox for Wrinkles" ‚Üí fsa_hsa_eligible = FALSE
       - Pop-up warning: "‚ö†Ô∏è This service is NOT eligible for FSA/HSA (cosmetic, not medical). Patient may be responsible for repaying FSA/HSA if used."
       - Options:
         1. Charge HSA anyway (patient signs waiver: "I understand this may not be reimbursed")
         2. Use different payment method
     * If patient insists: Require signed waiver (digital signature):
       "I understand that Botox for cosmetic purposes is not HSA-eligible. I authorize MedSpa to charge my HSA card and accept responsibility if my HSA administrator requests repayment."
     * Audit trail: "HSA card used for ineligible service with signed waiver - 10/18/2025"
   - <b>Test:</b> Try to charge HSA for cosmetic service ‚Üí Warning shown, waiver required

10. <b>Card Tips Separated from Service Revenue (Payroll Reporting):</b>
    - <b>Problem:</b> IRS requires tips reported separately from service charges for tax purposes
    - <b>Solution to implement:</b>
      * When processing payment with tip:
        - Service charge: $450 (revenue to business)
        - Tip: $90 (income to practitioner - must be reported on W-2)
      * Payment processor: Charge $540 total, but tag $90 as tip
      * Database: Store separately:
        - invoices table: service_amount = $450, tip_amount = $90, total = $540
        - practitioner_tips table: practitioner_id, tip_amount = $90, date
      * Payroll report: "Dr. Smith tips this pay period: $1,240" (added to paycheck, taxed)
      * QuickBooks: Service revenue = $450 (categorized as "Service Income"), Tips = $90 (categorized as "Tip Income - Dr. Smith")
    - <b>Test:</b> Process payment with tip ‚Üí Service and tip recorded separately, tip appears in practitioner payroll report

11. <b>Split Payment (Multiple Cards + Cash):</b>
    - <b>Problem:</b> Patient wants to pay $450 using: $200 on Card A, $150 on HSA card, $100 cash
    - <b>Solution to implement:</b>
      * "Split Payment" option at checkout
      * UI:
        "Total due: $450
        Payment 1: Card ****1234 - $200 ‚úì (charged)
        Payment 2: HSA card ****5678 - $150 ‚úì (charged)
        Payment 3: Cash - $100 (recorded)
        Total collected: $450 ‚úì Fully paid"
      * Process each payment separately
      * If one payment fails (Card A declined) ‚Üí Void all, start over
      * Receipt shows all payment methods
    - <b>Test:</b> Split payment across 3 methods ‚Üí All recorded correctly, receipt shows breakdown

12. <b>Discount Applied but Not Recorded in System:</b>
    - <b>Problem:</b> Manager verbally approves 20% discount for VIP patient, front desk forgets to apply in system, patient charged full price
    - <b>Solution to implement:</b>
      * Discount codes or manual discount field:
        - Invoice total: $450
        - Apply discount: "VIP20" (20% off) ‚Üí New total: $360
        - Discount reason required: [VIP customer] [Service recovery] [Staff error] [Promotion] [Other: _____]
      * Manager approval for discounts >20%:
        - If discount >20% ‚Üí Manager PIN required
        - Audit log: "Manager Jane approved 25% discount ($112.50) for Sarah Johnson - Reason: Service recovery after long wait time"
      * Prevent: If invoice marked paid without discount applied, but patient says "I was promised 20% off":
        - Refund difference: $90 (20% of $450)
        - Or: Apply credit to account for future visit
    - <b>Test:</b> Apply discount code ‚Üí Invoice recalculates, discount reason logged

13. <b>Package Purchased but Never Activated (System Bug):</b>
    - <b>Problem:</b> Patient paid $1,800 for 6-session package 2 months ago, tries to use credit today, system says "No package found"
    - <b>Solution to implement:</b>
      * Detection: Search patient's payment history ‚Üí Find $1,800 charge for "Laser Package" but no active package
      * Root cause: Payment processed but package not created in database (webhook failed)
      * Fix:
        - Manager can manually activate package: "Create Package from Invoice #12345"
        - Auto-fills: Service type (Laser), sessions (6), purchase date (08/18/2025), expiration date (02/18/2026)
        - Adjust: If patient already used sessions but wasn't tracked, manually set "3 of 6 used, 3 remaining"
      * Alert: "‚ö†Ô∏è Package purchase detected but not activated. Activated manually by Manager Jane on 10/18/2025"
    - <b>Test:</b> Find invoice for package, package doesn't exist ‚Üí Manager manually activates, credits available

14. <b>Refund Issued but Card Already Expired:</b>
    - <b>Problem:</b> Patient paid with card ending in 1234, wants refund 6 months later, that card expired
    - <b>Solution to implement:</b>
      * Attempt refund to original card ‚Üí Fails (card expired/closed)
      * Pop-up: "Refund failed - Card no longer valid. Alternative refund methods:
        1. Ask patient for updated card (refund to new card)
        2. Issue check (mail to patient's address on file)
        3. Apply credit to account (use for future visits)"
      * Track: "Pending Refunds" report for unprocessed refunds
    - <b>Test:</b> Try to refund expired card ‚Üí Error shown, alternative methods offered

15. <b>Outstanding Balance Alerts (Unpaid Invoices):</b>
    - <b>Problem:</b> Patient has $450 unpaid invoice from 2 weeks ago, books new appointment, front desk doesn't notice
    - <b>Solution to implement:</b>
      * At check-in or booking: System alerts:
        "‚ö†Ô∏è Sarah Johnson has outstanding balance: $450 from 10/05/2025 (Botox treatment). Collect before new service?"
      * Front desk options:
        1. Collect outstanding balance now ($450 + today's service $200 = $650 total)
        2. Set up payment plan for both
        3. Allow service but flag account (manager decision)
      * Manager dashboard: "Patients with Outstanding Balances" report
        - List all unpaid invoices >7 days old
        - Total outstanding: $12,450 across 23 patients
        - Suggested action: Call patients, send payment reminders, block future bookings
    - <b>Test:</b> Patient with unpaid invoice books appointment ‚Üí Alert shown at check-in

<b>PART 3: ADD ENHANCEMENTS (7 Revenue-Boosting Features)</b>

1. <b>Upsell Automation (Package Recommendations at Checkout):</b>
   - <b>Problem:</b> Patient pays $350 for single laser session, doesn't know packages save money
   - <b>Solution to implement:</b>
     * At checkout, smart recommendation pop-up:
       "üí° Save $360! You're paying $350 for 1 session. Buy 6-session package for $1,800 ($300/session) and save $360 total!"
     * Logic:
       - If patient booking same service repeatedly ‚Üí Suggest package
       - If service has package option ‚Üí Offer at checkout
       - If patient is VIP (spent >$3K) ‚Üí Suggest membership ($199/month unlimited Botox + 20% off other services)
     * Customizable: Manager sets which services trigger upsells
     * Tracking: "Upsell conversion rate: 18% of patients shown package offer purchased"
   - <b>Test:</b> Pay for single service ‚Üí Package recommendation shown, can purchase on the spot

2. <b>Payment Plan Calculator (Show Monthly Payment Before Committing):</b>
   - <b>Problem:</b> Patient hesitant about $1,200 treatment, doesn't realize payment plan available
   - <b>Solution to implement:</b>
     * At checkout, "Can't pay upfront? Calculate payment plan" button
     * Calculator:
       "Total: $1,200
       Choose plan:
       - 3 months: $400/month (0% interest)
       - 6 months: $200/month (0% interest)
       - 12 months: $108/month (5% interest = $96 total interest)"
     * Patient sees: "$200/month for 6 months? I can afford that!" ‚Üí More likely to proceed
     * One-click: "Select plan ‚Üí Enter card ‚Üí Sign agreement ‚Üí Done"
   - <b>Implementation:</b> Pre-calculate common plans (3/6/12 months), show monthly amount prominently
   - <b>Test:</b> Open calculator, select 6-month plan, total and monthly payment correct

3. <b>Membership Auto-Billing (Recurring Revenue):</b>
   - <b>Problem:</b> Memberships exist but manual billing is tedious
   - <b>Solution to implement:</b>
     * Membership tiers:
       - Bronze: $99/month (1 service/month, 10% off products)
       - Silver: $199/month (2 services/month, 15% off products)
       - Gold: $299/month (Unlimited Botox, 20% off everything else)
     * Auto-billing:
       - Patient signs up: "Charge my card $199 on the 1st of every month"
       - Auto-charge on schedule
       - If payment fails ‚Üí Retry logic (same as payment plans)
       - Patient can cancel anytime (with 30-day notice per membership terms)
     * Member benefits auto-applied at checkout:
       - Member uses 1 service ‚Üí Invoice shows: "Botox $450 - 15% member discount = $382.50"
       - If exceeds monthly allowance ‚Üí "You've used your 2 monthly services. Additional services 15% off."
   - <b>Test:</b> Enroll in membership ‚Üí Auto-billed monthly, discounts auto-applied at checkout

4. <b>Dynamic Pricing (Peak vs Off-Peak, Last-Minute Discounts):</b>
   - <b>Problem:</b> Tuesday 10am slots always empty, Friday 5pm always booked (no price incentive)
   - <b>Solution to implement:</b>
     * Peak pricing: Friday 4-7pm +10% ($450 Botox ‚Üí $495)
     * Off-peak discount: Tuesday-Thursday 10am-2pm -15% ($450 ‚Üí $382.50)
     * Last-minute fill: If tomorrow has open slot at 2pm ‚Üí Send SMS to recent patients:
       "Last-minute opening tomorrow 2pm! Book Botox at 20% off ($360): [link]"
     * A/B test: Does dynamic pricing increase revenue? Track fill rate vs revenue per slot
   - <b>Test:</b> Book Friday 5pm ‚Üí Price increased, Book Tuesday 11am ‚Üí Price discounted

5. <b>Loyalty Points / Rewards Program:</b>
   - <b>Problem:</b> No incentive for patients to return vs going to competitor
   - <b>Solution to implement:</b>
     * Earn points: $1 spent = 1 point
     * Redeem: 1,000 points = $10 off future service
     * At checkout: "You have 3,200 points ($32 credit). Use now? [YES] [NO]"
     * Bonus points for referrals: "Refer a friend, get 500 points ($5) when they book first appointment"
     * VIP tier unlocks: Spend $5K ‚Üí VIP status ‚Üí Earn 2√ó points ($1 = 2 points)
     * Expiration: Points expire after 1 year (encourages usage)
   - <b>Test:</b> Patient spends $450 ‚Üí Earns 450 points, can redeem on future visit

6. <b>Add-On Suggestions (Cross-Sell at Checkout):</b>
   - <b>Problem:</b> Patient getting Botox, doesn't know we sell retinol cream that extends results
   - <b>Solution to implement:</b>
     * At checkout after Botox, suggest:
       "üí° Extend your Botox results! Add Retinol Cream ($45) to boost collagen?"
     * Logic:
       - Service-based recommendations: Botox ‚Üí Retinol, Laser ‚Üí Sunscreen, Facial ‚Üí Moisturizer
       - AI learns: "80% of patients who buy Product X also buy Product Y"
     * One-click add: "Add to invoice" ‚Üí Total recalculates
   - <b>Test:</b> Complete Botox checkout ‚Üí Retinol cream suggested, can add to invoice

7. <b>Gift Cards & Prepaid Credits:</b>
   - <b>Problem:</b> Patient wants to buy gift card for friend's birthday
   - <b>Solution to implement:</b>
     * "Purchase Gift Card" option:
       - Amount: [$ 50] [$100] [$250] [Custom: $_____]
       - Recipient name: "Jessica Smith"
       - Recipient email/phone: jessica@email.com
       - Personal message: "Happy Birthday! Enjoy a spa treatment on me!"
       - Delivery: [Send now] [Schedule for 10/25/2025]
     * Gift card issued: Unique code "GIFT-ABC123"
     * Recipient receives: Email/SMS with gift card code, instructions to redeem
     * Redemption: At checkout, "Apply Gift Card" ‚Üí Enter code ‚Üí Balance deducted
     * Tracking: Gift cards sold, redeemed, unredeemed (breakage = extra revenue)
   - <b>Test:</b> Purchase $100 gift card ‚Üí Recipient receives code, can redeem for services

<b>DELIVERABLES:</b>
- All 9 core features verified and working (auto-invoice, card processing, receipts, QuickBooks sync, cash reconciliation, tips, FSA/HSA, package credits, payment plans)
- All 15 edge cases implemented (card declined with alternatives, dispute resolution, refund workflows, collections, expiration alerts, double-charge prevention, autopay retry, cash variance, HSA warnings, tip separation, split payments, discount tracking, package activation, refund failures, outstanding balance alerts)
- 7 revenue enhancements added (upsell automation, payment plan calculator, membership auto-billing, dynamic pricing, loyalty points, add-on suggestions, gift cards)
- Payment processing optimized (Stripe/Square fully integrated, error handling robust)
- Revenue protection (no lost payments, all edge cases handled, disputes resolved quickly)
- Revenue growth (upsells increase average transaction by 15-25%, payment plans convert 30% more patients who say "too expensive")

<b>TESTING CHECKLIST:</b>
- [ ] Auto-invoice generates correctly from treatment chart
- [ ] Card processing works (Visa, Mastercard, Amex, chip, swipe, contactless, manual)
- [ ] Tip option shows, tip attributed to correct practitioner
- [ ] Receipts sent via SMS and email within 1 minute
- [ ] QuickBooks sync creates invoice and payment record
- [ ] Cash reconciliation report accurate, flags variances >$10
- [ ] FSA/HSA eligibility correctly identified, split payment works
- [ ] Package credits deduct correctly, remaining balance updates
- [ ] Payment plan autopay schedules correctly, charges on due date
- [ ] Card declined shows reason, offers alternatives
- [ ] Disputed charges can be investigated, linked to treatment chart
- [ ] Refund request workflow requires manager approval
- [ ] Unpaid invoices trigger collections workflow (SMS, email, calls)
- [ ] Package expiration alerts sent at 60/30/7 days
- [ ] Duplicate charges auto-detected and voided
- [ ] Payment plan failures trigger retry logic, account suspension after 3 attempts
- [ ] Cash drawer variance opens investigation workflow
- [ ] HSA card for cosmetic service shows warning, requires waiver
- [ ] Tips separated from service revenue in database and payroll
- [ ] Split payment across multiple methods works correctly
- [ ] Discounts require reason, >20% requires manager approval
- [ ] Package purchased but not activated can be manually fixed
- [ ] Refund to expired card shows alternative options
- [ ] Outstanding balance alerts at check-in
- [ ] Upsell recommendations show at checkout (packages, memberships)
- [ ] Payment plan calculator shows accurate monthly amounts
- [ ] Membership auto-billing charges on schedule
- [ ] Dynamic pricing applies correctly (peak/off-peak)
- [ ] Loyalty points earned and redeemable
- [ ] Add-on suggestions appear at checkout
- [ ] Gift cards can be purchased, sent, and redeemed

<b>SUCCESS METRICS:</b>
- Payment collection rate >98% (fewer unpaid invoices)
- Average transaction value +15-25% (upsells + add-ons)
- Payment plan conversion: 30% of patients who say "too expensive" enroll in plan vs walking away
- Disputed charges resolved <24 hours
- Refund processing <48 hours (manager approval ‚Üí refund issued)
- Card decline recovery: 40% of declined cards successfully charged with alternative payment
- Cash drawer variance <$20/day (99% of days balanced within $20)
- Membership revenue: $15K-$30K/month recurring (50-150 members √ó $199 avg)
- Gift card breakage: 15-20% never redeemed (pure profit)
- Outstanding balance collection: 80% collected within 30 days

<b>HOW TO APPROACH:</b>
1. Test checkout flow start-to-finish: Open invoice ‚Üí Process payment (card, cash, package credit, payment plan) ‚Üí Verify receipt sent ‚Üí Check QuickBooks sync
2. Test all 15 edge cases systematically (declined card, disputes, refunds, double-charge, etc.)
3. Implement missing features (upsell pop-ups, payment calculator, membership auto-billing)
4. Performance test: Process 20 checkouts back-to-back (mix of payment types), measure time
5. Provide detailed report: "Tested all features. Found 2 bugs (listed below). Implemented upsell automation (18% conversion rate in testing), payment plan calculator (reduces 'too expensive' objections by 35%), membership auto-billing (15 test members enrolled). All 15 edge cases handled. Average checkout time 2.5 minutes. Ready for production."

This is where money is made or lost - get this right and revenue will soar!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-invoice includes all services/products</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Card processing (Stripe/Square) works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Receipt SMS + Email both send correctly</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>QuickBooks sync tested</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Cash drawer reconciliation accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Tip tracking goes to correct practitioner</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>FSA/HSA eligibility correctly identified</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Package credit deduction works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Payment plan autopay setup tested</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Card declined ‚Üí Show reason, offer alternatives</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient disputes charges ‚Üí Pull up chart</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Refund request ‚Üí Manager approval workflow</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient leaves without paying ‚Üí Collections flow</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Credits expired ‚Üí Alerts 60/30/7 days before</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>System double-charges ‚Üí Auto-void, manager calls</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Payment plan fails ‚Üí Retry + suspend account after 14d</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Cash drawer doesn't balance ‚Üí Investigation flow</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>HSA for cosmetic ‚Üí Staff trained, waiver required</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Card tips ‚Üí Separate from service, report to payroll</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SMS & Messaging -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('sms-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">11</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üí¨ SMS & Messaging - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ Sentiment analysis ‚Ä¢ Emergency detection ‚Ä¢ Multi-language ‚Ä¢ üéØ BUILD ORDER: #9</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="sms-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the SMS & Messaging system (Twilio-based patient communication). This is about verifying automated SMS workflows work flawlessly (appointment confirmations, reminders, aftercare instructions), implementing critical safety features (emergency keyword detection, sentiment analysis for angry messages), handling edge cases (delivery failures, non-English replies, spam detection), and adding intelligent enhancements (smart send timing, message templates, delivery analytics).

<b>WHAT THIS IS:</b>
The SMS system is the primary communication channel with patients - confirmations, reminders, aftercare, follow-ups, marketing campaigns. This is MISSION-CRITICAL because:
- Appointment adherence: Reminders reduce no-shows by 40-60%
- Patient engagement: Timely aftercare instructions improve outcomes and reduce complaints
- Emergency detection: Patients often text urgent medical concerns ("swelling won't go down", "severe pain")
- Revenue generation: Win-back campaigns, birthday offers, last-minute fill campaigns bring patients back
- Staff efficiency: Two-way messaging reduces phone calls by 50-70%

<b>WHY WE NEED THIS REVIEW:</b>
Practices send 200-500 SMS per day (50+ appointments √ó 4 messages each: confirmation, 48hr reminder, 24hr reminder, aftercare). If messages don't send, send at wrong times (3 AM!), or urgent patient replies are missed, it creates chaos. We need to test existing workflows, implement intelligent features (sentiment analysis, emergency detection), and optimize delivery (timezone handling, rate limiting, fallback to email).

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Patient Replies "R" to Reschedule</b>
   - Patient receives: "Reminder: You have Botox tomorrow at 2pm with Dr. Smith. Reply C to confirm, R to reschedule."
   - Patient texts back: "R"
   - System should:
     * Auto-detect "R" (reschedule request)
     * Create task for front desk: "Sarah Johnson wants to reschedule Botox (10/19 2pm)"
     * Send auto-reply: "We'll call you shortly to reschedule. Need immediate help? Call (555) 123-4567"
     * Front desk sees task, calls patient, books new time
   - <b>Current state:</b> Unknown if "R" triggers anything or just ignored
   - <b>Needed:</b> Smart reply detection, auto-task creation, auto-response

2. <b>Scenario: Patient Texts Angry Message</b>
   - Patient texts: "I'm so upset! I paid $600 and my face is STILL swollen after 3 days. This is unacceptable!"
   - System should:
     * Detect sentiment: NEGATIVE (angry, urgent)
     * Flag message as HIGH PRIORITY
     * Create urgent task for manager: "üö® ANGRY PATIENT: Sarah Johnson - swelling complaint"
     * Auto-reply: "We're very sorry to hear this. A manager will call you within 15 minutes. If this is a medical emergency, please call 911 or visit urgent care."
     * Manager sees alert, calls patient immediately
   - <b>Current state:</b> Unknown if sentiment detected or message treated same as "Thank you!"
   - <b>Needed:</b> Sentiment analysis (OpenAI or simple keyword matching), priority flagging, urgent alerts

3. <b>Scenario: Patient Texts Medical Emergency Keywords</b>
   - Patient texts: "I can't breathe. My throat is swelling. I had filler yesterday."
   - System should:
     * Detect emergency keywords: "can't breathe", "swelling", "throat", "chest pain", "severe pain"
     * IMMEDIATELY alert manager: "üÜò MEDICAL EMERGENCY: Sarah Johnson - possible allergic reaction - 'can't breathe, throat swelling'"
     * Auto-reply: "This sounds like a medical emergency. Call 911 NOW or go to nearest ER. We're calling you immediately."
     * System dials patient's number (click-to-call for manager)
     * Log incident: "Emergency message detected - 10/18/2025 3:15pm"
   - <b>Current state:</b> Messages probably sit in inbox until someone checks
   - <b>Needed:</b> Emergency keyword detection, instant alerts (push notification, SMS to manager, Slack/email), auto-call trigger

4. <b>Scenario: Sending Reminder at 3 AM (Timezone Issue)</b>
   - Patient booked appointment for 2pm today
   - System sends 24-hour reminder: "You have Botox tomorrow at 2pm"
   - Sent at 2pm yesterday ‚úì CORRECT
   - BUT: Practice in EST, patient traveled to PST timezone
   - Patient receives message at 11pm PST (their local time)
   - OR WORSE: System bug sends at 2 AM (wakes patient up)
   - <b>Needed:</b> Smart send timing (quiet hours 9pm-9am), timezone detection, rate limiting

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything Works)</b>

1. <b>Twilio Send/Receive Integration:</b>
   - Test: Book appointment ‚Üí Confirmation SMS sent within 60 seconds
   - Verify: SMS from practice phone number (e.g., (555) 123-4567)
   - Test: Patient replies ‚Üí Message appears in inbox (web dashboard)
   - Test: Staff replies ‚Üí Patient receives response
   - <b>Twilio status check:</b>
     * Verify: Twilio account active, phone number verified
     * Check: Current usage vs limits (10,000 SMS/month? Need upgrade?)
     * Test: What happens if Twilio down or rate limit exceeded?
   - <b>If not working:</b> Check Twilio API credentials (Account SID, Auth Token), webhook URL for incoming messages

2. <b>Appointment Confirmation (Triggered on Booking):</b>
   - Test: Front desk books appointment for tomorrow 2pm
   - Expected SMS (sent within 60 seconds):
     "Hi Sarah! Your Botox appointment is confirmed for tomorrow (Fri 10/19) at 2:00pm with Dr. Smith at MedSpa. See you soon! Reply C to confirm, R to reschedule, or STOP to opt out."
   - Verify:
     * Patient name personalized ("Hi Sarah")
     * Date formatted clearly ("Fri 10/19" not "2025-10-19")
     * Service mentioned ("Botox")
     * Practitioner name ("Dr. Smith")
     * Location if multi-location practice
     * Actionable options (C to confirm, R to reschedule)
   - <b>If message wrong or missing:</b> Fix appointment creation webhook, verify SMS template

3. <b>Reminder Sequence (T-48hr, T-24hr, T-2hr):</b>
   - Test appointment on Friday 2pm ‚Üí Check reminders sent:
     * <b>Wednesday 2pm (48 hours before):</b> "Reminder: Botox appointment in 2 days (Fri 10/19 at 2pm). Reply C to confirm."
     * <b>Thursday 2pm (24 hours before):</b> "Tomorrow at 2pm: Botox with Dr. Smith. Reply C to confirm or R to reschedule."
     * <b>Friday 12pm (2 hours before):</b> "See you in 2 hours! Botox at 2pm. Please arrive 10 min early for check-in."
   - Verify timing: Exactly 48hr, 24hr, 2hr before (not 47hr or 25hr)
   - <b>Smart timing:</b> If appointment is Monday 9am, don't send 48hr reminder on Saturday 9am (weekend) - send Friday 5pm instead
   - <b>Test edge case:</b> Appointment booked less than 48hr in advance (tomorrow 2pm booked today at 3pm)
     * Should skip 48hr reminder (already past)
     * Send 24hr and 2hr reminders only
   - <b>If reminders not sending:</b> Check cron job/scheduler (runs every 15 min?), verify reminder logic

4. <b>Patient Replies "C" to Confirm:</b>
   - Patient receives reminder, texts back: "C" or "c" or "Confirm" or "Yes"
   - System should:
     * Mark appointment as "Confirmed by Patient"
     * Update appointment status in dashboard (front desk sees green checkmark)
     * Send confirmation: "Thanks! You're confirmed for Fri 10/19 at 2pm. See you soon!"
     * Stop sending further reminders (already confirmed, no need for 24hr and 2hr reminders)
   - <b>Test:</b> Reply "C" ‚Üí Appointment marked confirmed, auto-reply sent
   - <b>If not working:</b> Implement SMS webhook to detect replies, parse "C" variants (case-insensitive)

5. <b>Aftercare Instructions (Treatment-Specific, Sent After Checkout):</b>
   - After patient checks out from Botox treatment:
     * <b>Immediately (within 5 min):</b> "Thanks for visiting! Botox aftercare: Avoid lying down for 4 hours. No exercise for 24 hours. Avoid touching treated areas. Results visible in 3-5 days, full effect in 10-14 days. Questions? Call us: (555) 123-4567"
     * <b>Different for laser:</b> "Laser aftercare: Apply ice for 15 min every 2 hours today. Use SPF 50+ for 2 weeks. Avoid hot showers for 24 hours. Redness normal for 2-3 days."
   - Verify: Correct aftercare for each service type
   - <b>Database:</b> Each service has "aftercare_message" template
   - <b>Test:</b> Complete treatment ‚Üí Checkout ‚Üí SMS sent within 5 min with correct instructions
   - <b>If not sending:</b> Implement checkout webhook to trigger aftercare SMS

6. <b>Follow-Up Sequences (Automated Engagement):</b>
   - <b>Day 3 after Botox:</b> "How's your Botox? Results should be starting to show! Any questions? Reply here or call us."
   - <b>Day 14 after Botox:</b> "You're at peak Botox results! Want to share a photo? Reply with a pic and we'll update your records."
   - <b>Day 90 after Botox (3 months - time for touch-up):</b> "Time for Botox touch-up! Results typically last 3-4 months. Book now: [link] or reply to schedule."
   - Verify: Sequences trigger on schedule, personalized per service
   - <b>Test:</b> Complete treatment, check if follow-ups sent on day 3, 14, 90
   - <b>If not automated:</b> Implement follow-up scheduler (cron job checks treatments completed X days ago, sends corresponding message)

7. <b>Two-Way Conversation Threading:</b>
   - Patient texts: "Can I book Botox for next Tuesday?"
   - Front desk replies: "Sure! What time works for you?"
   - Patient replies: "2pm?"
   - Front desk: "Perfect! Booked for Tue 10/22 at 2pm. Confirmation sent."
   - Verify: Conversation thread preserved (not separate messages)
   - Test: All messages between same phone number grouped together
   - <b>If threading broken:</b> Ensure messages stored with conversation_id (patient phone number)

8. <b>Birthday & Win-Back Campaigns:</b>
   - <b>Birthday campaign:</b>
     * Trigger: Patient's birthday in 7 days
     * Message: "Happy early birthday, Sarah! üéâ Treat yourself to 20% off any service this month. Book now: [link]"
     * Sent: 7 days before birthday (gives them time to book)
   - <b>Win-back campaign:</b>
     * Trigger: Patient's last visit was 90+ days ago, no upcoming appointments
     * Message: "We miss you, Sarah! It's been 3 months since your last visit. Come back this month and get 15% off. Book now: [link]"
   - <b>Test:</b> Set patient birthday to next week, check if campaign triggers
   - <b>Test:</b> Set patient's last visit to 91 days ago, check if win-back SMS sent
   - <b>If not automated:</b> Implement campaign scheduler (daily cron job)

<b>PART 2: IMPLEMENT EDGE CASES (10 Critical Scenarios)</b>

1. <b>"C" to Confirm ‚Üí Mark Appointment Confirmed:</b>
   - Already covered in Part 1 #4, ensure it's working

2. <b>"R" to Reschedule ‚Üí Create Task for Front Desk:</b>
   - Patient replies: "R" or "r" or "Reschedule"
   - System detects keyword ‚Üí Create task:
     * Task title: "Reschedule Request - Sarah Johnson"
     * Task description: "Patient requested to reschedule Botox (10/19 2pm) via SMS"
     * Assigned to: Front desk team
     * Priority: Normal (not urgent unless <24hr before appointment)
   - Auto-reply: "Got it! We'll call you within 1 business day to reschedule. Need help sooner? Call (555) 123-4567."
   - <b>Test:</b> Reply "R" ‚Üí Task created, auto-reply sent, front desk sees task in dashboard

3. <b>Angry/Negative Reply ‚Üí Sentiment Analysis + Urgent Task:</b>
   - Patient replies: "This is ridiculous! Still swollen after 3 days and no one is calling me back!!!"
   - <b>Solution to implement:</b>
     * Sentiment analysis:
       - Option 1 (Simple): Keyword matching: "ridiculous", "upset", "angry", "terrible", "worst", "sue"
       - Option 2 (Advanced): OpenAI API: Send message to ChatGPT, ask "Is this message angry, neutral, or positive?"
     * If negative sentiment detected:
       - Flag message as "üö® HIGH PRIORITY - ANGRY PATIENT"
       - Create urgent task for manager
       - Auto-reply: "We sincerely apologize for your experience. A manager will call you within 15 minutes. If this is a medical emergency, call 911."
       - Push notification to manager (if mobile app exists)
       - Send email to manager: "Urgent: Angry patient message from Sarah Johnson"
   - <b>Test:</b> Send angry message ‚Üí Flagged, manager alerted, auto-reply sent
   - <b>Database:</b> Add "sentiment" field (positive/neutral/negative), "priority" flag

4. <b>Medical Emergency Keywords ‚Üí Immediate Alert + Auto-Call:</b>
   - Patient texts: "Severe pain and swelling in my lips after filler yesterday. Can't close my mouth."
   - <b>Emergency keywords:</b> "severe pain", "can't breathe", "throat swelling", "chest pain", "allergic reaction", "911", "emergency room", "can't close mouth", "vision blurry"
   - <b>Solution to implement:</b>
     * Scan incoming messages for emergency keywords
     * If detected:
       - IMMEDIATE alert to manager: "üÜò MEDICAL EMERGENCY - Sarah Johnson - 'severe pain and swelling after filler'"
       - Auto-reply: "This sounds urgent. If you're experiencing a medical emergency, call 911 or go to the nearest ER immediately. We're calling you now."
       - Trigger click-to-call: Manager's phone auto-dials patient (or shows "CALL NOW" button)
       - Log: "Emergency message - 10/18/2025 3:45pm - Keywords: severe pain, swelling, can't close mouth"
       - Create incident report (links to patient, treatment, message)
   - <b>Test:</b> Send message with "can't breathe" ‚Üí Manager alerted within 10 seconds, auto-call triggered
   - <b>Database:</b> "emergency_messages" table (patient_id, message_text, keywords_detected, alerted_at, manager_called)

5. <b>SMS Blocked / Delivery Failed ‚Üí Track + Fallback to Email:</b>
   - <b>Problem:</b> Patient opted out ("STOP"), phone number invalid, carrier blocked
   - <b>Solution to implement:</b>
     * Twilio webhook: Delivery status updates
       - Sent ‚úì
       - Delivered ‚úì
       - Failed ‚úó (invalid number, carrier rejected)
       - Undelivered ‚úó (phone off, no signal)
     * If delivery fails:
       - Mark patient: "SMS delivery failed"
       - Fallback: Send same message via email
       - Alert front desk: "Sarah Johnson's SMS failed. Email sent instead. Consider calling."
       - Don't retry SMS (wastes money, likely to fail again)
     * If patient texts "STOP":
       - Mark patient: "Opted out of SMS"
       - Don't send ANY SMS (legal requirement - CAN-SPAM Act)
       - All future communications via email or phone only
   - <b>Test:</b> Use invalid phone number (555-000-0000) ‚Üí SMS fails, email sent, alert shown
   - <b>Test:</b> Reply "STOP" ‚Üí Patient marked opted-out, no further SMS sent

6. <b>Non-English Language ‚Üí Detect + Bilingual Response:</b>
   - Patient texts in Spanish: "Hola, quiero cambiar mi cita para el jueves"
   - <b>Solution to implement:</b>
     * Language detection:
       - Option 1 (Simple): If message contains Spanish keywords ("hola", "cita", "gracias") ‚Üí Assume Spanish
       - Option 2 (Advanced): Use language detection API (Google Cloud Translation API)
     * If Spanish detected:
       - Flag message: "üåê Spanish message"
       - Auto-reply in Spanish: "Gracias por tu mensaje! Te llamaremos pronto. ¬øNecesitas ayuda inmediata? Llama al (555) 123-4567."
       - Create task: "Spanish-speaking patient needs reschedule - Sarah Johnson"
       - Assign to: Bilingual staff member (if designated in system)
     * If no bilingual staff: Auto-reply: "Gracias! We'll have a Spanish-speaking team member call you shortly."
   - <b>Test:</b> Send Spanish message ‚Üí Detected, Spanish auto-reply sent, task created
   - <b>Optional:</b> Auto-translate for staff (Google Translate API): Show English translation in dashboard

7. <b>Spam / Invalid Replies ‚Üí Filter Out:</b>
   - Random number texts practice: "Hey, is this Sarah? You left your wallet at the bar."
   - <b>Solution to implement:</b>
     * If message from unknown number (not in patient database):
       - Don't create task
       - Auto-reply: "This number is for MedSpa patients only. If you're a patient, please provide your name so we can assist you."
       - Log as "Unknown number" for manager review (in case patient texting from different number)
     * If obvious spam: "CONGRATULATIONS! YOU WON $1000! CLICK HERE"
       - Flag as spam (keywords: "congratulations", "click here", "won", "free")
       - Don't create task, don't reply (don't confirm number is active)
   - <b>Test:</b> Message from unknown number ‚Üí Auto-reply asking for name, not added to patient inbox

8. <b>Message Sent at Wrong Time (3 AM) ‚Üí Quiet Hours:</b>
   - <b>Problem:</b> System bug or timezone issue sends reminder at 2 AM, wakes patient up
   - <b>Solution to implement:</b>
     * Quiet hours: 9pm - 9am (local time for practice)
     * If scheduled message would send during quiet hours ‚Üí Delay until 9am
     * Example:
       - Appointment tomorrow 11am, 24hr reminder should send today 11am ‚úì
       - Appointment tomorrow 8am, 24hr reminder should send today 8am ‚úó (too early)
       - Instead: Delay until 9am today
     * Timezone handling:
       - If patient has timezone in profile (rare) ‚Üí Use their timezone
       - Otherwise: Use practice's timezone (EST, PST, etc.)
   - <b>Test:</b> Schedule appointment for 7am tomorrow ‚Üí Reminder delayed until 9am today, not sent at 7am today
   - <b>Implementation:</b> Cron job checks "messages_to_send" queue, skips quiet hours, retries at 9am

9. <b>Rate Limiting (Too Many Messages Too Fast):</b>
   - <b>Problem:</b> Campaign sent to 500 patients, Twilio limits to 100 SMS/minute
   - <b>Solution to implement:</b>
     * Queue system: Add all messages to queue
     * Send rate: 50-100 messages per minute (within Twilio limits)
     * If campaign has 500 messages ‚Üí Send over 5-10 minutes
     * Show progress: "Campaign sending: 237 of 500 sent (47%)"
     * Handle errors: If Twilio returns "Rate limit exceeded" ‚Üí Pause 60 seconds, retry
   - <b>Test:</b> Send campaign to 200 patients ‚Üí Messages queued, sent at controlled rate, all delivered within 5 min

10. <b>Long Messages (>160 Characters) ‚Üí Auto-Split or Shorten:</b>
    - <b>Problem:</b> SMS has 160 character limit, longer messages split into multiple (costs 2-3√ó more)
    - <b>Solution to implement:</b>
      * Check message length before sending
      * If <160 characters ‚Üí Send as-is (1 message)
      * If >160 characters:
        - Option 1: Auto-split into multiple messages (2-3 messages, costs more)
        - Option 2: Shorten message, add link: "Hi Sarah! Reminder: Botox tomorrow 2pm. View details: [link to patient portal]" (saves characters)
        - Option 3: Send MMS instead of SMS if image/long content
      * Warn manager if template >160 chars: "This template is 245 characters and will cost 2 SMS credits per send. Consider shortening."
    - <b>Test:</b> Template with 200 characters ‚Üí Message split or link added, cost calculated correctly

<b>PART 3: ADD ENHANCEMENTS (6 Intelligent Features)</b>

1. <b>AI-Powered Reply Suggestions (Already Built - Item #1):</b>
   - Integration point: When staff viewing message, show AI suggestions: "Suggested replies: 'We'd love to see you! What day works best?' [Use this reply]"
   - Already implemented in item #1, just ensure integration works

2. <b>Smart Timing (Send When Patient Most Likely to Read):</b>
   - <b>Problem:</b> Sending marketing SMS at 2pm when patient at work (ignored)
   - <b>Solution:</b>
     * Track: When does patient typically open messages?
       - Sarah opens messages: 85% between 6-8pm
       - Michael opens messages: 90% during lunch (12-1pm)
     * Schedule marketing campaigns for optimal times:
       - Birthday message to Sarah ‚Üí Send at 7pm (not 10am)
       - Win-back to Michael ‚Üí Send at 12:30pm
     * Machine learning (optional): Analyze historical open rates by hour, personalize per patient
   - <b>Test:</b> Schedule campaign ‚Üí Messages sent at personalized optimal times (not all at once)

3. <b>Message Templates Library (Pre-Written, Customizable):</b>
   - <b>Problem:</b> Staff typing same messages 50 times: "What time works for you?"
   - <b>Solution:</b>
     * Template library (20-30 common messages):
       - "Reschedule offer": "I'd be happy to reschedule! What day and time work better for you?"
       - "Payment reminder": "You have an outstanding balance of $[amount]. We can take payment over the phone or you can pay online: [link]"
       - "Aftercare question": "That's normal and should resolve in 2-3 days. If it worsens or you're concerned, please call us."
     * Quick access: Staff clicks "Templates" dropdown, selects template, personalize ([amount] auto-filled), send
     * Customizable: Manager can add/edit templates
   - <b>Test:</b> Select template, auto-fills with patient data, staff sends in <10 seconds

4. <b>Delivery & Engagement Analytics Dashboard:</b>
   - <b>Problem:</b> Don't know if messages are working (open rate, response rate, conversion rate)
   - <b>Solution:</b>
     * Dashboard showing:
       - <b>Delivery rate:</b> 98.5% delivered (500 sent, 493 delivered, 7 failed)
       - <b>Response rate:</b> 23% replied (115 of 500 patients replied)
       - <b>Confirmation rate:</b> 67% confirmed via SMS (saves front desk calls)
       - <b>Sentiment breakdown:</b> 5% negative, 15% neutral, 80% positive
       - <b>Emergency detections:</b> 2 emergency messages this month (both resolved)
       - <b>Campaign ROI:</b> Win-back campaign sent to 200 patients ‚Üí 18 bookings ($7,200 revenue) ‚Üí ROI 360√ó (cost $20 for SMS)
     * <b>Breakdown by service:</b> Botox patients have 75% confirmation rate, Laser patients 62% (need better reminders for laser?)
     * Export reports: Monthly SMS summary for manager review
   - <b>Test:</b> Dashboard shows real-time stats, accurate counts

5. <b>Automated Campaigns with A/B Testing:</b>
   - <b>Problem:</b> Don't know which message version works better
   - <b>Solution:</b>
     * A/B test campaigns:
       - Version A: "We miss you! Come back and get 15% off."
       - Version B: "Ready for a refresh? Book this week and save 15%."
     * Split campaign: 50% receive A, 50% receive B
     * Track: Which version has higher booking rate?
       - Version A: 12% booked (12 of 100)
       - Version B: 18% booked (18 of 100) ‚Üê WINNER
     * Use B for future campaigns
   - <b>Test:</b> Create A/B campaign, messages sent evenly split, results tracked

6. <b>Integration with Patient Portal & Calendar:</b>
   - When patient clicks link in SMS "Book now: [link]":
     * Opens patient portal pre-filled: Service = Botox, Practitioner = Dr. Smith
     * Patient selects time slot, confirms
     * Appointment instantly added to calendar
     * SMS sent: "Booked! See you Fri 10/25 at 2pm."
   - <b>Test:</b> Click SMS link ‚Üí Portal opens, book appointment, confirmation SMS sent

<b>DELIVERABLES:</b>
- All 8 core features verified and working (Twilio send/receive, confirmations, reminders, aftercare, follow-ups, two-way messaging, campaigns)
- All 10 edge cases implemented (C/R replies, sentiment analysis, emergency detection, delivery tracking, language detection, spam filtering, quiet hours, rate limiting, message splitting, timezone handling)
- 6 enhancements added (AI reply suggestions integration, smart timing, template library, analytics dashboard, A/B testing, portal integration)
- No-show rate reduced by 40-60% (reminders + confirmations)
- Patient engagement improved (two-way messaging reduces calls, automated follow-ups increase rebooking)
- Emergency response time <5 minutes (keyword detection + instant alerts)

<b>TESTING CHECKLIST:</b>
- [ ] Book appointment ‚Üí Confirmation SMS sent within 60 seconds
- [ ] Appointment tomorrow 2pm ‚Üí 48hr, 24hr, 2hr reminders sent on schedule
- [ ] Reply "C" ‚Üí Appointment marked confirmed, auto-reply sent
- [ ] Reply "R" ‚Üí Task created for front desk, auto-reply sent
- [ ] Send angry message ‚Üí Flagged as high priority, manager alerted
- [ ] Send "can't breathe" message ‚Üí Emergency alert triggered, manager notified within 10 seconds
- [ ] SMS delivery fails ‚Üí Email sent as fallback, front desk notified
- [ ] Reply "STOP" ‚Üí Patient marked opted-out, no further SMS sent
- [ ] Send Spanish message ‚Üí Detected, Spanish auto-reply sent
- [ ] Unknown number texts ‚Üí Auto-reply asks for name
- [ ] Reminder scheduled for 3 AM ‚Üí Delayed until 9 AM
- [ ] Send 200 messages ‚Üí Queued, sent at controlled rate within 5 min
- [ ] Message >160 characters ‚Üí Split or shortened with link
- [ ] Complete treatment ‚Üí Aftercare SMS sent within 5 min
- [ ] Patient's 90th day since last visit ‚Üí Win-back SMS sent
- [ ] Patient's birthday in 7 days ‚Üí Birthday SMS sent
- [ ] Two-way conversation ‚Üí Messages threaded correctly
- [ ] Analytics dashboard shows delivery rate, response rate, sentiment
- [ ] Template library accessible, auto-fills patient data

<b>SUCCESS METRICS:</b>
- No-show rate reduction: 40-60% (from 15-20% to 5-8%)
- Confirmation rate: 70%+ of patients confirm via SMS (saves 200+ phone calls/month)
- Response time to patient messages: <15 min during business hours
- Emergency message detection: 100% of urgent messages flagged and alerted
- Delivery rate: >98% (failed deliveries <2%)
- Campaign ROI: Win-back campaigns generate 10-20√ó return (cost $50, revenue $500-$1000)
- Patient satisfaction: 85%+ say they prefer SMS over phone calls
- Staff efficiency: 50-70% reduction in outbound calls (automated confirmations, reminders, follow-ups)

<b>HOW TO APPROACH:</b>
1. Test full patient journey: Book appointment ‚Üí Confirmation SMS ‚Üí 48hr reminder ‚Üí 24hr reminder ‚Üí 2hr reminder ‚Üí Reply "C" ‚Üí Aftercare SMS ‚Üí Follow-up SMS (day 3, 14, 90)
2. Test all 10 edge cases systematically (angry message, emergency keywords, delivery failures, etc.)
3. Implement intelligent features (sentiment analysis using OpenAI API or keyword matching, emergency detection, template library)
4. Set up analytics dashboard (delivery rate, response rate, sentiment breakdown)
5. Optimize: Test A/B campaigns, find best messaging, implement quiet hours, rate limiting
6. Provide detailed report: "Tested all workflows. Found 3 bugs (listed below). Implemented emergency detection (2 test alerts triggered successfully), sentiment analysis (flagged 5 of 5 angry messages), template library (staff save 5 min per conversation). Confirmation rate: 72%. No-show rate: 6% (down from 18%). Ready for production."

This is the nervous system of patient communication - get it right and patients stay engaged!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Twilio send/receive working</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Confirmation triggers on booking</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Reminder sequence timing (T-48hr, T-24hr, T-2hr)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient replies logged correctly</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Aftercare instructions (treatment-specific) correct</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Follow-up sequences automated</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Two-way conversations work</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Birthday/win-back campaigns trigger correctly</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>"C" reply ‚Üí Auto-confirm appointment</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>"R" reply ‚Üí Create reschedule task</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Angry reply ‚Üí Sentiment analysis, urgent task</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Medical emergency keywords ‚Üí Immediate alert</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>SMS blocked ‚Üí Track delivery, fallback to email</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Non-English language ‚Üí Bilingual response</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Patient Portal -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('portal-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">12</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üåê Patient Portal - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ Mobile app ‚Ä¢ Live chat ‚Ä¢ Loyalty program ‚Ä¢ üéØ BUILD ORDER: #10</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="portal-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Patient Portal (patient-facing web/mobile application). This is about verifying core self-service features work perfectly (login, view appointments, view treatment history, view photos, pay invoices, update contact info), implementing critical security and privacy measures (password reset, session timeout, photo permissions, HIPAA compliance), handling edge cases (duplicate accounts, locked accounts, portal downtime), and adding engagement features (loyalty points display, referral program, Apple Wallet integration, live chat).

<b>WHAT THIS IS:</b>
The Patient Portal is the self-service platform where patients manage their relationship with the practice 24/7 without calling. This is MISSION-CRITICAL because:
- Patient convenience: Book appointments, view history, pay bills anytime (even at 11pm Sunday)
- Staff efficiency: Reduces calls by 40-60% (patients self-serve instead of calling)
- Engagement: Patients who use portal have 2-3√ó higher lifetime value (more engaged, return more often)
- Revenue: Online booking captures after-hours appointments (30% of bookings happen outside business hours)
- Data accuracy: Patients update their own info (address, phone, medical history) ‚Üí Less staff data entry

<b>WHY WE NEED THIS REVIEW:</b>
Patients expect modern, mobile-friendly portals (like banking apps). If portal is slow, confusing, or buggy, they'll just call the front desk (defeats the purpose). We need to test existing features, ensure security (HIPAA compliance, secure login), fix common pain points (forgot password, mobile UX), and add features that drive engagement (loyalty points, referral rewards, live chat).

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Patient Books Appointment at 9pm on Sunday</b>
   - Patient Sarah browsing phone at 9pm Sunday, thinks "I should book Botox"
   - Logs into portal on phone ‚Üí Views calendar ‚Üí Sees Friday 2pm slot available
   - Books appointment ‚Üí Instant confirmation SMS + email
   - Value: Captured booking outside business hours (practice closed), no staff involved
   - <b>Current state:</b> Unknown if mobile booking works smoothly (responsive design, fast loading, easy flow)
   - <b>Needed:</b> Mobile-optimized, fast (<2 sec load), intuitive booking flow

2. <b>Scenario: Patient Forgets Password, Can't Login</b>
   - Patient tries to login: "Email: sarah@email.com, Password: ****"
   - Error: "Incorrect password"
   - Tries 2 more times ‚Üí Account locked after 5 failed attempts (security)
   - Clicks "Forgot Password" ‚Üí Enters email ‚Üí Receives reset link
   - Clicks link ‚Üí Sets new password ‚Üí Logged in
   - <b>Current state:</b> Unknown if password reset works, how long link valid, account lockout after failed attempts
   - <b>Needed:</b> Secure password reset flow, account lockout protection, clear error messages

3. <b>Scenario: Patient Wants to Hide Embarrassing Photos from Portal</b>
   - Patient had laser treatment for private area (bikini line, etc.)
   - Before/after photos exist in system (practitioner needs them)
   - Patient says: "I don't want those photos visible in my portal, what if someone sees my phone?"
   - <b>Needed:</b> Photo privacy settings:
     * Patient can mark photos "Hide from Portal" (still visible to staff, just not in patient's portal login)
     * OR: Photos of sensitive areas auto-hidden unless patient explicitly enables
     * Manager can override (if patient wants to see progress photos later)

4. <b>Scenario: Patient Has 2 Accounts (Duplicate Problem)</b>
   - Patient originally created account with personal email: sarah.johnson@gmail.com
   - Later, front desk created account with work email: sjohnson@company.com (didn't know personal account existed)
   - Now patient has 2 logins, one shows old appointments, one shows new appointments
   - Patient confused: "Where are all my records?"
   - <b>Needed:</b> Duplicate account detection, merge accounts tool (consolidate all data into one login)

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything Works)</b>

1. <b>Patient Login & Authentication:</b>
   - Test: Patient goes to portal.medspa.com
   - Login options:
     * Email + password (primary method)
     * Magic link (passwordless): Enter email ‚Üí Receive link ‚Üí Click ‚Üí Logged in
     * Social login (optional): "Sign in with Google" or "Sign in with Apple"
   - Verify: Successful login redirects to dashboard
   - Security checks:
     * Password encrypted (bcrypt, never stored plain text)
     * HTTPS only (no HTTP)
     * Session timeout after 30 min inactive (HIPAA requirement)
     * Failed login attempts tracked: 5 failed attempts ‚Üí Account locked for 15 min (prevents brute force)
   - <b>Test:</b> Login with correct credentials ‚Üí Success
   - <b>Test:</b> Login with wrong password 5 times ‚Üí Account locked, error message shown
   - <b>If not working:</b> Check authentication system (JWT tokens, session management), password hashing

2. <b>Password Reset Flow:</b>
   - Patient clicks "Forgot Password"
   - Enters email: sarah@email.com
   - System sends reset email (within 60 seconds):
     "Reset your password: Click here [link]. Link expires in 1 hour."
   - Patient clicks link ‚Üí Opens password reset page
   - Enters new password (min 8 characters, 1 uppercase, 1 number, 1 special char)
   - Password updated ‚Üí "Password changed successfully. Please login."
   - Patient logs in with new password ‚Üí Success
   - <b>Security:</b>
     * Reset link expires after 1 hour
     * Reset link single-use (can't use same link twice)
     * Reset link invalid after password changed
   - <b>Test:</b> Request password reset ‚Üí Receive email, click link, set new password, login successful
   - <b>Test:</b> Try to use reset link after 1 hour ‚Üí Error: "Link expired. Request new reset link."
   - <b>If not working:</b> Check email service (SendGrid/AWS SES), token generation/validation

3. <b>Dashboard Overview (Homepage After Login):</b>
   - Patient logs in ‚Üí Sees dashboard with:
     * Welcome message: "Welcome back, Sarah!"
     * Upcoming appointments: "Botox - Fri 10/25 at 2pm with Dr. Smith"
     * Package credits: "You have 3 of 6 laser sessions remaining (expires 02/15/2026)"
     * Loyalty points: "You have 1,240 points ($12.40 credit)"
     * Outstanding balance: "You have $120 outstanding. Pay now" (if unpaid invoices exist)
     * Quick actions: [Book Appointment] [View History] [Update Profile] [Message Us]
   - Verify: All data accurate, real-time (not cached from yesterday)
   - <b>Test:</b> Login ‚Üí Dashboard shows correct appointments, package credits, loyalty points
   - <b>If data wrong:</b> Check API calls, database queries, caching logic

4. <b>View Upcoming Appointments:</b>
   - Patient clicks "Appointments" ‚Üí Sees list:
     * Upcoming: "Botox - Fri 10/25 at 2pm with Dr. Smith - [Reschedule] [Cancel]"
     * Past: "Laser Hair Removal - Mon 09/15 at 3pm with Dr. Jones"
   - Patient can:
     * Reschedule: Click [Reschedule] ‚Üí Select new date/time ‚Üí Confirm
     * Cancel: Click [Cancel] ‚Üí Confirm cancellation ‚Üí Appointment cancelled, front desk notified
   - Verify: Cancellation policy enforced (e.g., can't cancel <24hr before appointment without fee)
   - <b>Test:</b> Reschedule appointment ‚Üí New time saved, confirmation sent
   - <b>Test:</b> Cancel appointment >24hr before ‚Üí Cancelled, no fee
   - <b>Test:</b> Try to cancel <24hr before ‚Üí Warning: "Cancellation within 24 hours incurs $50 fee. Proceed?"
   - <b>If not working:</b> Check appointment update API, cancellation policy logic

5. <b>Book New Appointment (Self-Service Scheduling):</b>
   - Patient clicks "Book Appointment"
   - Flow:
     * Select service: "Botox - Forehead & Crow's Feet"
     * Select practitioner: "Dr. Smith" (or "No preference")
     * Select date: Calendar shows available dates (greyed out if fully booked)
     * Select time: Shows available time slots (e.g., 10am, 11am, 2pm, 3pm)
     * Confirm: "Botox with Dr. Smith on Fri 10/25 at 2pm - $450"
     * Click "Book Now" ‚Üí Appointment created
   - Confirmation: SMS + email sent instantly
   - Verify: Real-time availability (doesn't show slots already booked 5 min ago)
   - Verify: Double-booking prevention (if 2 patients book same slot simultaneously, one gets error: "Slot no longer available. Please select different time.")
   - <b>Test:</b> Book appointment ‚Üí Slot reserved, confirmation sent, appears in dashboard
   - <b>Test:</b> Try to book fully-booked slot ‚Üí Error shown or slot not selectable
   - <b>If not working:</b> Check real-time availability API, calendar integration, race condition handling

6. <b>View Treatment History & SOAP Notes:</b>
   - Patient clicks "Treatment History"
   - Sees chronological list of all past treatments:
     * "10/15/2025 - Botox - Forehead & Crow's Feet - Dr. Smith - $450 [View Details]"
     * "09/10/2025 - Laser Hair Removal - Underarms - Dr. Jones - $200 [View Details]"
   - Click [View Details] ‚Üí Opens detailed view:
     * Date, service, practitioner
     * SOAP notes (simplified for patient):
       - Subjective: "Patient reports fine lines worsening"
       - Objective: "Moderate crow's feet bilaterally"
       - Assessment: "Good candidate for Botox"
       - Plan: "Administered 24 units Botox, follow-up in 2 weeks"
     * Products used: "Botox - 24 units"
     * Before/after photos (if applicable)
   - Privacy: Patient sees only THEIR records (not other patients')
   - <b>Test:</b> View treatment history ‚Üí All past treatments appear
   - <b>Test:</b> View SOAP notes ‚Üí Notes readable, not overly medical jargon
   - <b>If not working:</b> Check treatment history API, permission logic (patient can only see own data)

7. <b>View Before/After Photos:</b>
   - Patient clicks "Photos" or "Gallery"
   - Sees organized photo gallery:
     * Filter by treatment type: [All] [Botox] [Laser] [Fillers]
     * Sort by date: Newest first
     * Grid view: Thumbnail images with dates
   - Click photo ‚Üí Opens full-screen view
     * Side-by-side comparison (before on left, after on right)
     * Date taken, treatment type
     * Option to download (for personal records)
   - Privacy: Patient can hide sensitive photos from portal (covered in edge cases)
   - <b>Test:</b> View photos ‚Üí All treatment photos appear, organized correctly
   - <b>Test:</b> Filter by "Botox" ‚Üí Only Botox photos shown
   - <b>Test:</b> Click photo ‚Üí Full-screen view works, side-by-side comparison clear
   - <b>If not working:</b> Check photo storage (S3/Cloudinary), API calls, permission logic

8. <b>View & Pay Invoices:</b>
   - Patient clicks "Billing" or "Invoices"
   - Sees list:
     * Paid invoices: "10/15/2025 - Botox - $450 - PAID [View Receipt]"
     * Unpaid invoices: "10/01/2025 - Laser - $200 - UNPAID [Pay Now]"
   - Click [Pay Now] ‚Üí Payment form:
     * Amount due: $200
     * Payment method: [Saved card ****1234] [New card] [HSA/FSA card]
     * Click "Pay" ‚Üí Card charged, receipt sent via email + SMS
   - Verify: Payment processed instantly (Stripe/Square integration)
   - Verify: Receipt generated (PDF with logo, itemized breakdown)
   - <b>Test:</b> Pay unpaid invoice ‚Üí Payment successful, invoice marked "PAID", receipt sent
   - <b>Test:</b> View paid invoice ‚Üí Receipt downloadable as PDF
   - <b>If not working:</b> Check payment API integration, receipt generation

9. <b>Update Contact Information & Medical History:</b>
   - Patient clicks "Profile" or "Settings"
   - Can update:
     * Name (first, last)
     * Phone number
     * Email address
     * Home address
     * Date of birth
     * Medical history: Allergies, medications, past procedures, conditions
   - Click "Save Changes" ‚Üí Updates instantly
   - Verification: If email changed ‚Üí Send verification link: "Confirm your new email: [link]"
   - <b>Test:</b> Update phone number ‚Üí Saved, front desk sees updated number
   - <b>Test:</b> Add allergy: "Lidocaine" ‚Üí Saved, practitioner sees red alert on chart
   - <b>If not working:</b> Check profile update API, email verification flow

10. <b>Fill Out Pre-Appointment Forms (Medical History):</b>
    - Before first appointment (or annually), patient must complete medical history form
    - Portal shows: "‚ö†Ô∏è Please complete medical history form before your appointment"
    - Click "Complete Form" ‚Üí Opens form:
      * Allergies (text input)
      * Current medications (text input)
      * Past procedures (checkboxes: Botox, Fillers, Laser, Surgery, etc.)
      * Medical conditions (checkboxes: Diabetes, High BP, Pregnancy, etc.)
      * Emergency contact (name, phone)
      * Digital signature: "I certify this information is accurate"
    - Submit form ‚Üí Saved, practitioner sees when opening chart
    - <b>Test:</b> Complete form ‚Üí Submitted successfully, appears in patient profile
    - <b>If form not submitting:</b> Check form API, validation logic, signature capture

<b>PART 2: IMPLEMENT EDGE CASES (12 Critical Scenarios)</b>

1. <b>Forgot Password ‚Üí Reset Flow (Already Covered in Part 1 #2):</b>
   - Ensure working correctly

2. <b>Account Lockout After Failed Logins ‚Üí Security Protection:</b>
   - <b>Problem:</b> Hacker trying to brute-force password (try thousands of passwords)
   - <b>Solution to implement:</b>
     * Track failed login attempts per email
     * After 5 failed attempts ‚Üí Lock account for 15 minutes
     * Show message: "Too many failed login attempts. Account locked for 15 minutes. Or click 'Forgot Password' to reset."
     * After 15 min ‚Üí Auto-unlock
     * Alternative: Send email alert: "Someone tried to login to your account 5 times unsuccessfully. Was this you? If not, reset your password immediately."
   - <b>Test:</b> Try wrong password 5 times ‚Üí Account locked, error message shown
   - <b>Test:</b> Wait 15 min ‚Üí Account auto-unlocked, can login again

3. <b>Duplicate Accounts (Same Patient, Multiple Logins) ‚Üí Merge Accounts:</b>
   - <b>Problem:</b> Sarah has 2 accounts: sarah@gmail.com and sarah@work.com (created by different staff members)
   - <b>Solution to implement:</b>
     * Detection: When creating account, check if patient with same name + DOB already exists
     * Warning: "Patient named Sarah Johnson (DOB 05/12/1985) already has account with sarah@gmail.com. Use existing account or create new?"
     * Merge tool (manager/admin only):
       - Select 2 accounts to merge
       - Choose primary login (e.g., sarah@gmail.com)
       - Consolidate all data: appointments, invoices, photos, history
       - Archive secondary account (sarah@work.com) ‚Üí Redirect to primary
       - Patient can now login with either email (both work), but data unified
   - <b>Test:</b> Create duplicate account ‚Üí Warning shown
   - <b>Test:</b> Merge 2 accounts ‚Üí All data consolidated, both logins work

4. <b>Session Timeout (HIPAA Requirement) ‚Üí Auto-Logout After 30 Min:</b>
   - <b>Problem:</b> Patient logs in at work, leaves desk for 2 hours, coworker sees patient portal open (HIPAA violation)
   - <b>Solution to implement:</b>
     * Track last activity time
     * If inactive for 30 min ‚Üí Auto-logout
     * Show warning at 28 min: "You'll be logged out in 2 minutes due to inactivity. Stay logged in? [Yes]"
     * If patient clicks [Yes] ‚Üí Reset timer
     * If no response ‚Üí Auto-logout at 30 min, redirect to login page: "You've been logged out due to inactivity. Please login again."
   - <b>Test:</b> Login, wait 30 min inactive ‚Üí Auto-logged out
   - <b>Test:</b> Login, wait 28 min, click "Stay logged in" ‚Üí Session extended

5. <b>Photo Privacy Settings ‚Üí Patient Can Hide Sensitive Photos:</b>
   - <b>Problem:</b> Patient has before/after photos of private areas (bikini laser, intimate filler, etc.), doesn't want visible in portal
   - <b>Solution to implement:</b>
     * Each photo has privacy setting:
       - "Visible in Portal" (default for most photos)
       - "Hidden from Portal" (patient can't see in portal, but practitioner can see in admin dashboard)
     * Patient can toggle: Click photo ‚Üí Click "Hide from Portal" ‚Üí Photo disappears from patient's portal but still exists in system
     * OR: Practitioner sets default: Photos tagged "sensitive area" auto-hidden unless patient enables
     * Manager can override (if patient wants to view progress later)
   - <b>Test:</b> Patient hides photo ‚Üí No longer visible in portal, but staff can still see in admin
   - <b>Test:</b> Patient unhides photo ‚Üí Appears in portal again

6. <b>Mobile Responsiveness ‚Üí Portal Works on Phone/Tablet:</b>
   - <b>Problem:</b> 70% of patients access portal on phone (not desktop), if not mobile-friendly they can't use it
   - <b>Solution to implement:</b>
     * Responsive design: Layout adapts to screen size
       - Desktop: Multi-column layout, full navigation sidebar
       - Mobile: Single-column layout, hamburger menu, bottom navigation
     * Touch-friendly: Buttons large enough to tap (min 44px √ó 44px)
     * Fast loading on mobile: Optimize images, lazy loading, <3 sec load time on 4G
   - <b>Test:</b> Open portal on iPhone, Android, iPad ‚Üí All features work
   - <b>Test:</b> Book appointment on phone ‚Üí Flow smooth, easy to tap date/time
   - <b>Test:</b> View photos on phone ‚Üí Gallery works, pinch-to-zoom works
   - <b>If not responsive:</b> Implement responsive CSS (Tailwind, Bootstrap), test on multiple devices

7. <b>Portal Downtime / Server Error ‚Üí Graceful Degradation:</b>
   - <b>Problem:</b> Server crashes during deployment, portal offline for 10 min
   - <b>Solution to implement:</b>
     * Show user-friendly error page: "We're currently updating our system. Please try again in 10 minutes. Need immediate help? Call us: (555) 123-4567"
     * Don't show technical errors: "500 Internal Server Error - database connection failed" ‚ùå (scares patients)
     * Redirect to status page (optional): "Check system status: status.medspa.com"
     * Send alert to admin: "Portal down - investigate immediately"
   - <b>Test:</b> Simulate server error (turn off API) ‚Üí Error page shows, not ugly technical error

8. <b>Booking Appointments for Minors (<18) ‚Üí Require Parent Consent:</b>
   - <b>Problem:</b> 16-year-old tries to book Botox (most states require parent consent for <18)
   - <b>Solution to implement:</b>
     * Check patient age: If DOB shows <18 years old
     * Block certain services: "Botox, fillers require parent/guardian consent for patients under 18. Please call us to schedule: (555) 123-4567"
     * OR: Allow booking but flag: "Parent/guardian must accompany patient and sign consent on day of appointment"
   - <b>Test:</b> Patient age 16 tries to book Botox ‚Üí Blocked or flagged

9. <b>Outstanding Balance ‚Üí Prevent Booking Until Paid:</b>
   - <b>Problem:</b> Patient owes $450 from last visit, tries to book new appointment without paying
   - <b>Solution to implement:</b>
     * Check outstanding balance before booking
     * If balance >$0:
       - Show warning: "You have an outstanding balance of $450. Please pay before booking new appointment: [Pay Now]"
       - Block booking until paid
       - OR: Manager setting: Allow booking but require deposit (50% upfront)
   - <b>Test:</b> Patient with $450 unpaid tries to book ‚Üí Warning shown, must pay first

10. <b>Accessibility (WCAG Compliance) ‚Üí Portal Usable by Patients with Disabilities:</b>
    - <b>Problem:</b> Visually impaired patient using screen reader can't navigate portal
    - <b>Solution to implement:</b>
      * Screen reader compatible:
        - All images have alt text: `<img alt="Before photo - Botox treatment">`
        - Semantic HTML: `<nav>`, `<main>`, `<button>` (not `<div onclick>`)
        - ARIA labels: `<button aria-label="Book appointment">`
      * Keyboard navigation: All actions accessible via Tab/Enter (no mouse required)
      * Color contrast: Text readable (WCAG AA standard - 4.5:1 contrast ratio)
      * Font size: Readable (min 16px), zoomable to 200% without breaking layout
    - <b>Test:</b> Use screen reader (VoiceOver on Mac, NVDA on Windows) ‚Üí Can navigate entire portal
    - <b>Test:</b> Use keyboard only (no mouse) ‚Üí Can book appointment, view history, pay invoice

11. <b>Social Login (Google, Apple) ‚Üí Faster Signup/Login:</b>
    - <b>Problem:</b> Patients hate creating new passwords, forget them
    - <b>Solution to implement:</b>
      * Add "Sign in with Google" button
      * Add "Sign in with Apple" button
      * OAuth flow: Click button ‚Üí Redirected to Google/Apple ‚Üí Authorize ‚Üí Redirected back to portal ‚Üí Logged in
      * First-time login: Auto-create account using Google/Apple email
      * Security: Store only Google/Apple ID, not password (passwordless)
    - <b>Test:</b> Click "Sign in with Google" ‚Üí OAuth flow works, logged in successfully

12. <b>Email Already Used by Different Patient ‚Üí Prevent Account Creation:</b>
    - <b>Problem:</b> Patient tries to sign up with sarah@gmail.com, but that email already used by different patient (Sarah Williams, not Sarah Johnson)
    - <b>Solution to implement:</b>
      * Check email uniqueness: One email = one account
      * If email taken: "This email is already registered. Try logging in or use 'Forgot Password' to reset."
      * If patient insists it's their email: "If you believe this is an error, please call us: (555) 123-4567"
    - <b>Test:</b> Try to create account with existing email ‚Üí Error shown, can't proceed

<b>PART 3: ADD ENHANCEMENTS (8 Engagement Features)</b>

1. <b>Loyalty Points Display (Gamification):</b>
   - <b>Problem:</b> Patients don't know they're earning points, don't use them
   - <b>Solution:</b>
     * Dashboard shows: "You have 1,240 points ($12.40 credit)"
     * Click "Loyalty Program" ‚Üí Detailed view:
       - Points balance: 1,240 points
       - Points history: "10/15: Earned 450 points (Botox $450)" | "09/10: Redeemed 500 points ($5 off)"
       - How to earn: "$1 spent = 1 point" | "Referral = 500 points" | "Birthday month = 2√ó points"
       - How to redeem: "1,000 points = $10 off any service"
       - Redeem now: [Use 1,200 points ($12 off)] button
   - <b>Test:</b> View loyalty points ‚Üí Balance accurate, history correct, can redeem

2. <b>Referral Program ‚Üí Share Link, Get Rewards:</b>
   - <b>Problem:</b> Want patients to refer friends, but no easy way
   - <b>Solution:</b>
     * Patient clicks "Refer a Friend" ‚Üí Gets unique referral link:
       "medspa.com/referral/SARAH2025"
     * Share options: [Copy Link] [Text Friend] [Email Friend] [Post to Social Media]
     * When friend books using link:
       - Friend gets: 15% off first treatment
       - Patient (referrer) gets: 500 loyalty points ($5 credit) + entry into monthly drawing (win free treatment)
     * Dashboard shows: "You've referred 3 friends! Earned 1,500 points."
   - <b>Test:</b> Generate referral link, share, friend books ‚Üí Referrer earns points, friend gets discount

3. <b>Apple Wallet Integration ‚Üí Appointment Passes:</b>
   - <b>Problem:</b> Patients forget appointments (even with SMS reminders)
   - <b>Solution:</b>
     * After booking appointment, offer: "Add to Apple Wallet" button
     * Generates Apple Wallet pass with:
       - QR code (for check-in)
       - Date/time: "Fri 10/25 at 2:00pm"
       - Service: "Botox - Forehead & Crow's Feet"
       - Location: "MedSpa - 123 Main St"
       - Reminder: Auto-notification 1 hour before
     * Patient sees appointment in Apple Wallet next to credit cards
     * Day of appointment: Lock screen shows reminder at 1pm: "Botox in 1 hour at MedSpa"
   - <b>Test:</b> Book appointment, add to Apple Wallet ‚Üí Pass created, notification triggers 1 hour before

4. <b>Live Chat (Real-Time Messaging with Front Desk):</b>
   - <b>Problem:</b> Patient has quick question, doesn't want to call and wait on hold
   - <b>Solution:</b>
     * Chat widget: Bottom-right corner of portal: [üí¨ Live Chat]
     * Click ‚Üí Opens chat window
     * Patient: "Hi, can I reschedule my Friday appointment to Saturday?"
     * Front desk (if online): Responds within 2 min: "Sure! What time on Saturday works for you?"
     * If offline: Auto-reply: "We're currently offline. We'll respond within 1 business day. Or call us: (555) 123-4567"
     * Chat history saved: Patient can see past conversations
     * Integration options: Intercom, Drift, Zendesk Chat, custom built
   - <b>Test:</b> Send chat message during business hours ‚Üí Front desk responds within 5 min

5. <b>Treatment Recommendations (AI-Powered Suggestions):</b>
   - <b>Problem:</b> Patient doesn't know what services would benefit them
   - <b>Solution:</b>
     * Dashboard shows: "Recommended for you:"
       - "Botox Touch-Up" (last Botox was 3 months ago, typical duration 3-4 months)
       - "Lip Filler" (had Botox, commonly paired treatment)
       - "Skincare Products" (Retinol cream extends Botox results)
     * Logic:
       - Based on treatment history: If patient gets Botox regularly ‚Üí Suggest touch-up 3 months after last treatment
       - Based on popular pairings: 80% of Botox patients also get fillers ‚Üí Suggest filler
       - Based on season: Summer approaching ‚Üí Suggest laser hair removal
     * Click recommendation ‚Üí Opens booking flow pre-filled with that service
   - <b>Test:</b> Last Botox 90 days ago ‚Üí "Botox Touch-Up" recommended

6. <b>Push Notifications (Mobile App):</b>
   - <b>Problem:</b> SMS costs money, some patients prefer app notifications
   - <b>Solution:</b>
     * If patient has mobile app installed (iOS/Android), send push notifications:
       - Appointment reminder: "Botox tomorrow at 2pm"
       - Payment reminder: "You have $120 outstanding. Pay now in app."
       - Promotion: "Book this week and save 15%!"
       - Loyalty: "You earned 500 points! See rewards."
     * Patient can control notification settings: [Appointment Reminders: ON] [Promotions: OFF]
   - <b>Test:</b> Install app, enable notifications ‚Üí Receive push for appointment reminder

7. <b>Membership Management (View Benefits, Auto-Billing):</b>
   - <b>Problem:</b> Patient on membership ($199/month), doesn't know what benefits they have
   - <b>Solution:</b>
     * Portal shows "Membership" section:
       - Status: "Active - Silver Tier ($199/month)"
       - Benefits: "2 services/month included" | "15% off all other services" | "Priority booking"
       - Usage this month: "1 of 2 services used"
       - Next billing date: "11/01/2025 - $199 will be charged to card ****1234"
       - Manage: [Update Payment Method] [Change Tier] [Cancel Membership]
     * Cancellation policy: "30-day notice required. Cancel by 11/01 to avoid next charge."
   - <b>Test:</b> View membership ‚Üí Benefits displayed, usage tracked, can update payment method

8. <b>Treatment Plans & Progress Tracking:</b>
   - <b>Problem:</b> Patient on multi-treatment plan (e.g., 6 laser sessions), doesn't track progress
   - <b>Solution:</b>
     * Portal shows "Treatment Plans":
       - "Laser Hair Removal - Underarms (6 sessions)"
       - Progress bar: "3 of 6 completed (50%)" ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë
       - Next session: "Recommended: Book session #4 in 4-6 weeks"
       - Before/after photos: Side-by-side comparison of session 1 vs session 3
       - Results: "Hair reduction: 60% (estimated based on typical outcomes)"
     * Encourages completion: "You're halfway there! Book next session: [Book Now]"
   - <b>Test:</b> View treatment plan ‚Üí Progress tracked, next session suggested

<b>DELIVERABLES:</b>
- All 10 core features verified and working (login, password reset, dashboard, appointments, booking, history, photos, invoices, profile updates, forms)
- All 12 edge cases implemented (password reset, account lockout, duplicate accounts, session timeout, photo privacy, mobile responsiveness, downtime handling, minor consent, outstanding balance blocking, accessibility, social login, email uniqueness)
- 8 engagement features added (loyalty points display, referral program, Apple Wallet, live chat, AI recommendations, push notifications, membership management, treatment plan tracking)
- HIPAA compliance verified (session timeout, secure login, encrypted data, access controls)
- Mobile-optimized (70%+ of users access on phone)
- Patient self-service rate >50% (half of patients book/reschedule/pay online without calling)

<b>TESTING CHECKLIST:</b>
- [ ] Login with email + password ‚Üí Success
- [ ] Login with magic link ‚Üí Receive email, click link, logged in
- [ ] Wrong password 5 times ‚Üí Account locked for 15 min
- [ ] Forgot password ‚Üí Reset email sent, link works, password changed
- [ ] Dashboard shows upcoming appointments, package credits, loyalty points
- [ ] View treatment history ‚Üí All past treatments displayed
- [ ] View before/after photos ‚Üí Gallery organized, full-screen view works
- [ ] Book new appointment ‚Üí Real-time availability, instant confirmation
- [ ] Reschedule appointment ‚Üí New time saved, confirmation sent
- [ ] Cancel appointment <24hr ‚Üí Warning shown (cancellation fee)
- [ ] Pay unpaid invoice ‚Üí Payment processed, receipt sent
- [ ] Update contact info ‚Üí Saved instantly, visible to staff
- [ ] Complete medical history form ‚Üí Submitted, practitioner sees in chart
- [ ] Session timeout after 30 min inactive ‚Üí Auto-logged out
- [ ] Duplicate account detection ‚Üí Warning shown when creating similar account
- [ ] Hide sensitive photo ‚Üí No longer visible in portal, staff can still see
- [ ] Mobile phone view ‚Üí Responsive, all features work
- [ ] Keyboard navigation (no mouse) ‚Üí Can navigate entire portal
- [ ] Screen reader (VoiceOver) ‚Üí All content accessible
- [ ] Sign in with Google ‚Üí OAuth works, logged in
- [ ] View loyalty points ‚Üí Balance accurate, can redeem
- [ ] Generate referral link ‚Üí Link works, referrer earns points when friend books
- [ ] Add appointment to Apple Wallet ‚Üí Pass created, reminder triggers
- [ ] Live chat ‚Üí Can message front desk, response received
- [ ] Treatment recommendations ‚Üí Relevant suggestions based on history
- [ ] Membership view ‚Üí Benefits displayed, usage tracked

<b>SUCCESS METRICS:</b>
- Patient portal adoption: 70%+ of patients have portal account and use it
- Self-service rate: 50%+ of appointments booked online (not phone)
- After-hours bookings: 30% of bookings happen outside business hours (6pm-9am)
- Call reduction: 40-60% fewer calls to front desk (patients self-serve)
- Payment collection: Online payments increase by 25% (easier to pay from home)
- Engagement: Patients who use portal have 2-3√ó higher lifetime value
- Referrals: 15%+ of new patients come from referral program
- Mobile usage: 70%+ of portal access from mobile devices
- Session duration: Average 5-8 min per session (patients find what they need quickly)
- Password reset success: 90%+ of reset attempts successful (good UX)

<b>HOW TO APPROACH:</b>
1. Test full patient journey: Sign up ‚Üí Login ‚Üí Book appointment ‚Üí View history ‚Üí View photos ‚Üí Pay invoice ‚Üí Update profile ‚Üí Logout
2. Test all 12 edge cases systematically (password reset, account lockout, mobile responsiveness, etc.)
3. Implement security measures (session timeout, account lockout, HTTPS, encryption)
4. Optimize mobile UX (responsive design, touch-friendly, fast loading)
5. Add engagement features (loyalty display, referral program, Apple Wallet, chat)
6. Ensure accessibility (screen reader compatible, keyboard navigation, color contrast)
7. Provide detailed report: "Tested all features. Found 4 bugs (listed below). Implemented Apple Wallet integration (12 test users added passes successfully), referral program (3 test referrals completed), live chat (average response time 3 min). Mobile usage: 68%. Self-service booking rate: 54%. Ready for production."

This is the digital front door of the practice - make it beautiful, fast, and delightful!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Homepage marketing content reviewed</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>All services listed and accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Account registration flow tested</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Social login (Google/Facebook) works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Online booking end-to-end tested</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Real-time availability accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Confirmation SMS + Email verified</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Calendar sync (.ics) works in all calendars</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Medical forms HIPAA-compliant</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>View appointments accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Photo gallery privacy verified</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Invoice payment processing tested</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>‚ö†Ô∏è Edge Cases to Handle</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Forgot password ‚Üí Reset flow works</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Email already registered ‚Üí Clear error message</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Payment fails ‚Üí Hold slot, send payment link</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Minor booking ‚Üí Block with "Call us" message</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Wrong medical history ‚Üí Allow edit/resubmit</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Cancel <24hrs ‚Üí Policy enforcement</span></label>
                                    </div>
                                </div>
                            </div>
                            <div class="detail-card" style="margin-top: 15px;">
                                <h4>üöÄ Enhancements to Add</h4>
                                <div class="requirements-checklist">
                                    <label class="checkbox-item"><input type="checkbox"><span>Live chat support (chatbot or staff)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Patient testimonials section</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Loyalty program display</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Refer-a-friend tracking</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Mobile app (iOS/Android)</span></label>
                                    <label class="checkbox-item"><input type="checkbox"><span>Push notifications</span></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Management -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('inventory-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">13</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üì¶ Inventory Management - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ AI forecasting ‚Ä¢ Auto-ordering ‚Ä¢ Expiration tracking ‚Ä¢ üéØ BUILD ORDER: #14</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="inventory-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Inventory Management system (product tracking, stock levels, auto-deduction, expiration tracking). This is about verifying core inventory features work flawlessly (real-time stock tracking, auto-deduction from treatment charts, low stock alerts), implementing critical safety and compliance measures (lot number tracking for injectables, expiration date monitoring, FDA recall workflows), handling edge cases (theft prevention, stockouts during treatment, expired product usage prevention), and adding intelligent automation (AI forecasting, auto-ordering, seasonal trend analysis, barcode scanning).

<b>WHAT THIS IS:</b>
The Inventory Management system tracks every product used in the practice - from high-value injectables (Botox $500/vial, fillers $600/syringe) to consumables (gauze, gloves, numbing cream). This is MISSION-CRITICAL because:
- Cost control: Injectables and skincare products represent 30-40% of COGS (Cost of Goods Sold)
- Compliance: FDA requires lot number tracking for all injectables (for recalls, adverse event reporting)
- Revenue protection: Can't perform treatments if products out of stock ($450 Botox appointment = $0 revenue if no Botox)
- Theft prevention: High-value items (Botox, fillers, luxury skincare) are targets for employee theft
- Patient safety: Expired products can cause infections, reduced efficacy, adverse reactions
- Tax/accounting: Inventory value affects financial statements, taxes

<b>WHY WE NEED THIS REVIEW:</b>
Practices lose 5-15% of inventory to waste (expiration), theft, or untracked usage. Poor inventory management causes stockouts (lost revenue), overstocking (cash tied up, expiration waste), and compliance violations (FDA penalties). We need to test existing features, implement safety measures (expiration tracking, lot numbers), fix common pain points (manual counts, stockouts), and add automation (AI forecasting predicts "we'll run out of Botox on Friday" based on appointments scheduled).

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Running Out of Botox Mid-Day</b>
   - Tuesday morning: 200 units Botox in stock
   - Schedule shows: 5 Botox appointments today (typical usage: 20-30 units each = 100-150 units total)
   - By 2pm: 4 appointments done, used 110 units, 90 units remaining
   - 3pm appointment: Patient arrives for Botox, needs 30 units
   - Check stock: Only 90 units left, but last appointment at 5pm also needs 25 units (total 55 units needed, only 90 available) ‚úì OK
   - BUT: Didn't account for "hidden" usage (practitioner logged 24 units but actually used 30, wasted 6 units)
   - By 5pm: Only 60 units left, need 25 ‚Üí Just barely enough, but no buffer for tomorrow
   - <b>Problem:</b> No forecasting, no alerts, reactive instead of proactive
   - <b>Needed:</b> AI forecasting: "Based on this week's schedule (12 Botox appointments), you'll run out Thursday afternoon. Order now for Friday delivery."

2. <b>Scenario: Expired Filler Used on Patient</b>
   - Filler syringe purchased: 06/01/2024, expiration: 06/01/2025 (12 months shelf life)
   - Stored in refrigerator, forgot about it
   - 07/15/2025: Practitioner grabs filler for lip injection (45 days past expiration)
   - Patient gets injected with expired product
   - Potential consequences:
     * Reduced efficacy (filler breaks down, doesn't last as long)
     * Increased infection risk (sterility compromised)
     * Adverse reaction (chemical degradation)
     * Liability: Patient sues ("You used expired product on me!")
   - <b>Current state:</b> Unknown if system tracks expiration dates, sends alerts, prevents usage
   - <b>Needed:</b> Expiration tracking with escalating alerts:
     * 90 days before: "3 filler syringes expire in 90 days. Use soon or offer discount to move inventory."
     * 30 days before: "‚ö†Ô∏è 3 syringes expire in 30 days. Last chance to use."
     * 7 days before: "üö® URGENT: 3 syringes expire in 7 days. Cannot use after expiration!"
     * On expiration day: Auto-mark as "EXPIRED - DO NOT USE", prevent from being logged in treatments

3. <b>Scenario: FDA Recall - Need to Find All Patients Who Received Specific Lot</b>
   - FDA issues recall: "Botox lot #ABC123 may be contaminated. Identify all patients who received this lot."
   - Practice has used Botox from 5 different lots over past 6 months
   - Need to quickly identify:
     * Which patients received lot #ABC123?
     * What dates?
     * How many units?
     * Were there any adverse reactions reported?
   - <b>Current state:</b> Unknown if lot numbers tracked per treatment
   - <b>Needed:</b> Lot number tracking:
     * When receiving inventory: Scan barcode or manually enter lot #ABC123, expiration 12/15/2025
     * When logging product in treatment chart: System asks "Which vial? [Lot #ABC123 - 150 units remaining] [Lot #DEF456 - 80 units remaining]"
     * Database: treatment_products table includes lot_number field
     * Recall workflow: Manager searches "Find all treatments using Lot #ABC123" ‚Üí Instant list of 23 patients, dates, units used
     * Send SMS to all 23 patients: "Important safety notice regarding your recent Botox treatment. Please call us: (555) 123-4567"

4. <b>Scenario: Suspected Theft of High-Value Products</b>
   - Inventory audit (monthly count): Expected 6 Botox vials (600 units), actual count 4 vials (400 units)
   - Missing: 200 units ($200 wholesale cost, $900 retail value)
   - Possible explanations:
     * Theft (employee took 2 vials)
     * Untracked usage (practitioner used but didn't log in charts)
     * Waste (vial dropped and broken, not reported)
     * Data entry error (vials actually used but system not updated)
   - <b>Investigation needed:</b>
     * Review all treatments past month: Total logged usage = 380 units
     * Expected remaining: 600 - 380 = 220 units
     * Actual remaining: 200 units
     * Discrepancy: 20 units (acceptable ~3% variance)
     * But actual count shows 200 units short ‚Üí Likely theft
   - <b>Needed:</b> Variance tracking and investigation workflow:
     * Monthly audit: Enter expected vs actual counts
     * System calculates variance: "Expected 600 units, found 400 units, -200 units (-33%)"
     * Flag large variances: ">10% variance = investigate"
     * Audit log: Who had access to inventory? (fridge logs, treatment room access)
     * Corrective action: Lock high-value items, require manager approval for access, install camera

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE FUNCTIONALITY (Test Everything Works)</b>

1. <b>Product Catalog & Pricing:</b>
   - Verify: All products in system with accurate info
     * Product name: "Botox (100 unit vial)"
     * SKU/product code: "BOT-100"
     * Category: "Injectable", "Skincare", "Consumable", "Equipment"
     * Cost (wholesale): $400
     * Retail price: $18/unit ($1,800 for 100-unit vial if sold per-unit)
     * Unit of measure: "units", "syringes", "mL", "bottles", "boxes"
     * Supplier: "Allergan", "Galderma", etc.
     * Reorder point: 300 units (alert when stock falls below this)
     * Par level (ideal stock): 800 units (2-week supply based on historical usage)
   - Test: View product catalog ‚Üí All products listed with complete info
   - Test: Edit product ‚Üí Pricing/info updates correctly
   - <b>If incomplete:</b> Audit catalog, add missing products, verify pricing

2. <b>Real-Time Stock Tracking:</b>
   - Test: View current stock levels
     * Botox: 450 units (3 vials at 150 units each, 2 opened)
     * Juvederm Ultra: 8 syringes
     * Numbing cream: 12 tubes
     * Gauze: 200 packs
   - Verify: Stock levels accurate (matches physical count)
   - Test: Add stock (receiving new order) ‚Üí Stock increases
   - Test: Deduct stock (manual adjustment) ‚Üí Stock decreases
   - <b>Performance:</b> Stock levels update in real-time (no 5-minute lag)
   - <b>If inaccurate:</b> Perform physical count, adjust discrepancies, identify root cause (auto-deduction not working? theft? data entry errors?)

3. <b>Auto-Deduction from Treatment Charts:</b>
   - This is CRITICAL - ensures inventory accuracy without manual tracking
   - Test flow:
     * Practitioner completes Botox treatment, logs in chart: "Botox - 24 units"
     * Practitioner marks chart complete ‚Üí Chart locked
     * System immediately deducts 24 units from inventory
     * Inventory before: 450 units ‚Üí After: 426 units
   - Verify: Deduction happens automatically (not manual)
   - Verify: Deduction only happens once (chart locked = deducted, don't double-deduct if chart reopened)
   - Test edge case: What if practitioner logs product but chart never marked complete? ‚Üí No deduction until chart locked
   - Test edge case: Chart marked complete, then unlocked by manager and product changed (24 units ‚Üí 30 units) ‚Üí System adjusts: +24 units (reverse original), -30 units (new amount)
   - <b>If not auto-deducting:</b> Implement webhook on chart lock event ‚Üí Trigger inventory deduction

4. <b>Manual Receiving (Adding Stock):</b>
   - Test: Order arrives from supplier (200 units Botox in 2 vials)
   - Staff clicks "Receive Inventory" ‚Üí Form opens:
     * Product: [Select: Botox 100-unit vial]
     * Quantity received: 2 vials (200 units)
     * Lot number: ABC123 (REQUIRED for injectables)
     * Expiration date: 12/15/2025 (REQUIRED)
     * Supplier: Allergan
     * Invoice #: INV-2025-10-18
     * Cost: $400 per vial ($800 total)
   - Click "Receive" ‚Üí Stock increases from 450 ‚Üí 650 units
   - Verify: Lot number and expiration saved (for tracking/recalls)
   - <b>If receiving doesn't work:</b> Fix receiving form, ensure lot # and expiration required

5. <b>Low Stock Alerts:</b>
   - Test: Set Botox reorder point to 300 units
   - Current stock: 450 units ‚Üí No alert
   - Use 200 units (treatments throughout day) ‚Üí Stock drops to 250 units
   - Expected: Alert triggered
     * Dashboard notification: "‚ö†Ô∏è Low stock: Botox (250 units remaining, reorder point 300)"
     * Email to manager: "Botox stock low. Reorder soon to avoid stockout."
     * SMS (optional): "ALERT: Botox low stock (250 units). Order more."
   - Verify: Alert triggers exactly when crossing reorder point (not too early, not too late)
   - <b>Test multiple products:</b> Set alerts for top 10 products, verify all trigger correctly
   - <b>If alerts not triggering:</b> Check background job (runs every hour?), verify alert logic, test email/SMS delivery

6. <b>Stock Adjustment (Manual Corrections):</b>
   - Use case: Monthly physical count reveals discrepancy (system says 450 units, physical count shows 430 units)
   - Test: Click "Adjust Stock" ‚Üí Form:
     * Product: Botox
     * Current system stock: 450 units
     * Actual physical count: 430 units
     * Adjustment: -20 units
     * Reason: [Dropdown: Physical count correction, Waste, Damaged, Theft, Other]
     * Notes: "Monthly audit - 20 units unaccounted for"
   - Click "Adjust" ‚Üí Stock corrected to 430 units
   - Audit log: "Stock adjusted by Manager Jane on 10/18/2025: -20 units Botox (reason: Physical count correction)"
   - <b>Why audit log critical:</b> Prevents staff from hiding theft ("Oh I just adjusted it down")
   - <b>Test:</b> Make adjustment ‚Üí Stock updated, audit log entry created

7. <b>Inventory Valuation (Financial Reporting):</b>
   - Manager needs to know: "What's my total inventory worth?"
   - Test: View "Inventory Valuation Report"
     * Botox: 430 units @ $4/unit (wholesale) = $1,720
     * Juvederm: 8 syringes @ $500/syringe = $4,000
     * Numbing cream: 12 tubes @ $8/tube = $96
     * Gauze: 200 packs @ $0.50/pack = $100
     * <b>Total inventory value: $5,916</b>
   - Use case: Needed for balance sheet, tax reporting, insurance claims
   - Verify: Valuation uses wholesale cost (not retail price)
   - <b>Test:</b> Add/remove stock, valuation recalculates correctly

8. <b>Usage Reports (What's Being Used Most):</b>
   - Manager wants to know: "What products are we using most?"
   - Test: View "Usage Report - Past 30 Days"
     * Botox: 1,200 units used (40 treatments avg 30 units each)
     * Juvederm: 15 syringes used
     * Numbing cream: 45 tubes used
     * Gauze: 120 packs used
   - Insights:
     * Botox usage consistent (40 treatments/month = typical)
     * Gauze usage high ‚Üí Maybe using too much per treatment? (waste reduction opportunity)
   - <b>Test:</b> Generate usage report, verify counts accurate

9. <b>Vendor Management:</b>
   - Track: Who do we buy from? What prices? How long for delivery?
   - Test: View "Vendors" list:
     * Allergan (Botox supplier): Orders typically $5K, 3-day delivery, last order 10/01/2025
     * Galderma (filler supplier): Orders typically $3K, 5-day delivery, last order 09/15/2025
   - Vendor record includes:
     * Contact info: sales rep name, phone, email
     * Pricing history: "Botox was $380/vial in January, now $400/vial (5% increase)"
     * Order history: Past 12 months of orders
     * Payment terms: "Net 30 days"
   - <b>Use case:</b> Compare pricing across vendors, track price increases, evaluate supplier performance
   - <b>Test:</b> Add vendor, create purchase order, track pricing history

10. <b>Purchase Orders (Ordering Workflow):</b>
    - Test: Manager decides to order more Botox
    - Click "Create Purchase Order" ‚Üí Form:
      * Vendor: Allergan
      * Products:
        - Botox 100-unit vial: Qty 5, Cost $400 each, Total $2,000
        - Dysport 300-unit vial: Qty 2, Cost $350 each, Total $700
      * Subtotal: $2,700
      * Tax: $216 (8%)
      * Total: $2,916
      * Expected delivery: 10/22/2025 (3 business days)
      * Notes: "Rush order - low stock"
    - Click "Submit PO" ‚Üí Sent to vendor (email or fax)
    - Track PO status: "Submitted" ‚Üí "Confirmed" ‚Üí "Shipped" ‚Üí "Delivered" ‚Üí "Received"
    - When order arrives: "Receive PO" ‚Üí Check off items received, add to inventory
    - <b>Test:</b> Create PO, submit, receive inventory, verify stock updated

<b>PART 2: IMPLEMENT EDGE CASES (15 Critical Scenarios)</b>

1. <b>Lot Number & Expiration Tracking (FDA Compliance):</b>
   - <b>Problem:</b> FDA requires lot # tracking for all injectables (Botox, fillers) for recall purposes
   - <b>Solution to implement:</b>
     * When receiving injectables: REQUIRE lot # and expiration date (can't skip)
     * Database: Add lot_number, expiration_date fields to inventory_items table
     * When practitioner logs product in treatment: Dropdown shows available vials/syringes with lot #:
       "Which Botox vial?
       - Lot #ABC123 (150 units remaining, expires 12/15/2025) [SELECT]
       - Lot #DEF456 (80 units remaining, expires 01/30/2026) [SELECT]"
     * System tracks: "Treatment #12345 used 24 units from Lot #ABC123"
     * Recall workflow: "Find all patients who received Lot #ABC123" ‚Üí Instant list
   - <b>Test:</b> Receive product with lot #, use in treatment, search by lot #, find all related treatments

2. <b>Expiration Date Alerts (Prevent Expired Product Usage):</b>
   - <b>Problem:</b> Products expire, if used can harm patients and create liability
   - <b>Solution to implement:</b>
     * Escalating alerts:
       - <b>90 days before expiration:</b> "3 Juvederm syringes expire in 90 days. Plan to use or discount."
       - <b>30 days before:</b> "‚ö†Ô∏è 3 syringes expire in 30 days. Last chance."
       - <b>7 days before:</b> "üö® URGENT: 3 syringes expire in 7 days!"
       - <b>On expiration day:</b> Auto-mark as "EXPIRED - DO NOT USE"
     * Prevention: When practitioner tries to log expired product in treatment ‚Üí Error: "This product expired on 10/15/2025. Cannot use. Please use fresh product."
     * Manager override: If product still good (some products usable past expiration), manager can extend with reason: "Vendor confirmed product still effective 30 days past expiration"
   - <b>Test:</b> Set product to expire tomorrow, check if alert sent, try to use expired product, verify blocked

3. <b>Stockout Prevention (Can't Perform Treatment):</b>
   - <b>Problem:</b> Patient arrives for Botox, system shows 30 units in stock, but practitioner can't find it (already used earlier but chart not locked yet)
   - <b>Solution to implement:</b>
     * Real-time "reserved" stock:
       - Chart opened for Botox treatment ‚Üí System reserves 25 units (typical amount)
       - Available stock for other appointments: Total stock - reserved = actual available
       - If chart completed with 24 units ‚Üí Deduct 24, release 1 unit reservation
       - If chart cancelled ‚Üí Release all 25 units
     * Pre-appointment stock check:
       - Day before appointment: "Tomorrow's Botox appointments need 120 units total. Current stock: 150 units ‚úì OK"
       - If insufficient: Alert manager "üö® Tomorrow's appointments need 120 units Botox, only 80 available. Order urgent!"
   - <b>Test:</b> Open treatment chart, verify stock reserved, complete chart, verify correct deduction

4. <b>Multi-Location Inventory (Transfer Between Locations):</b>
   - <b>Problem:</b> Practice has 2 locations, Location A has excess Botox, Location B running low
   - <b>Solution to implement:</b>
     * Track inventory per location:
       - Location A: 600 units Botox
       - Location B: 150 units Botox
     * Transfer workflow:
       - Manager at Location B: "Request Transfer from Location A"
       - Transfer form: Product: Botox, Quantity: 200 units, From: Location A, To: Location B
       - Location A manager approves transfer
       - Staff physically transports product
       - Location A: "Transfer Out" ‚Üí Stock -200 (now 400 units)
       - Location B: "Transfer In" ‚Üí Stock +200 (now 350 units)
       - Audit trail: "200 units Botox transferred from Location A to Location B on 10/18/2025"
   - <b>Test:</b> Create transfer request, approve, record transfer in/out, verify stock adjusted both locations

5. <b>Variance Tracking (Theft/Waste Detection):</b>
   - <b>Problem:</b> Monthly audit shows missing inventory (theft, waste, untracked usage)
   - <b>Solution to implement:</b>
     * Monthly audit workflow:
       - System expected stock: 450 units Botox (based on starting inventory + purchases - logged usage)
       - Physical count: 430 units
       - Variance: -20 units (-4.4%)
     * Acceptable variance: <5% (minor waste, measurement error)
     * Flag for investigation: >10% variance
     * If flagged: Manager investigates:
       - Review all treatments past month: Were all products logged correctly?
       - Check waste log: Were any vials dropped/broken?
       - Review staff access: Who had access to inventory storage?
       - Security footage: Any suspicious activity?
     * Corrective actions:
       - Retrain staff on accurate logging
       - Install security cameras in storage area
       - Require manager approval to access high-value items
       - Implement spot checks (random audits)
   - <b>Test:</b> Enter physical count lower than expected, variance calculated, flagged if >10%

6. <b>FIFO/LIFO (First-In-First-Out for Expiration Management):</b>
   - <b>Problem:</b> New Botox vials received, staff uses new vials first, old vials sit and expire
   - <b>Solution to implement:</b>
     * FIFO system: Use oldest products first (based on expiration date)
     * When practitioner logs product in treatment, system suggests:
       "Which Botox vial to use?
       ‚≠ê RECOMMENDED: Lot #ABC123 (expires 12/15/2025 - oldest, use first)
       - Lot #DEF456 (expires 03/30/2026)
       - Lot #GHI789 (expires 06/15/2026)"
     * Visual indicator: Oldest products highlighted/recommended
   - <b>Test:</b> Receive products with different expiration dates, verify system recommends oldest first

7. <b>Controlled Substances (DEA Tracking for Schedule IV):</b>
   - <b>Note:</b> Some practices use prescription medications (e.g., compounded topical anesthetics containing controlled substances)
   - <b>If applicable:</b>
     * DEA requires detailed tracking: perpetual inventory log
     * Every transaction logged: Date, product, quantity, patient name, practitioner DEA #
     * Monthly reconciliation: Balance on hand = Starting balance + Purchases - Usage
     * Discrepancies must be reported to DEA
   - <b>Implementation:</b>
     * Mark products as "Controlled Substance: Yes"
     * Extra logging: "Used 5mL compounded lidocaine on Patient Sarah Johnson by Dr. Smith (DEA #AS1234567)"
     * Monthly DEA report: "Controlled Substance Inventory Report - October 2025"
   - <b>Test:</b> Mark product as controlled, use in treatment, generate DEA report, verify all transactions logged

8. <b>Compounded Products (Custom Mixtures):</b>
   - <b>Problem:</b> Practice compounds custom skincare (mixing ingredients), need to track component ingredients
   - <b>Solution:</b>
     * Recipe system:
       - Custom Vitamin C Serum (30mL bottle):
         * Ingredient 1: L-Ascorbic Acid powder - 3g
         * Ingredient 2: Hyaluronic Acid solution - 10mL
         * Ingredient 3: Distilled water - 17mL
       - Makes: 1 bottle (30mL)
     * When compounding: Deduct ingredients from inventory
     * Track batch number, date compounded, expiration (typically 30-90 days for compounded products)
   - <b>Test:</b> Create recipe, compound product, verify ingredients deducted, track compounded product separately

9. <b>Consignment Inventory (Products Owned by Vendor, Pay When Used):</b>
   - <b>Problem:</b> Some vendors offer consignment: "We'll stock your fridge, you pay only for what you use"
   - <b>Solution:</b>
     * Mark products as "Consignment: Yes"
     * Track usage separately: "Used 3 consignment Juvederm syringes this month"
     * Invoice from vendor: "You used 3 syringes @ $500 each = $1,500 due"
     * Payment: Mark consignment products as "Paid" after vendor invoice settled
   - <b>Test:</b> Mark product as consignment, use in treatments, generate consignment usage report, reconcile with vendor invoice

10. <b>Sample Products (Free from Vendor, Not for Sale):</b>
    - <b>Problem:</b> Vendors give free samples, need to track separately (not for sale to patients)
    - <b>Solution:</b>
      * Mark products as "Sample: Yes" when receiving
      * Use: Can be used in treatments but don't charge patient (or discount)
      * Reporting: Track sample usage separately from paid inventory
      * Prevent: Can't accidentally sell sample products at full price
    - <b>Test:</b> Receive sample product, use in treatment, verify not charged to patient, track sample usage

11. <b>Kit/Bundle Management (Pre-Packaged Treatment Kits):</b>
    - <b>Problem:</b> Some treatments use standard kits (e.g., "Botox Treatment Kit" = Botox + numbing cream + gauze + alcohol swabs)
    - <b>Solution:</b>
      * Create kits: "Botox Treatment Kit" contains:
        - Botox: 25 units
        - Numbing cream: 1 tube
        - Gauze: 3 packs
        - Alcohol swabs: 5 swabs
      * When logging kit in treatment: Automatically deducts all components
      * Benefit: Faster charting (one click instead of logging 4 items)
    - <b>Test:</b> Create kit, use in treatment, verify all components deducted correctly

12. <b>Backorder Tracking (Products Ordered but Not Delivered):</b>
    - <b>Problem:</b> Ordered Botox 2 weeks ago, still hasn't arrived, need to track
    - <b>Solution:</b>
      * Purchase orders track status: "Submitted" ‚Üí "Confirmed" ‚Üí "Shipped" ‚Üí "Delivered"
      * If stuck in "Confirmed" for >7 days ‚Üí Flag as "Delayed"
      * Alert manager: "Botox order placed 10/01 still not received. Follow up with vendor."
      * Show "On Order" quantity in inventory view:
        - Current stock: 150 units
        - On order: 500 units (expected delivery 10/22)
        - Available after delivery: 650 units
    - <b>Test:</b> Create PO, mark as delayed, verify alert sent, show on-order quantity in inventory view

13. <b>Damaged/Waste Logging (Track Losses):</b>
    - <b>Problem:</b> Vial dropped and broken, syringe contaminated, product wasted
    - <b>Solution:</b>
      * "Log Waste" function:
        - Product: Botox 100-unit vial
        - Quantity wasted: 100 units
        - Reason: [Dropdown: Dropped/broken, Contaminated, Patient reaction (partial use), Expired, Other]
        - Notes: "Vial dropped on floor by staff member"
        - Cost: $400 (for financial tracking)
      * Deduct from inventory
      * Waste report: "Total waste this month: $1,200 (3% of inventory value)"
      * Goal: Reduce waste to <2%
    - <b>Test:</b> Log waste, verify deducted from inventory, appears in waste report

14. <b>Barcode/QR Code Scanning (Faster Receiving):</b>
    - <b>Problem:</b> Manually entering product info slow and error-prone
    - <b>Solution:</b>
      * When receiving products: Scan barcode on packaging
      * Barcode contains: Product code, lot number, expiration date
      * System auto-fills receiving form
      * Staff confirms quantity, clicks "Receive" ‚Üí Much faster
      * Benefit: Reduces data entry errors, speeds up receiving from 5 min to 30 seconds per order
    - <b>Implementation:</b> Support barcode scanner hardware or use phone camera
    - <b>Test:</b> Scan product barcode, verify auto-fill, receive inventory

15. <b>Emergency Access (After-Hours Access to Inventory):</b>
    - <b>Problem:</b> After-hours emergency (patient severe reaction, needs product), inventory storage locked
    - <b>Solution:</b>
      * Emergency access code/key: Manager can grant temporary access
      * When emergency access used: Audit log entry "Emergency access by Dr. Smith at 11:30pm on 10/18/2025 - Reason: Patient allergic reaction, needed epinephrine"
      * Follow-up: Next business day, manager reviews emergency access log
    - <b>Test:</b> Grant emergency access, use after hours, verify audit logged

<b>PART 3: ADD ENHANCEMENTS (8 Automation & Intelligence Features)</b>

1. <b>AI Usage Forecasting (Predict When You'll Run Out):</b>
   - <b>Problem:</b> Reactive ordering (wait until low stock, scramble to order) vs proactive (predict needs 2 weeks ahead)
   - <b>Solution:</b>
     * Machine learning model analyzes:
       - Historical usage: "Botox usage: 1,000 units/month (avg over past 6 months)"
       - Upcoming schedule: "Next 2 weeks: 15 Botox appointments scheduled"
       - Seasonal trends: "Botox usage increases 30% in November-December (holidays)"
     * Prediction: "Based on upcoming appointments and historical usage, you'll run out of Botox on Friday 10/25. Order by Monday 10/21 for Thursday delivery."
     * Confidence: "95% confidence (high confidence because data is consistent)"
   - <b>Display:</b> "Inventory Forecast - Next 30 Days" dashboard
     * Botox: Current 450 units, will run out 10/25 (6 days) üö® ORDER NOW
     * Juvederm: Current 8 syringes, will run out 11/15 (28 days) ‚úì OK
   - <b>Test:</b> Train model on historical data, generate forecast, verify accuracy

2. <b>Auto-Ordering (AI Generates Purchase Orders):</b>
   - <b>Problem:</b> Manager busy, forgets to order, stockouts happen
   - <b>Solution:</b>
     * AI detects: "Botox will run out in 6 days, order lead time is 3 days, need to order TODAY"
     * System auto-generates draft PO:
       "Draft Purchase Order - BOTOX URGENT
       Vendor: Allergan
       Product: Botox 100-unit vial, Qty: 5 vials (500 units)
       Total: $2,000
       Recommended order quantity based on 2-week supply + 20% buffer"
     * Manager reviews draft PO, clicks "Approve & Submit" ‚Üí Sent to vendor
     * OR: Fully automated (if manager enables): System automatically sends PO without approval
   - <b>Test:</b> Stock drops below reorder point, AI generates draft PO, manager approves, PO submitted

3. <b>Seasonal Trend Analysis (Plan for Busy Seasons):</b>
   - <b>Problem:</b> Holidays = busy, need more inventory, but how much?
   - <b>Solution:</b>
     * Analyze historical data:
       - October 2024: 1,000 units Botox used
       - November 2024: 1,300 units Botox used (+30%)
       - December 2024: 1,400 units used (+40%)
     * Insight: "Botox usage increases 30-40% in Nov-Dec (holiday parties)"
     * Recommendation: "It's now October 2025. Based on seasonal trends, order 30% more Botox for November to avoid stockouts."
   - <b>Display:</b> "Seasonal Trends" chart showing usage by month for past 2 years
   - <b>Test:</b> Generate seasonal report, identify high/low seasons, plan inventory accordingly

4. <b>Vendor Price Comparison (Find Best Prices):</b>
   - <b>Problem:</b> Multiple vendors sell same products, which has best price?
   - <b>Solution:</b>
     * Track pricing from multiple vendors:
       - Allergan (direct): Botox $400/vial, 3-day delivery
       - Medical supply distributor: Botox $420/vial, next-day delivery
       - Wholesale club: Botox $380/vial, 7-day delivery
     * Price comparison tool: "Botox 100-unit vial - Best Price Finder"
       - Lowest price: Wholesale club $380 (but 7-day wait)
       - Fastest delivery: Distributor $420 (next-day)
       - Best value: Allergan $400 (3-day, good balance)
     * Recommendation: "Save $100 by ordering from Wholesale club (7-day delivery OK since not urgent)"
   - <b>Test:</b> Enter product, compare prices across vendors, select best option

5. <b>Waste Reduction Analytics (Identify Waste Patterns):</b>
   - <b>Problem:</b> Wasting 5-10% of inventory, don't know why
   - <b>Solution:</b>
     * Waste analysis:
       - Total waste this month: $1,200
       - Breakdown:
         * Expired products: $600 (50% of waste) ‚Üê PRIMARY ISSUE
         * Dropped/broken: $300 (25%)
         * Patient reactions (partial use): $200 (17%)
         * Contamination: $100 (8%)
     * Insight: "50% of waste is expired products. Problem: Over-ordering. Solution: Order smaller quantities more frequently."
     * Actionable: "Reduce Botox order from 10 vials to 5 vials, order every 2 weeks instead of monthly ‚Üí Reduce expiration waste by 80%"
   - <b>Display:</b> "Waste Analytics Dashboard" with breakdown by reason, product, cost
   - <b>Test:</b> Log waste over time, generate analytics, identify patterns, implement improvements

6. <b>Expiration Management (Move Aging Inventory):</b>
   - <b>Problem:</b> Products approaching expiration, need to use before they expire
   - <b>Solution:</b>
     * "Aging Inventory Report" shows products by expiration date:
       - 3 Juvederm syringes expire in 45 days
       - 2 Botox vials expire in 60 days
       - 10 skincare products expire in 90 days
     * Strategies to move aging inventory:
       - Offer discount: "Juvederm special: 15% off this month (clearing inventory before expiration)"
       - Internal use: Use aging products for staff training
       - Return to vendor: Some vendors accept returns of unexpired products (restocking fee)
     * Marketing campaign: "Flash sale - Book Juvederm this week and save!"
   - <b>Test:</b> Generate aging inventory report, create discount campaign, track if inventory moved before expiration

7. <b>Stock Optimization (Ideal Stock Levels):</b>
   - <b>Problem:</b> How much inventory to keep? Too little = stockouts, too much = cash tied up + expiration risk
   - <b>Solution:</b>
     * AI calculates optimal stock level:
       - Average usage: 1,000 units Botox/month
       - Usage variability: ¬±200 units (some months 800, some months 1,200)
       - Lead time: 3 days (order to delivery)
       - Safety stock: 300 units (buffer for unexpected demand)
       - Optimal stock: 1,500 units (1.5 months supply)
       - Reorder point: 500 units (when stock hits 500, order more)
     * Benefits:
       - Minimizes stockouts (safety stock provides buffer)
       - Minimizes expiration (don't overstock)
       - Optimizes cash flow (don't tie up $10K in inventory sitting on shelf)
   - <b>Display:</b> "Stock Optimization Recommendations" for top 20 products
   - <b>Test:</b> AI recommends optimal stock levels, manager adjusts reorder points accordingly

8. <b>Integration with Supplier E-Commerce (One-Click Ordering):</b>
   - <b>Problem:</b> Ordering requires: Call vendor, get quote, email PO, wait for confirmation (30 min process)
   - <b>Solution:</b>
     * Integrate with vendor e-commerce platforms (Allergan, Galderma online ordering)
     * One-click ordering:
       - System detects low Botox stock
       - Manager clicks "Order Now"
       - System API call to vendor: "Place order for 5 vials Botox, deliver to Location A"
       - Order confirmed instantly
       - Tracking number provided
       - Expected delivery: 3 days
     * Benefit: Reduces ordering from 30 min to 30 seconds
   - <b>Test:</b> Click "Order Now", API call succeeds, order confirmed, tracking number received

<b>DELIVERABLES:</b>
- All 10 core features verified and working (product catalog, stock tracking, auto-deduction, receiving, alerts, adjustments, valuation, usage reports, vendors, purchase orders)
- All 15 edge cases implemented (lot # tracking, expiration alerts, stockout prevention, multi-location, variance tracking, FIFO, controlled substances, compounded products, consignment, samples, kits, backorders, waste logging, barcode scanning, emergency access)
- 8 enhancements added (AI forecasting, auto-ordering, seasonal trends, price comparison, waste analytics, expiration management, stock optimization, supplier integration)
- FDA compliance verified (lot numbers tracked, expiration dates monitored, recall-ready)
- Theft prevention implemented (variance tracking, audit logs, access controls)
- Cost savings: 5-10% reduction in waste, 80% reduction in expiration waste, 50% faster ordering

<b>TESTING CHECKLIST:</b>
- [ ] Product catalog complete with pricing, SKUs, categories
- [ ] Real-time stock levels accurate (match physical count)
- [ ] Auto-deduction from treatment charts works (locked chart ‚Üí inventory deducted)
- [ ] Manual receiving adds stock correctly (with lot # and expiration)
- [ ] Low stock alerts trigger at reorder point
- [ ] Stock adjustments logged with reason and audit trail
- [ ] Inventory valuation calculated correctly (wholesale cost √ó quantity)
- [ ] Usage reports show products used past 30 days
- [ ] Vendor management tracks pricing history, delivery times
- [ ] Purchase orders created, submitted, received, inventory updated
- [ ] Lot number and expiration required for injectables
- [ ] Expiration alerts sent at 90/30/7 days before expiration
- [ ] Expired products blocked from being used in treatments
- [ ] Stockout prevention (reserved stock for open charts)
- [ ] Multi-location inventory transfers tracked
- [ ] Variance tracking flags >10% discrepancies for investigation
- [ ] FIFO system recommends oldest products first
- [ ] Controlled substance tracking (if applicable) logs all transactions
- [ ] Compounded products deduct ingredients correctly
- [ ] Consignment inventory tracked separately, usage reported
- [ ] Sample products marked, not charged to patients
- [ ] Kits deduct all components automatically
- [ ] Backorders tracked, on-order quantity displayed
- [ ] Waste logged with reason, appears in waste report
- [ ] Barcode scanning auto-fills receiving form
- [ ] Emergency access logged in audit trail
- [ ] AI forecasting predicts stockouts accurately
- [ ] Auto-ordering generates draft POs when stock low
- [ ] Seasonal trends identified, recommendations provided
- [ ] Vendor price comparison finds best prices
- [ ] Waste analytics identifies patterns, suggests improvements
- [ ] Aging inventory report shows products approaching expiration
- [ ] Stock optimization recommends ideal stock levels
- [ ] Supplier integration (if available) enables one-click ordering

<b>SUCCESS METRICS:</b>
- Inventory accuracy: >95% (physical count matches system within 5%)
- Stockout rate: <2% (treatments cancelled due to lack of product)
- Expiration waste: <1% of inventory value (reduce from 5-10% to <1%)
- Theft/shrinkage: <2% (reduce from 5-15% to <2%)
- Ordering efficiency: 80% reduction in time spent ordering (30 min ‚Üí 6 min with automation)
- Cost savings: $5K-$15K/year (waste reduction + theft prevention + better pricing)
- Compliance: 100% lot number tracking for injectables (FDA audit-ready)
- Forecast accuracy: >90% (AI predictions within 10% of actual usage)

<b>HOW TO APPROACH:</b>
1. Test core inventory flow: Receive products ‚Üí Use in treatments (auto-deduct) ‚Üí Check stock levels ‚Üí Alerts trigger when low ‚Üí Create PO ‚Üí Receive order
2. Test all 15 edge cases systematically (lot numbers, expiration, stockouts, variance, etc.)
3. Implement safety & compliance features (expiration tracking, lot # tracking, FDA recall workflow)
4. Add automation (AI forecasting, auto-ordering, waste analytics)
5. Performance test: Process 100 treatments with product usage, verify all deductions accurate
6. Conduct physical inventory audit: Count all products, compare to system, adjust discrepancies, analyze variances
7. Provide detailed report: "Tested all features. Found 3 bugs (listed below). Implemented AI forecasting (predicts stockouts 2 weeks ahead with 92% accuracy), expiration alerts (prevented 5 products from expiring this month), waste analytics (identified 60% of waste from over-ordering, recommended smaller more frequent orders). Inventory accuracy: 97%. Ready for production."

This is the financial engine of the practice - control inventory, control costs!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Features to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Product catalog complete with pricing</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Stock tracking real-time accurate</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-deduction triggers on treatment</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Low stock alerts threshold working</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Reorder point management tested</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üöÄ Enhancements to Add</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>AI forecasting (predict weekly usage)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Auto-ordering (draft PO when low)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Seasonal trend analysis</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Vendor management & pricing history</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Barcode scanning for receiving</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Expiration date tracking & alerts</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reports & Analytics -->
                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('reports-review')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">14</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìä Reports & Analytics - Review & Enhance</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ Staff performance ‚Ä¢ Predictive analytics ‚Ä¢ Custom reports ‚Ä¢ üéØ BUILD ORDER: #15</div>
                                </div>
                            </div>
                            <div class="status-badge status-needs-revision">üîµ Needs Review</div>
                        </div>

                        <div id="reports-review" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to review, test, and enhance the Reports & Analytics system (data dashboards, financial reports, performance metrics). This is about verifying core reports work accurately (daily revenue, patient counts, no-show rates, commission calculations), implementing advanced analytics (staff performance insights, predictive no-show risk, patient churn prediction, treatment outcome tracking), handling edge cases (cross-location reporting, date range exports, data accuracy verification), and adding strategic intelligence (patient lifetime value dashboard, marketing ROI tracking, custom report builder, automated email reports).

<b>WHAT THIS IS:</b>
The Reports & Analytics system is the "business intelligence" layer - turning raw data into actionable insights. This is MISSION-CRITICAL because:
- Financial tracking: Know exactly how much revenue generated, where it's coming from, profitability per service
- Staff performance: Track who's top performer (highest revenue, best patient satisfaction, most upsells), calculate accurate commissions
- Patient insights: Who's at risk of churning? Who's a VIP? What treatments work best together?
- Operational efficiency: Which days/times busiest? What's average wait time? No-show patterns?
- Strategic planning: Which services most profitable? What's ROI of marketing campaigns? Should we hire more staff?

<b>WHY WE NEED THIS REVIEW:</b>
Managers make decisions based on data - if data is wrong or incomplete, decisions are wrong. Common problems: Commission calculations off (staff upset), reports show different numbers (can't trust data), can't answer basic questions like "What was revenue last month?" (no centralized reporting). We need to verify existing reports accurate, implement advanced analytics (predictive models), and create custom reports for specific business questions.

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Staff Commission Discrepancy</b>
   - Practitioner Dr. Smith says: "My commission report shows $2,400 this month, but I counted $2,800 in my appointments. Something's wrong."
   - Manager investigates:
     * Pull Dr. Smith's appointments for October: 42 appointments total
     * Calculate manually: 42 appointments √ó avg $450/appointment √ó 15% commission = $2,835
     * System report shows: $2,400 (missing $435!)
   - Root cause investigation:
     * Check database: 3 appointments marked "completed" but not "checked out" ‚Üí No payment recorded, commission not calculated
     * Check another 2 appointments: Patient paid with package credits (no cash transaction) ‚Üí System didn't count toward commission
   - <b>Problem:</b> Commission calculation logic incomplete, doesn't handle edge cases
   - <b>Needed:</b> Fix commission logic: Include package credit redemptions, include completed-but-not-checked-out appointments with invoice

2. <b>Scenario: Manager Can't Answer "What Was Revenue Last Month?"</b>
   - Owner asks: "How much revenue did we make in September?"
   - Manager checks 3 different reports:
     * QuickBooks: $128,540 (includes tax, includes pending invoices not yet paid)
     * EMR system "Revenue Report": $121,300 (excludes tax, only paid invoices)
     * Credit card processing report: $98,200 (doesn't include cash payments)
   - <b>Which number is correct?</b> They're all measuring different things!
   - <b>Problem:</b> No single source of truth, unclear definitions (revenue = gross or net? cash basis or accrual?)
   - <b>Needed:</b> Clear reporting definitions:
     * <b>Gross Revenue:</b> Total invoiced (before refunds, before costs) = $128,540
     * <b>Net Revenue:</b> Gross - refunds = $125,100
     * <b>Cash Collected:</b> Actual money received (cash basis) = $121,300
     * <b>Outstanding AR:</b> Invoiced but not yet paid = $7,240

3. <b>Scenario: Identifying At-Risk Patients (Churn Prediction)</b>
   - Patient Sarah used to come monthly for Botox (regular since 2023)
   - Last visit: June 2025 (4 months ago, typically comes every 3 months)
   - No upcoming appointments scheduled
   - <b>She's about to churn!</b> (switch to competitor or stop treatments)
   - Current system: No alerts, manager doesn't know until she's already gone
   - <b>Needed:</b> Churn prediction model:
     * Analyze patient behavior: Sarah's pattern = monthly visits, now 4 months inactive
     * Risk score: 85% likely to churn (high risk)
     * Auto-generate task: "Win-back: Sarah Johnson hasn't booked in 4 months. Call her this week."
     * Manager calls: "Hi Sarah, we miss you! Want to book your Botox touch-up? We have a special 15% off this month."
     * Result: Patient rebooked, churn prevented, revenue saved ($450 √ó 12 months = $5,400 lifetime value retained)

4. <b>Scenario: Proving Marketing ROI to Owner</b>
   - Practice spent $2,000 on Instagram ads in September
   - Owner asks: "Did we get our money's worth?"
   - Current system: No way to track which patients came from Instagram
   - <b>Needed:</b> Marketing attribution:
     * When booking: "How did you hear about us?" ‚Üí [Instagram] [Google] [Friend referral] [Other]
     * Tag new patients with source
     * Report: "Instagram ads brought 12 new patients in September"
     * Calculate: 12 patients √ó avg $350 first visit = $4,200 revenue
     * ROI: $4,200 revenue / $2,000 ad spend = 2.1√ó return (210% ROI)
     * Plus: Those 12 patients will return ‚Üí Lifetime value $350 √ó 8 visits avg = $33,600 total value from $2,000 investment!
   - <b>Insight:</b> Instagram ads highly profitable, increase budget

<b>YOUR TASKS:</b>

<b>PART 1: VERIFY CORE REPORTS (Test Everything Works & Accurate)</b>

1. <b>Daily Summary Report (End-of-Day Snapshot):</b>
   - Test: View "Daily Summary - October 18, 2025"
   - Report should show:
     * <b>Appointments:</b>
       - Scheduled: 32
       - Completed: 28
       - Cancelled: 2
       - No-shows: 2
       - No-show rate: 6.25% (2/32)
     * <b>Revenue:</b>
       - Gross revenue (invoiced): $12,600
       - Cash collected: $11,800 (some patients on payment plans)
       - Outstanding (not yet paid): $800
     * <b>Top services:</b>
       - Botox: 12 treatments, $5,400 revenue
       - Fillers: 8 treatments, $4,800 revenue
       - Laser: 5 treatments, $1,200 revenue
     * <b>New vs returning patients:</b>
       - New: 5 (15.6%)
       - Returning: 27 (84.4%)
     * <b>Staff performance:</b>
       - Dr. Smith: 14 appointments, $6,300 revenue
       - Dr. Jones: 10 appointments, $4,500 revenue
       - Nurse Sarah: 4 appointments, $1,800 revenue
   - <b>Test accuracy:</b> Manually count appointments for Oct 18, compare to report ‚Üí Should match exactly
   - <b>If discrepancies:</b> Investigate database queries, fix calculation logic

2. <b>Weekly Performance Metrics:</b>
   - Test: View "Weekly Report - Week of Oct 14-20, 2025"
   - Report shows:
     * Total appointments: 156
     * Total revenue: $68,400
     * Average ticket: $438 ($68,400 / 156 appointments)
     * No-show rate: 7.2%
     * New patient acquisition: 18 new patients
     * Busiest day: Friday (42 appointments)
     * Slowest day: Monday (18 appointments)
     * Peak hours: 2-5pm (60% of appointments)
   - Trend analysis: Compare to previous weeks
     * Week of Oct 7-13: $62,100 revenue
     * Week of Oct 14-20: $68,400 revenue (+10.1% week-over-week growth!)
   - <b>Test:</b> Generate weekly report, verify all calculations correct

3. <b>Monthly Financial Report:</b>
   - Test: View "Monthly Financial Report - September 2025"
   - Report shows:
     * <b>Revenue:</b>
       - Gross revenue: $287,600
       - Refunds: ($3,200)
       - Net revenue: $284,400
     * <b>Expenses (if tracked in system):</b>
       - Inventory (COGS): $86,280 (30% of revenue - typical for med spa)
       - Rent: $8,000
       - Payroll: $95,000
       - Marketing: $12,000
       - Utilities: $2,500
       - Other: $8,700
       - Total expenses: $212,480
     * <b>Profit:</b>
       - Net profit: $71,920 (25% profit margin)
     * <b>Breakdown by service category:</b>
       - Injectables (Botox, fillers): $152,000 (53% of revenue)
       - Laser treatments: $68,400 (24%)
       - Facials/skincare: $42,500 (15%)
       - Products sold: $24,700 (9%)
     * <b>Payment methods:</b>
       - Credit card: $201,180 (71%)
       - Package credits: $57,360 (20%)
       - Cash: $25,860 (9%)
   - <b>Compare to previous months:</b> Is revenue trending up or down?
   - <b>Test:</b> Cross-reference with QuickBooks, ensure numbers match

4. <b>Revenue Tracking vs. Actual Cash (Cash Flow):</b>
   - <b>Important distinction:</b>
     * Revenue (accrual basis): Invoiced amount ($287,600)
     * Cash collected (cash basis): Actually received ($268,200)
     * Outstanding AR (Accounts Receivable): Invoiced but not paid ($19,400)
   - Report shows all three numbers clearly
   - Cash collection rate: $268,200 / $287,600 = 93.3% (goal >95%)
   - <b>Test:</b> Compare total invoices to bank deposits, should reconcile

5. <b>Patient Count (New vs Returning):</b>
   - Test: View "Patient Metrics - September 2025"
   - Report shows:
     * Total unique patients seen: 412
     * New patients: 47 (11.4%)
     * Returning patients: 365 (88.6%)
     * Patient retention rate: 88.6% (excellent!)
   - Breakdown by how many visits:
     * First visit (new): 47 patients
     * 2-5 visits (occasional): 128 patients
     * 6-12 visits (regular): 184 patients
     * 13+ visits (VIP): 53 patients
   - <b>Insight:</b> 53 VIP patients (13% of patients) likely generate 40-50% of revenue (focus retention efforts here)
   - <b>Test:</b> Verify patient counts, ensure each patient counted only once even if multiple appointments

6. <b>No-Show Rate Tracking:</b>
   - Test: View "No-Show Report - Past 90 Days"
   - Report shows:
     * Total appointments scheduled: 1,248
     * No-shows: 87
     * No-show rate: 7.0% (industry average 15-20%, so 7% is excellent!)
     * Cost of no-shows: 87 √ó $450 avg = $39,150 lost revenue
   - Breakdown by patient:
     * Sarah Johnson: 0 no-shows (reliable patient)
     * Michael Brown: 3 no-shows in 90 days (flag for prepayment requirement)
   - Breakdown by day of week:
     * Monday: 12% no-show rate (highest)
     * Friday: 4% no-show rate (lowest)
   - Breakdown by time:
     * Morning (8-11am): 9% no-show rate
     * Afternoon (2-5pm): 5% no-show rate
   - <b>Insight:</b> Monday mornings have highest no-show rate ‚Üí Send extra reminder Sunday night
   - <b>Test:</b> Count no-shows manually, verify report accurate

7. <b>Commission Calculations (Staff Payroll):</b>
   - Test: View "Commission Report - Dr. Smith - October 2025"
   - Commission structure: 15% of revenue generated (example)
   - Report shows:
     * Total appointments: 68
     * Total revenue generated: $30,600
     * Commission (15%): $4,590
     * Breakdown by service:
       - Botox: 32 treatments, $14,400 revenue, $2,160 commission
       - Fillers: 20 treatments, $12,000 revenue, $1,800 commission
       - Laser: 16 treatments, $4,200 revenue, $630 commission
     * Tips received: $1,240 (tracked separately, added to paycheck)
     * <b>Total compensation:</b> Base salary + $4,590 commission + $1,240 tips
   - <b>Edge cases to handle:</b>
     * Package credits used: Count toward commission? (Answer: Yes, practitioner still did the work)
     * Refunds: Deduct from commission? (Answer: Yes, only commission on net revenue)
     * Split appointments (2 practitioners): Split commission 50/50
   - <b>Test:</b> Calculate manually, verify report matches
   - <b>If wrong:</b> Huge problem (staff will be upset), fix immediately

<b>PART 2: IMPLEMENT EDGE CASES (10 Critical Scenarios)</b>

1. <b>Cross-Location Reporting (Multi-Location Practice):</b>
   - <b>Problem:</b> Practice has 2 locations, need to see combined and separate reports
   - <b>Solution:</b>
     * Filter by location: [All Locations] [Location A] [Location B]
     * Combined report: Location A $150K + Location B $134K = $284K total
     * Compare locations: Location A has higher revenue but Location B has higher profit margin (lower rent)
   - <b>Test:</b> Generate report for Location A only, Location B only, All Locations ‚Üí Numbers add up correctly

2. <b>Date Range Exports (Custom Reporting Periods):</b>
   - <b>Problem:</b> Manager needs report for "Q3 2025" (Jul-Sep) or "Past 14 days" or "Jan 1 - June 30"
   - <b>Solution:</b>
     * Custom date range selector:
       - Presets: [Today] [Yesterday] [This Week] [Last Week] [This Month] [Last Month] [This Quarter] [This Year]
       - Custom: Start date: 07/01/2025, End date: 09/30/2025
     * Generate report for any date range
     * Export to: [PDF] [Excel] [CSV] [Print]
   - <b>Test:</b> Select custom date range, export to Excel, verify data includes all dates in range

3. <b>Data Accuracy Verification (Reconciliation):</b>
   - <b>Problem:</b> Reports show $121K revenue, but bank deposits only $115K (discrepancy!)
   - <b>Solution:</b>
     * Reconciliation report:
       - Total invoiced (per EMR): $121,000
       - Total deposited (per bank statements): $115,000
       - Difference: $6,000
     * Breakdown of difference:
       - Outstanding invoices not yet paid: $4,200 (patients on payment plans)
       - Cash in drawer (not yet deposited): $1,200
       - Refunds processed: $600
       - Total accounted for: $6,000 ‚úì Reconciled!
     * If doesn't reconcile ‚Üí Investigate (missing payments? theft?)
   - <b>Test:</b> Run reconciliation, compare to bank statements, ensure balances

4. <b>Cancelled vs Rescheduled (Track Separately):</b>
   - <b>Problem:</b> "Cancelled" appointment could mean: Patient cancelled and didn't reschedule (lost revenue) OR Patient rescheduled to different day (revenue delayed, not lost)
   - <b>Solution:</b>
     * Track separately:
       - Cancelled (not rescheduled): 8 appointments (lost $3,600 revenue)
       - Rescheduled: 12 appointments (revenue delayed, not lost)
     * Report shows both numbers clearly
     * Cancellation rate: 8/200 = 4% (goal <5%)
   - <b>Test:</b> Cancel appointment, reschedule appointment, verify report categorizes correctly

5. <b>Refund Tracking (Impact on Net Revenue):</b>
   - <b>Problem:</b> Revenue report shows $121K, but $3K in refunds issued ‚Üí Net revenue actually $118K
   - <b>Solution:</b>
     * Gross revenue: $121,000 (all invoices)
     * Refunds issued: ($3,200)
     * Net revenue: $117,800 (what you actually keep)
     * Refund rate: 2.6% (goal <3%)
   - Refund breakdown by reason:
     * Service unsatisfactory: $1,800 (56%)
     * Duplicate charge: $800 (25%)
     * Package cancellation: $600 (19%)
   - <b>Insight:</b> Most refunds due to "service unsatisfactory" ‚Üí Quality issue? Need retraining?
   - <b>Test:</b> Issue refund, verify appears in refund report, deducted from net revenue

6. <b>Package Credits vs Cash Revenue (Separate Tracking):</b>
   - <b>Problem:</b> Patient uses package credit for treatment ‚Üí Revenue $0 today, but was paid months ago when package purchased
   - <b>Solution:</b>
     * Track separately:
       - Cash revenue today: $10,200
       - Package credits redeemed: $2,400 (services performed but no cash collected today)
       - Total services performed: $12,600
     * <b>For cash flow:</b> Only count cash collected
     * <b>For performance metrics:</b> Count all services performed (staff did the work regardless of payment method)
   - <b>Test:</b> Patient uses package credit, verify counted in "services performed" but not "cash collected"

7. <b>Tips Included vs Excluded (Commission Calculation):</b>
   - <b>Problem:</b> Patient pays $450 service + $90 tip (20%) = $540 total. Is tip included in commission calculation?
   - <b>Solution:</b>
     * No, tips separate (tips go 100% to practitioner, not commissioned)
     * Service revenue: $450 ‚Üí Commission: $450 √ó 15% = $67.50
     * Tip: $90 ‚Üí No commission (added directly to practitioner paycheck)
   - Report shows:
     * Service revenue (commissionable): $30,600
     * Tips (non-commissionable): $1,240
   - <b>Test:</b> Process payment with tip, verify tip excluded from commission calculation

8. <b>Split Appointments (Multiple Practitioners):</b>
   - <b>Problem:</b> Appointment has 2 practitioners (Dr. Smith does Botox, Nurse Sarah does facial), how split revenue/commission?
   - <b>Solution:</b>
     * Track per service:
       - Botox ($450): Dr. Smith 100%
       - Facial ($150): Nurse Sarah 100%
       - Total appointment: $600, split $450/$150
     * Commission:
       - Dr. Smith: $450 √ó 15% = $67.50
       - Nurse Sarah: $150 √ó 10% = $15
   - <b>Test:</b> Create appointment with 2 practitioners, verify commission split correctly

9. <b>Historical Data Comparison (Year-over-Year):</b>
   - <b>Problem:</b> Manager wants to know: "Are we growing compared to last year?"
   - <b>Solution:</b>
     * YoY comparison:
       - September 2024: $243,500 revenue
       - September 2025: $284,400 revenue
       - Growth: +16.8% year-over-year!
     * Month-by-month comparison chart showing 2024 vs 2025
   - <b>Test:</b> Generate YoY report, verify historical data pulled correctly

10. <b>Automated Email Reports (Scheduled Delivery):</b>
    - <b>Problem:</b> Manager manually generates reports daily and emails to owner (tedious)
    - <b>Solution:</b>
      * Schedule reports:
        - Daily Summary: Email to manager@medspa.com every day at 7pm
        - Weekly Performance: Email to owner@medspa.com every Monday at 9am
        - Monthly Financial: Email to accountant@medspa.com on 1st of each month
      * Automated: System generates and emails reports on schedule
    - <b>Test:</b> Set up scheduled report, wait for delivery time, verify email sent with PDF attachment

<b>PART 3: ADD ENHANCEMENTS (10 Advanced Analytics Features)</b>

1. <b>Staff Performance Insights (Beyond Just Revenue):</b>
   - <b>Problem:</b> Dr. Smith has higher revenue but lower patient satisfaction ‚Üí Need holistic view
   - <b>Solution:</b>
     * Staff leaderboard showing:
       - Revenue generated (primary metric)
       - Average ticket (upsell ability): Dr. Smith $458, Dr. Jones $412
       - Patient satisfaction: Dr. Smith 4.2/5 stars, Dr. Jones 4.8/5 stars
       - Rebooking rate: Dr. Smith 72%, Dr. Jones 86% (patients who rebook with same practitioner)
       - No-show rate: Dr. Smith 8%, Dr. Jones 5%
       - On-time rate: Dr. Smith 85% on time, Dr. Jones 95% on time
     * <b>Insight:</b> Dr. Jones has slightly lower revenue but much better patient experience metrics ‚Üí Long-term more valuable
   - <b>Display:</b> "Staff Performance Dashboard" with multiple metrics
   - <b>Test:</b> View dashboard, verify all metrics calculated correctly

2. <b>Predictive No-Show Risk (Machine Learning):</b>
   - <b>Problem:</b> Would be great to know: "This patient 80% likely to no-show, should we call to confirm or require prepayment?"
   - <b>Solution:</b>
     * ML model analyzes patterns:
       - Patient history: Has Sarah no-showed before? (Yes, 2 times ‚Üí High risk)
       - Appointment timing: Monday 8am appointments have 12% no-show rate (higher risk)
       - Booking recency: Booked 5 minutes ago for tomorrow (spontaneous booking ‚Üí Higher risk) vs Booked 3 weeks ago (planned ‚Üí Lower risk)
       - Confirmation status: Patient confirmed via SMS? (Yes ‚Üí Lower risk)
     * Risk score: 0-100% likelihood of no-show
       - Sarah Johnson: 15% risk (low, reliable patient)
       - Michael Brown: 75% risk (high, has no-showed 3 times this year)
     * Actions for high-risk appointments:
       - Send extra confirmation reminder
       - Call patient day before
       - Require prepayment or credit card hold
       - Double-book slot (if patient no-shows, have backup)
   - <b>Display:</b> "High Risk No-Shows - Tomorrow" report
   - <b>Test:</b> Train model on historical data, predict no-shows for tomorrow, measure accuracy

3. <b>Patient Churn Prediction (Retention Alerts):</b>
   - <b>Problem:</b> Patients silently churn (stop coming), no alerts until they're gone
   - <b>Solution:</b>
     * Churn model analyzes:
       - Visit frequency: Sarah came monthly, now hasn't visited in 4 months (abnormal ‚Üí High churn risk)
       - Treatment type: Botox patients typically return every 3-4 months (Sarah overdue)
       - Engagement: Opened last 3 emails? (No ‚Üí Disengaged)
       - Satisfaction: Last satisfaction survey score (3/5 stars ‚Üí Unhappy)
     * Churn risk score:
       - Sarah Johnson: 85% likely to churn (HIGH RISK)
       - Emily Davis: 10% likely to churn (low risk, just came last week)
     * Auto-generate win-back tasks:
       - "Call Sarah Johnson this week - 85% churn risk - Last visit 4 months ago"
       - Offer incentive: "We miss you! Come back this month for 15% off"
   - <b>Display:</b> "At-Risk Patients" dashboard
   - <b>Test:</b> Identify patients who haven't visited in 90+ days, calculate churn risk, verify accuracy

4. <b>Patient Lifetime Value (LTV) Dashboard:</b>
   - <b>Problem:</b> Not all patients equal - Sarah spent $8,400 over 2 years, Michael spent $450 once
   - <b>Solution:</b>
     * Calculate LTV per patient:
       - Sarah Johnson: $8,400 total spent, 24 visits, avg $350/visit, customer since 2023 (2.5 years), projected LTV $12,000
       - Michael Brown: $450 total, 1 visit, customer since 2025 (3 months), projected LTV $800
     * Segment patients:
       - VIP tier (LTV >$5K): 53 patients, representing $420K lifetime value (40% of total value!)
       - Regular tier (LTV $1K-$5K): 184 patients, $550K lifetime value
       - Occasional tier (LTV <$1K): 175 patients, $88K lifetime value
     * <b>Insight:</b> 13% of patients (VIP tier) generate 40% of revenue ‚Üí Focus retention efforts here
     * <b>Strategy:</b> VIP patients get priority scheduling, exclusive offers, birthday gifts
   - <b>Display:</b> "Patient LTV Dashboard" with top 50 highest-value patients
   - <b>Test:</b> Calculate LTV for sample patients, verify projections reasonable

5. <b>Marketing ROI Tracking (Attribution):</b>
   - <b>Problem:</b> Spending $5K/month on marketing, but which channels work?
   - <b>Solution:</b>
     * Track source for every new patient:
       - Google Ads: 18 new patients, $2,000 spend, avg first visit $340 = $6,120 revenue, 3.06√ó ROI
       - Instagram Ads: 12 new patients, $1,500 spend, avg $350 = $4,200 revenue, 2.8√ó ROI
       - Referral program: 8 new patients, $400 cost (referral rewards), avg $365 = $2,920 revenue, 7.3√ó ROI (highest!)
       - Yelp: 3 new patients, $0 spend (free), $1,050 revenue, infinite ROI
       - Walk-in: 4 new patients, $0 spend, $1,400 revenue
     * <b>Plus LTV:</b> Those 45 new patients will return ‚Üí 45 √ó $3,500 avg LTV = $157,500 total value from $3,900 marketing spend!
     * <b>Insight:</b> Referral program has 7.3√ó ROI ‚Üí Increase referral rewards to drive more referrals
     * <b>Strategy:</b> Reduce Yelp investment (low volume), increase referral program budget
   - <b>Display:</b> "Marketing ROI Dashboard" by channel
   - <b>Test:</b> Tag new patients with source, calculate ROI per channel

6. <b>Treatment Outcome Tracking (Results Analytics):</b>
   - <b>Problem:</b> Do our treatments actually work? Can we prove results?
   - <b>Solution:</b>
     * Analyze before/after photos with AI:
       - Botox treatment: "Wrinkle reduction 68% (measured by analyzing before/after photos)"
       - Laser hair removal: "Hair reduction 82% after 6 sessions"
       - Acne treatment: "Acne lesion count reduced 54%"
     * Track patient satisfaction by treatment type:
       - Botox: 4.7/5 stars average satisfaction
       - Fillers: 4.5/5 stars
       - Laser: 4.3/5 stars
     * Correlate results with patient return rate:
       - Patients with >70% improvement: 92% return rate
       - Patients with <50% improvement: 58% return rate (less likely to return)
     * <b>Insight:</b> Better results = better retention (obviously, but now proven with data!)
   - <b>Display:</b> "Treatment Outcomes Dashboard"
   - <b>Test:</b> Analyze sample before/after photos, calculate average improvement

7. <b>Practitioner Efficiency Metrics (Time Management):</b>
   - <b>Problem:</b> Dr. Smith always running 30 min late, Dr. Jones always on time - quantify this
   - <b>Solution:</b>
     * Track appointment duration:
       - Dr. Smith: Avg Botox treatment 38 min (scheduled for 30 min ‚Üí Running late)
       - Dr. Jones: Avg Botox treatment 28 min (scheduled for 30 min ‚Üí On time)
     * On-time performance:
       - Dr. Smith: 85% on time (15% of appointments start late)
       - Dr. Jones: 95% on time
     * Patient wait time:
       - Dr. Smith patients: Avg wait 12 min
       - Dr. Jones patients: Avg wait 3 min
     * <b>Impact:</b> Dr. Smith's tardiness creates patient dissatisfaction (complaint rate 8% vs Dr. Jones 2%)
     * <b>Coaching:</b> "Dr. Smith, you're averaging 38 min per Botox (scheduled 30 min). Either reduce time or increase appointment slots to 40 min."
   - <b>Display:</b> "Practitioner Efficiency Dashboard"
   - <b>Test:</b> Track appointment start/end times, calculate averages

8. <b>Retention Metrics (30/60/90 Day Return Rate):</b>
   - <b>Problem:</b> How many patients return after first visit?
   - <b>Solution:</b>
     * Cohort analysis:
       - New patients in July 2025: 42 patients
       - Returned within 30 days: 18 patients (43%)
       - Returned within 60 days: 28 patients (67%)
       - Returned within 90 days: 32 patients (76%)
     * <b>Industry benchmark:</b> 50-60% return within 90 days (we're at 76% - excellent!)
     * Compare by acquisition source:
       - Google Ads patients: 68% return rate
       - Referral patients: 84% return rate (higher quality leads!)
     * <b>Insight:</b> Referral patients have better retention ‚Üí Focus more on referral program
   - <b>Display:</b> "Patient Retention Dashboard"
   - <b>Test:</b> Calculate return rates for cohorts, verify calculations

9. <b>Service Profitability Analysis (Which Treatments Most Profitable?):</b>
   - <b>Problem:</b> Botox generates $150K revenue, Facials generate $40K - but which is more profitable?
   - <b>Solution:</b>
     * Profit margin analysis:
       - <b>Botox:</b>
         * Revenue: $150,000
         * COGS (Botox product cost): $45,000
         * Labor (practitioner time): $22,500 (15% commission)
         * Gross profit: $82,500
         * Profit margin: 55%
       - <b>Facials:</b>
         * Revenue: $40,000
         * COGS (products): $4,000
         * Labor: $4,000 (10% commission)
         * Gross profit: $32,000
         * Profit margin: 80% (higher margin!)
     * <b>Insight:</b> Facials have higher margin but lower volume ‚Üí Strategy: Upsell facials alongside Botox to increase overall profitability
   - <b>Display:</b> "Service Profitability Dashboard"
   - <b>Test:</b> Calculate profit margins for all services, rank by profitability

10. <b>Custom Report Builder (Manager Creates Own Reports):</b>
    - <b>Problem:</b> Manager has specific question not covered by standard reports
    - <b>Solution:</b>
      * Drag-and-drop report builder:
        - Select data fields: [Patient Name] [Service] [Revenue] [Date] [Practitioner]
        - Filter: Date range, Service type, Practitioner, Location
        - Group by: Practitioner, Service type, Week, Month
        - Sort: Revenue (descending)
        - Chart type: [Table] [Bar chart] [Line chart] [Pie chart]
      * Example custom report: "Revenue by practitioner by week for Q3 2025"
      * Save report: "My Custom Report - Q3 Revenue" ‚Üí Can run anytime
      * Schedule: Email every Monday at 9am
    - <b>Implementation:</b> SQL query builder or BI tool integration (Tableau, Looker, Metabase)
    - <b>Test:</b> Create custom report, verify data accurate, save and schedule

<b>DELIVERABLES:</b>
- All 7 core reports verified and accurate (daily summary, weekly performance, monthly financial, revenue tracking, patient count, no-show rate, commission calculations)
- All 10 edge cases implemented (cross-location reporting, date range exports, reconciliation, cancelled vs rescheduled, refund tracking, package credits, tips handling, split appointments, YoY comparison, automated email reports)
- 10 advanced analytics added (staff performance insights, predictive no-show risk, churn prediction, LTV dashboard, marketing ROI, treatment outcome tracking, practitioner efficiency, retention metrics, service profitability, custom report builder)
- Data accuracy verified (reports match bank statements, QuickBooks, manual counts)
- Strategic insights enabled (which services most profitable, which marketing channels best ROI, which patients at risk)

<b>TESTING CHECKLIST:</b>
- [ ] Daily summary shows correct appointments, revenue, no-shows
- [ ] Weekly performance metrics calculated accurately
- [ ] Monthly financial report matches QuickBooks
- [ ] Revenue vs cash collected reconciles with bank statements
- [ ] Patient count (new vs returning) accurate
- [ ] No-show rate tracked, cost calculated
- [ ] Commission calculations correct (staff verified)
- [ ] Cross-location reports filter correctly
- [ ] Date range exports work (PDF, Excel, CSV)
- [ ] Reconciliation report identifies discrepancies
- [ ] Cancelled vs rescheduled tracked separately
- [ ] Refunds deducted from net revenue
- [ ] Package credits tracked separately from cash
- [ ] Tips excluded from commission calculations
- [ ] Split appointments divide commission correctly
- [ ] Year-over-year comparison shows historical data
- [ ] Automated email reports send on schedule
- [ ] Staff performance dashboard shows multiple metrics
- [ ] No-show prediction model trained and tested
- [ ] Churn prediction identifies at-risk patients
- [ ] Patient LTV calculated, VIP tier identified
- [ ] Marketing ROI tracked by channel
- [ ] Treatment outcomes measured (before/after analysis)
- [ ] Practitioner efficiency metrics tracked (on-time, wait times)
- [ ] Retention metrics calculated (30/60/90 day return rates)
- [ ] Service profitability analyzed, ranked by margin
- [ ] Custom report builder allows creating/saving reports

<b>SUCCESS METRICS:</b>
- Data accuracy: >99% (reports match source systems within 1%)
- Report generation time: <5 seconds for standard reports
- Manager satisfaction: "Can answer any business question with reports" (yes/no: YES)
- Commission disputes: 0 per month (accurate calculations eliminate disputes)
- Strategic decisions enabled: 10+ data-driven decisions per month (e.g., "Increase Instagram ad budget based on 3√ó ROI")
- No-show prediction accuracy: >80% (model correctly predicts 80%+ of no-shows)
- Churn prediction accuracy: >75% (identify 75%+ of patients who will churn)
- Time saved: 10 hours/week on manual reporting (automated reports eliminate manual work)

<b>HOW TO APPROACH:</b>
1. Test all 7 core reports: Generate each report, manually verify calculations against database, cross-reference with QuickBooks/bank statements
2. Test all 10 edge cases systematically (cross-location, custom date ranges, reconciliation, etc.)
3. Implement advanced analytics (ML models for prediction, LTV calculations, ROI tracking)
4. Build custom report builder or integrate BI tool
5. Train predictive models on 6+ months historical data
6. Validate model accuracy: Predict last month's no-shows, compare to actual, measure accuracy
7. Provide detailed report: "Tested all reports. Found 2 discrepancies (commission calculation for package credits, refunds not deducted). Fixed both issues. Implemented no-show prediction (83% accuracy), churn prediction (78% accuracy), LTV dashboard (identified 53 VIP patients worth $420K). All reports now accurate to 99.8%. Manager can answer any business question in <30 seconds. Ready for production."

This is the brain of the business - data turns into insights, insights turn into strategy!</pre>
                            </div>

                            <div class="detail-grid">
                                <div class="detail-card">
                                    <h4>‚úÖ Core Reports to Verify</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Daily summary (revenue, appointments, no-shows)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Weekly performance metrics</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Monthly financial report</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Revenue tracking vs. actual cash</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient count (new vs. returning)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>No-show rate tracking</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Commission calculations accurate</span></label>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <h4>üöÄ Enhancements to Add</h4>
                                    <div class="requirements-checklist">
                                        <label class="checkbox-item"><input type="checkbox"><span>Staff performance insights (avg ticket, upsells)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Predictive analytics (no-show risk, churn)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Retention metrics (30/60/90 day return rate)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Marketing ROI tracking</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Treatment outcome tracking (AI photo analysis)</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Practitioner efficiency metrics</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Patient lifetime value dashboard</span></label>
                                        <label class="checkbox-item"><input type="checkbox"><span>Custom report builder</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE IV: AUTOMATION ENHANCEMENTS -->
                <div class="roadmap-queue" style="margin-top: 60px;">
                    <h2 class="section-title">‚ö° PHASE IV: Automation Enhancements & High-ROI Features</h2>
                    <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">These features offer significant ROI through increased revenue and time savings.</p>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('waitlist-management')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">15</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìã Waitlist Management üî•</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1 week ‚Ä¢ ROI: Fill 80% of cancellations ‚Üí ~$10K/month revenue ‚Ä¢ üéØ BUILD ORDER: #7</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="waitlist-management" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a comprehensive Waitlist Management system that automatically fills last-minute cancellations by instantly notifying waitlisted patients via SMS. This is about implementing intelligent waitlist queuing (priority by service type, practitioner preference, time flexibility), real-time automated notifications ("Spot opened Friday 2pm with Dr. Smith - Reply YES to book!"), handling edge cases (multiple people respond, slot already filled, patient no longer interested), and maximizing revenue recovery (fill 80%+ of cancellations, track $10K+ monthly revenue from waitlist conversions).

<b>WHAT THIS IS:</b>
Waitlist Management is a **revenue recovery system** that turns cancellations (lost revenue) into opportunities (waitlist patients instantly grab the slot). This is HIGH-ROI because:
- **Revenue recovery:** 20-30 cancellations/month √ó $450 avg = $9K-$13.5K lost revenue ‚Üí Waitlist fills 80% = $7.2K-$10.8K recovered!
- **Patient satisfaction:** Patients on waitlist thrilled to get earlier appointment (might have been waiting weeks)
- **Slot optimization:** No empty calendar slots = maximized practitioner utilization
- **Competitive advantage:** Competitors don't have instant waitlist = patients book with you instead
- **Flexibility:** Patients can waitlist for "any time this week" or "Fridays only" or "Dr. Smith only"

<b>WHY WE NEED THIS:</b>
Cancellations happen constantly (life happens - sick kids, work emergencies, changed minds). Currently when patient cancels, that slot sits empty until someone manually calls waitlisted patients (if anyone even tracks a waitlist!). By the time someone calls, slot may only be 2 hours away - hard to fill. **Automated waitlist solves this:** Cancellation at 1pm for 3pm slot ‚Üí 20 waitlisted patients instantly texted ‚Üí 3 people reply YES within 2 minutes ‚Üí First responder gets slot ‚Üí Slot filled!

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: Last-Minute Cancellation, Instant Fill</b>
   - **1:00pm:** Patient Sarah calls: "I need to cancel my 3pm Botox appointment today, I'm sick."
   - Front desk clicks "Cancel" ‚Üí Reason: "Patient sick"
   - **1:01pm (60 seconds later):** System automatically:
     * Identifies 12 patients waitlisted for "Botox with Dr. Smith" or "Botox - any practitioner"
     * Prioritizes by flexibility: Patients who said "any day this week" ranked higher than "Fridays only"
     * Sends SMS to top 5 priority patients simultaneously:
       **"OPENING! Botox with Dr. Smith today at 3pm (2 hours from now). Reply YES to book, NO if unavailable."**
   - **1:02pm:** 3 patients reply "YES" within 60 seconds
   - **1:02pm:** System books first responder (Emily), texts others: "Slot filled. You're still on waitlist for future openings!"
   - **Result:** Slot filled in 2 minutes, $450 revenue saved, Emily thrilled to get earlier appointment

2. <b>Scenario: Patient Wants Specific Practitioner & Time</b>
   - Patient Michael wants Botox but Dr. Smith (his preferred practitioner) fully booked for next 3 weeks
   - Front desk: "Dr. Smith is booked out 3 weeks. Want to see Dr. Jones instead?"
   - Michael: "No, I really prefer Dr. Smith. I'll wait."
   - Front desk adds to waitlist:
     * Service: Botox
     * Practitioner: **Dr. Smith only** (strict preference)
     * Timeframe: "Weekdays after 5pm only" (works 9-5)
     * Flexibility: Low (very specific requirements)
   - **Next week:** Patient cancels Dr. Smith appointment for Thursday 5:30pm
   - System checks waitlist: Michael is #1 for "Dr. Smith + weekday evenings"
   - SMS sent: "Opening with Dr. Smith this Thursday 5:30pm! Reply YES to book."
   - Michael replies: "YES!"
   - Booked instantly, Michael happy (got preferred practitioner 2 weeks earlier than expected)

3. <b>Scenario: Service-Specific Waitlist (Can't Substitute)</b>
   - Patient Lisa waitlisted for "Laser hair removal - legs"
   - Cancellation happens: "Botox - forehead" opens up
   - System does NOT notify Lisa (wrong service type, can't substitute laser appointment with Botox)
   - Only notifies patients waitlisted for "Botox" or "Any service"
   - <b>Why critical:</b> Prevents irrelevant notifications, maintains patient trust

4. <b>Scenario: Multiple Responses, First-Come-First-Served</b>
   - Cancellation: Friday 2pm Botox slot opens
   - System texts 5 waitlisted patients simultaneously (all have equal priority)
   - Responses within 2 minutes:
     * **1:01:15pm:** Emily replies "YES"
     * **1:01:22pm:** Jessica replies "YES"
     * **1:01:45pm:** Amanda replies "YES"
   - System books Emily (first responder - 1:01:15pm)
   - Texts Jessica & Amanda: "Slot already filled by another patient. You're still on waitlist!"
   - Jessica disappointed but appreciates quick response
   - <b>Fairness:</b> First-come-first-served based on SMS reply timestamp

<b>YOUR TASKS:</b>

<b>PART 1: CORE WAITLIST FUNCTIONALITY (Build the Foundation)</b>

1. <b>Add to Waitlist (Patient Enrollment):</b>
   - When patient can't get preferred appointment, front desk adds to waitlist
   - Waitlist form:
     * Patient: Sarah Johnson (auto-populate from patient record)
     * Service: [Dropdown: Botox, Fillers, Laser Hair Removal, Facial, Any Service]
     * Practitioner preference: [Dr. Smith only] [Dr. Jones only] [No preference - any practitioner]
     * Preferred days: [Mon] [Tue] [Wed] [Thu] [Fri] [Sat] [Sun] [Any day]
     * Preferred times: [Morning 8-12] [Afternoon 12-5] [Evening 5-8] [Anytime]
     * How far in advance willing to come?: [Same day (2+ hours notice)] [1-2 days notice] [3-7 days notice] [1+ week notice]
     * Priority level: [Normal] [Urgent - medical concern] [Flexible - whenever works]
     * Notes: "Patient prefers Fridays due to work schedule"
   - Submit ‚Üí Patient added to waitlist queue
   - Confirmation SMS: "You're on the waitlist for Botox with Dr. Smith (preferred times: Fri afternoons). We'll text you if a spot opens up!"
   - <b>Database:</b> waitlist table (patient_id, service_id, practitioner_id, preferred_days, preferred_times, advance_notice, priority, notes, created_at, status)
   - <b>Test:</b> Add patient to waitlist, verify saved correctly, confirmation SMS sent

2. <b>Waitlist Queue View (Manager Dashboard):</b>
   - Manager clicks "View Waitlist" ‚Üí Sees all waitlisted patients
   - List shows:
     * Patient name: Sarah Johnson
     * Service: Botox
     * Practitioner: Dr. Smith preferred
     * Flexibility: Fridays only, afternoons
     * Days on waitlist: 12 days
     * Priority: Normal
     * [Remove from Waitlist] [Book Now] buttons
   - Sort by: [Days waiting] [Priority] [Service] [Practitioner]
   - Filter: [All] [Botox only] [Dr. Smith only] [High priority]
   - <b>Use case:</b> Manager can see who's been waiting longest, call them proactively
   - <b>Test:</b> View waitlist, sort/filter, verify all waitlisted patients appear

3. <b>Cancellation Triggers Waitlist (Automated Flow):</b>
   - Patient cancels appointment ‚Üí Cancellation form:
     * Reason: [Patient sick] [Scheduling conflict] [Changed mind] [Other: _____]
     * Reschedule?: [Yes - help patient book new appointment] [No - patient declined]
   - If NO reschedule ‚Üí Slot now available
   - System immediately (within 5 seconds):
     * Identifies matching waitlisted patients:
       - Service matches (Botox cancellation ‚Üí Notify Botox waitlist)
       - Practitioner matches (Dr. Smith cancellation ‚Üí Notify "Dr. Smith preferred" patients)
       - Time matches preferences (3pm Fri ‚Üí Notify "Fri afternoon" patients)
       - Advance notice OK (3pm today ‚Üí Only notify "same day OK" patients, NOT "1 week notice" patients)
     * Ranks patients by priority:
       1. Exact match (service + practitioner + time all match) + Urgent priority
       2. Exact match + Normal priority
       3. Partial match (service matches, practitioner flexible) + Urgent
       4. Partial match + Normal
     * Sends SMS to top 5 matches simultaneously
   - <b>Test:</b> Cancel appointment, verify waitlist patients notified within 10 seconds

4. <b>Waitlist Notification SMS (Clear, Actionable):</b>
   - SMS template (165 characters to fit single SMS):
     **"SPOT AVAILABLE! Botox with Dr. Smith - Fri 10/25 at 2pm. Reply YES to book, NO to skip. Link: [booking link]"**
   - Key elements:
     * Urgency: "SPOT AVAILABLE!" (grabs attention)
     * Details: Service, practitioner, date, time (all critical info)
     * Action: "Reply YES to book" (simple, clear)
     * Fallback: "[booking link]" (if patient wants to see more details first)
   - <b>Test different variations (A/B test):</b>
     * Version A: "SPOT AVAILABLE! Botox..."
     * Version B: "Opening! Botox..." (less urgent)
     * Version C: "Last-minute opening! Botox..." (emphasizes short notice)
     * Measure: Which has highest YES response rate?
   - <b>Test:</b> Send SMS, verify format correct, patient receives, can reply YES/NO

5. <b>Patient Replies YES ‚Üí Auto-Book (Race Condition Handling):</b>
   - Patient texts "YES" to claim slot
   - System checks:
     * Is slot still available? (Yes ‚Üí Book, No ‚Üí "Sorry, already filled")
     * Did another patient reply YES first? (Check timestamp)
     * Is patient's phone number in system? (Verify identity)
   - If slot available:
     * Book appointment instantly
     * Deduct slot from calendar (mark as filled)
     * Send confirmation: "Booked! Botox with Dr. Smith on Fri 10/25 at 2pm. See you soon!"
     * Remove patient from waitlist (they got their appointment)
     * Send "Slot filled" SMS to other patients who also replied YES
   - <b>Race condition:</b> 3 patients reply YES within 10 seconds
     * 2:01:15pm - Emily: "YES"
     * 2:01:18pm - Jessica: "YES"
     * 2:01:22pm - Amanda: "YES"
     * System timestamps all replies
     * Emily gets slot (first timestamp)
     * Jessica & Amanda get: "Slot filled. Still on waitlist for future openings."
   - <b>Test:</b> Simulate 3 simultaneous YES replies, verify only first booked, others notified

6. <b>Patient Replies NO ‚Üí Stay on Waitlist:</b>
   - Patient texts "NO" (not available for this slot)
   - System:
     * Keeps patient on waitlist (still interested in future openings)
     * Records: "Declined opening on 10/25 at 2pm - reason: not available"
     * Moves to next patient in queue (if slot still unfilled)
   - Auto-reply: "No problem! You're still on the waitlist. We'll text you about future openings."
   - <b>Test:</b> Reply NO, verify patient stays on waitlist, next patient notified

7. <b>Waitlist Expiration (Auto-Remove Inactive Patients):</b>
   - Problem: Patients on waitlist for 90 days, probably forgot or booked elsewhere
   - Solution:
     * After 30 days on waitlist: Check-in SMS "You've been on waitlist for Botox for 30 days. Still interested? Reply YES to stay on waitlist, NO to remove."
     * If no response after 3 days ‚Üí Auto-remove from waitlist
     * If YES ‚Üí Keep on waitlist
     * If NO ‚Üí Remove, send "Removed from waitlist. Contact us anytime to re-add!"
   - <b>Why needed:</b> Keeps waitlist clean (only active, interested patients)
   - <b>Test:</b> Patient on waitlist 30 days, check-in SMS sent, patient replies YES or NO or no reply

8. <b>Manual Waitlist Booking (Front Desk Can Book from Waitlist):</b>
   - Front desk sees empty slot tomorrow 3pm
   - Clicks "Fill from Waitlist" ‚Üí Shows matching waitlisted patients
   - Sorted by: Days waiting (longest first)
   - Front desk calls #1 patient: "Hi Sarah, we have a Botox opening tomorrow at 3pm. Interested?"
   - Sarah: "Yes!"
   - Front desk clicks "Book" ‚Üí Appointment created, Sarah removed from waitlist
   - <b>Use case:</b> Proactive filling of future openings (not just same-day cancellations)
   - <b>Test:</b> Click "Fill from Waitlist", call patient, book appointment, verify removed from waitlist

9. <b>Waitlist Analytics (Track ROI):</b>
   - Manager dashboard: "Waitlist Performance - October 2025"
   - Metrics:
     * Cancellations this month: 24 appointments ($10,800 potential lost revenue)
     * Filled from waitlist: 19 appointments (79% fill rate!)
     * Revenue recovered: $8,550 (79% of $10,800)
     * Waitlist size: 34 active patients
     * Avg days on waitlist: 8 days
     * Conversion rate: 68% (patients who get waitlist SMS and book)
     * No-show rate for waitlist appointments: 3% (lower than general no-show rate!)
   - <b>Insight:</b> Waitlist appointments have lower no-show rate (patients really wanted the slot)
   - <b>Test:</b> Generate analytics, verify calculations accurate

10. <b>Multi-Location Waitlist (If Multiple Locations):</b>
    - Patient: "I'm willing to go to either Location A or Location B, whichever has opening first"
    - Waitlist form: Location preference: [Location A] [Location B] [Either location]
    - Cancellation at Location B ‚Üí Notifies patients who selected "Location B" or "Either location"
    - <b>Test:</b> Patient waitlisted for "either location", cancellation at Location B, patient notified

<b>PART 2: IMPLEMENT EDGE CASES (12 Critical Scenarios)</b>

1. <b>Same Patient, Multiple Waitlists:</b>
   - <b>Problem:</b> Patient on waitlist for both "Botox" and "Fillers" - gets booked for Botox, should system auto-remove from Fillers waitlist?
   - <b>Solution:</b> Ask patient when adding to second waitlist: "You're already waitlisted for Botox. If you book Botox, should we keep you on Fillers waitlist? [Yes - I want both] [No - remove me from Fillers if I book Botox]"
   - <b>Test:</b> Patient on 2 waitlists, books one, verify kept or removed from other based on preference

2. <b>Slot Filled Before Patient Replies:</b>
   - <b>Problem:</b> 5 patients texted at 1:01pm about 3pm opening. Patient #4 replies "YES" at 1:15pm (14 min later), but slot already filled at 1:02pm
   - <b>Solution:</b> Auto-reply "Sorry, this spot was already filled by another patient. You're still on waitlist for future openings!"
   - <b>Prevention:</b> When slot filled, immediately cancel pending waitlist notifications for that slot
   - <b>Test:</b> Patient replies YES to filled slot, receives "already filled" message

3. <b>Patient No Longer Wants Service (Changed Mind):</b>
   - <b>Problem:</b> Patient on waitlist for "Laser hair removal", decides to get waxing instead (no longer needs laser)
   - <b>Solution:</b> Patient can text "REMOVE" or "STOP" to remove themselves from waitlist
     * Auto-reply: "You've been removed from the Botox waitlist. Contact us anytime to re-add!"
   - OR: Patient calls front desk: "Please remove me from waitlist"
   - <b>Test:</b> Patient texts "REMOVE", removed from waitlist, confirmation sent

4. <b>Waitlist for "Any Service" (Maximum Flexibility):</b>
   - <b>Problem:</b> Patient wants to come in ASAP, doesn't care what service
   - <b>Solution:</b> Waitlist option: Service: "Any service - I just want to come in soon"
   - These patients notified for ALL cancellations (Botox, Fillers, Laser, Facial, anything)
   - Priority: Lower than service-specific waitlist (service-specific patients get first dibs)
   - <b>Use case:</b> VIP patients who just want any face time, flexibility maximizes chance of getting slot
   - <b>Test:</b> Patient waitlisted for "any service", cancellation happens (any service), patient notified

5. <b>Short-Notice Cancellation (<2 Hours):</b>
   - <b>Problem:</b> Cancellation at 2pm for 3:30pm appointment (90 min notice) - not enough time for most patients
   - <b>Solution:</b> Only notify patients who marked "same-day OK with 2+ hours notice"
     * Don't notify patients who need "1-2 days notice" (not enough time)
   - SMS different template: "URGENT: Opening TODAY at 3:30pm (90 min from now). Reply YES if you can make it!"
   - <b>Expected lower fill rate:</b> Short notice = harder to fill (maybe 40% vs 80% for next-day)
   - <b>Test:</b> Cancellation 90 min before appointment, only same-day-OK patients notified

6. <b>Practitioner Called In Sick (Bulk Cancellations):</b>
   - <b>Problem:</b> Dr. Smith calls in sick, 8 appointments today need to cancel
   - <b>Solution:</b>
     * Front desk: "Cancel all Dr. Smith appointments today" ‚Üí Bulk cancel
     * Offer reschedule: Call each patient, offer Dr. Jones instead or reschedule to next week
     * Waitlist handling: Don't blast waitlist with 8 simultaneous openings (chaos!)
     * Instead: Drip notifications (notify 5 patients per opening, wait 5 min, if unfilled notify next 5)
   - <b>Test:</b> Bulk cancel 8 appointments, verify waitlist notifications spaced out (not all at once)

7. <b>Recurring Appointment Cancellation (Package Series):</b>
   - <b>Problem:</b> Patient on 6-session laser package cancels session #3 (but #4, #5, #6 still scheduled)
   - <b>Solution:</b> Offer waitlist patient one-time slot (not recurring)
     * SMS: "One-time laser session available Fri 2pm. This is NOT a recurring appointment."
   - <b>If waitlist patient wants recurring:</b> "Sorry, this is one-time only. Keep you on waitlist for recurring series?"
   - <b>Test:</b> Recurring appointment cancels, waitlist patient gets one-time slot (not series)

8. <b>VIP Patients (Priority Waitlist):</b>
   - <b>Problem:</b> VIP patient (spent $15K this year) on waitlist, should they get priority over new patient?
   - <b>Solution:</b> Priority tiers:
     * **Tier 1 (Urgent medical):** Medical concern, needs ASAP (highest priority)
     * **Tier 2 (VIP):** Patients with >$5K lifetime spend (priority over regular)
     * **Tier 3 (Long wait):** On waitlist >14 days (loyalty reward)
     * **Tier 4 (Regular):** Everyone else (first-come-first-served by waitlist add date)
   - Cancellation ‚Üí Notify Tier 1 first, then Tier 2, then Tier 3, then Tier 4
   - <b>Test:</b> VIP and regular both on waitlist, VIP notified first

9. <b>Patient Doesn't Reply (No Response):</b>
   - <b>Problem:</b> Patient texted about opening, no response after 10 minutes
   - <b>Solution:</b> After 10 min no response ‚Üí Move to next patient in queue
     * Notify next 5 patients
     * Original patient can still reply later but may have lost spot
   - <b>Test:</b> Patient doesn't reply for 10 min, next patients notified

10. <b>Waitlist for New Patients (No Patient Record Yet):</b>
    - <b>Problem:</b> Someone calls: "I'm not a patient yet but I'd like to get on waitlist for Botox"
    - <b>Solution:</b>
      * Create patient record (minimal info: name, phone)
      * Add to waitlist
      * When opening comes up, text them
      * When they book, complete patient intake (medical history, etc.) at appointment
    - <b>Test:</b> New patient added to waitlist, gets notified when slot opens

11. <b>Time Zone Handling (If Multi-Location with Different Zones):</b>
    - <b>Problem:</b> Location A in EST, Location B in PST - patient in PST waitlisted for Location A appointment
    - <b>Solution:</b> SMS shows both time zones:
      * "Opening Fri 2pm EST (11am PST). Reply YES to book."
    - <b>Test:</b> Patient in different timezone, SMS shows both times correctly

12. <b>Waitlist Fatigue (Too Many Notifications):</b>
    - <b>Problem:</b> Patient on waitlist, gets 12 SMS in one month (slot opens, but they can't make any of them), gets annoyed
    - <b>Solution:</b> Limit notifications: Max 2 per week per patient
      * If >2 openings in one week match their criteria, only notify about top 2 (best matches)
      * After 5 "NO" responses in 30 days: "You've declined 5 openings. Still interested in waitlist? Reply YES to stay, NO to remove."
    - <b>Test:</b> Patient gets 3 matching openings in one week, only texted about 2 (best matches)

<b>PART 3: ADD ENHANCEMENTS (6 Revenue-Maximizing Features)</b>

1. <b>Predictive Waitlist (AI Suggests Who to Waitlist):</b>
   - <b>Problem:</b> Front desk sometimes forgets to offer waitlist option
   - <b>Solution:</b> AI suggests: "Patient wants Botox on Fridays but Dr. Smith fully booked. **Suggest waitlist?** [Yes - Add to waitlist] [No thanks]"
   - Triggers when:
     * Preferred practitioner fully booked >2 weeks out
     * Preferred day/time unavailable
     * Patient says "That's too far out, I wanted sooner"
   - <b>Test:</b> Patient can't get preferred slot, AI suggests waitlist, front desk adds patient

2. <b>Waitlist Upsell (Offer Upgraded Service):</b>
   - <b>Problem:</b> Patient waitlisted for basic service, premium service opens up
   - <b>Solution:</b> SMS: "Opening for **Premium** Botox with Dr. Smith (includes face massage) on Fri 2pm - $520 (regular $450). Interested? Reply YES."
     * Patient can upgrade to premium for earlier slot
   - <b>Revenue boost:</b> Patient pays $70 more to get off waitlist faster
   - <b>Test:</b> Premium slot opens, waitlist patient offered upgrade

3. <b>Dynamic Waitlist Pricing (Surge Pricing for High-Demand Slots):</b>
   - <b>Problem:</b> Friday 5pm slots (highest demand) cancel, waitlist patients jump on it
   - <b>Solution:</b> SMS: "**High-demand slot** Fri 5pm Botox - $500 (reg $450, +$50 peak pricing). Reply YES to book."
     * Patient willing to pay premium for prime slot
   - <b>Ethical consideration:</b> Clearly disclose surge pricing, patient opts in
   - <b>Test:</b> Peak slot opens, waitlist SMS includes surge pricing, patient pays premium if books

4. <b>Waitlist Referral Bonus (Get Off Waitlist Faster):</b>
   - <b>Problem:</b> Patient on waitlist, wants to move up in queue
   - <b>Solution:</b> "Refer a friend who books = move up 5 spots in waitlist queue"
     * Gamification: Incentivizes referrals
     * Win-win: Practice gets new patient, referrer gets faster waitlist
   - <b>Test:</b> Patient refers friend, friend books, referrer moves up in queue

5. <b>Waitlist Bundle (Combine Services for Faster Booking):</b>
   - <b>Problem:</b> Patient wants Botox, waitlisted 2 weeks. Facial available tomorrow.
   - <b>Solution:</b> SMS: "Combo deal! Botox + Facial tomorrow 2pm - $600 (save $50, skip waitlist). Reply YES."
     * Patient books 2 services, gets off waitlist, practice increases revenue
   - <b>Test:</b> Waitlist patient offered bundle, books combo

6. <b>Waitlist Loyalty Rewards (Thank Long-Waiting Patients):</b>
   - <b>Problem:</b> Patient on waitlist 30+ days, finally gets slot, should get reward for patience
   - <b>Solution:</b> Auto-apply discount: "You've been on waitlist 32 days! 10% off today's appointment as thank you for your patience."
     * Builds loyalty
     * Acknowledges wait
   - <b>Test:</b> Patient on waitlist >30 days books, discount auto-applied

<b>DELIVERABLES:</b>
- Waitlist enrollment system (patients can be added with flexible criteria: service, practitioner, time preferences)
- Auto-notification on cancellations (SMS sent within 10 seconds to top 5 matches)
- Race condition handling (first YES reply gets slot, others notified it's filled)
- Waitlist queue management (view, sort, filter, manually book from waitlist)
- ROI tracking (24 cancellations/month ‚Üí 19 filled from waitlist = 79% fill rate = $8.5K revenue recovered)
- Edge cases handled (multiple replies, short notice, bulk cancellations, VIP priority, notification fatigue)
- Advanced features (predictive waitlist suggestions, upsell opportunities, surge pricing, referral bonuses)

<b>TESTING CHECKLIST:</b>
- [ ] Add patient to waitlist with preferences (service, practitioner, times)
- [ ] Confirmation SMS sent to patient after waitlist enrollment
- [ ] View waitlist queue (all patients listed)
- [ ] Cancel appointment ‚Üí Waitlist SMS sent within 10 seconds
- [ ] Patient replies YES ‚Üí Appointment booked, confirmation sent
- [ ] Multiple patients reply YES ‚Üí First responder gets slot, others notified "filled"
- [ ] Patient replies NO ‚Üí Stays on waitlist, next patient notified
- [ ] Slot filled ‚Üí Pending notifications cancelled
- [ ] 30-day check-in SMS sent to long-waiting patients
- [ ] Patient removed from waitlist after booking
- [ ] Manual "Fill from Waitlist" works (front desk can call and book)
- [ ] Analytics track fill rate, revenue recovered
- [ ] Multi-location waitlist filters correctly
- [ ] Same patient on multiple waitlists handled
- [ ] Short-notice (<2hr) only notifies same-day-OK patients
- [ ] VIP patients prioritized over regular
- [ ] Notification limit (max 2/week) enforced
- [ ] AI suggests waitlist when preferred slot unavailable

<b>SUCCESS METRICS:</b>
- Cancellation fill rate: 75-85% (goal: fill 4 out of 5 cancellations)
- Revenue recovered: $8K-$12K/month (20-30 cancellations √ó $450 avg √ó 80% fill rate)
- Response time: <2 minutes average from cancellation to first YES reply
- No-show rate for waitlist appointments: <5% (lower than general rate because patients really wanted slot)
- Waitlist conversion rate: >60% (patients who get SMS actually book)
- Patient satisfaction: 95%+ of waitlist patients rate experience 4-5 stars
- Time to fill slot: <10 minutes average (cancellation ‚Üí notification ‚Üí YES reply ‚Üí booked)

<b>HOW TO APPROACH:</b>
1. Build waitlist database table and enrollment UI
2. Implement cancellation trigger ‚Üí waitlist notification workflow
3. Handle SMS replies (YES/NO/REMOVE) with race condition logic
4. Test with real scenarios: Cancel appointment, verify 5 patients texted simultaneously
5. Simulate 3 patients replying YES within 10 seconds, verify only first booked
6. Track ROI for 30 days: How many cancellations? How many filled? Revenue recovered?
7. Provide detailed report: "Implemented waitlist system. Month 1 results: 24 cancellations, 19 filled from waitlist (79% fill rate), $8,640 revenue recovered. Avg time to fill: 8 minutes. Waitlist conversion rate: 67%. Patient satisfaction: 4.8/5 stars. ROI: $8,640/month = $103,680/year revenue increase!"

Turn cancellations into opportunities - automate revenue recovery!</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('noshow-prediction')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">16</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üéØ No-Show Prediction & Prevention üî•</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ ROI: Reduce no-shows 50% ‚Üí ~$5K-8K/month saved ‚Ä¢ üéØ BUILD ORDER: #16</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="noshow-prediction" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">I need you to build a comprehensive No-Show Prediction & Prevention system using machine learning to identify high-risk appointments and automatically implement preventive interventions. This is about training predictive models (analyze 15+ risk factors: patient history, appointment timing, booking behavior, payment status), implementing tiered prevention strategies (extra confirmation calls for high-risk, prepayment requirements, credit card holds, double-booking safeguards), tracking effectiveness (A/B test interventions, measure ROI), and reducing no-show rate 40-60% (industry average 15-20% ‚Üí optimized 5-8% = $5K-8K/month saved revenue).

<b>WHAT THIS IS:</b>
No-Show Prediction & Prevention is an **AI-powered revenue protection system** that identifies which appointments will likely no-show BEFORE they happen, allowing proactive intervention. This is HIGH-ROI because:
- **Revenue saved:** 15% no-show rate √ó 150 appointments/week √ó $450 avg = 22 no-shows/week = $40K/month lost revenue!
- **Reduce to 5% with AI:** 5% no-show rate = 7 no-shows/week = $13K/month lost ‚Üí **Saves $27K/month ($324K/year)!**
- **Slot optimization:** Empty slots due to no-shows = wasted practitioner time (practitioner paid salary but not generating revenue)
- **Patient experience:** Patients who frequently no-show frustrate staff, implementing prepayment filter reduces toxic patients
- **Strategic decisions:** Double-book high-risk slots (if 80% likely to no-show, book 2 patients ‚Üí If both show up, offer reschedule or see both)

<b>WHY WE NEED THIS:</b>
No-shows are silent revenue killers. When patient no-shows for 2pm appointment, that slot sits empty (practitioner idle, revenue lost). By the time you realize they're not coming (2:15pm), too late to fill slot. **AI prediction solves this:** Day before appointment, AI scores it "75% no-show risk" ‚Üí Manager calls patient to confirm, or requires prepayment, or double-books slot ‚Üí If patient confirms, great! If patient cancels when called, slot released to waitlist ‚Üí Revenue saved!

<b>REAL-WORLD SCENARIOS:</b>

1. <b>Scenario: New Patient, High Risk, Preventive Call Saves Appointment</b>
   - **AI Analysis - Day Before Appointment:**
     * Patient: Jessica Williams (new patient, first visit)
     * Appointment: Monday 9am (high no-show risk time)
     * Booked: 4 days ago (spontaneous, not planned weeks ahead)
     * Confirmed?: No (hasn't replied to SMS confirmation)
     * Payment on file?: No credit card saved
     * **AI Risk Score: 82% no-show probability (HIGH RISK)**
   - **Automated Prevention Action:**
     * System flags appointment in manager dashboard: "üö® HIGH RISK: Jessica Williams - 82% no-show risk"
     * Auto-generates task: "Call Jessica today to confirm Monday 9am appointment"
   - **Manager Calls:**
     * **Sunday 3pm:** Manager calls Jessica: "Hi Jessica, confirming your Botox appointment tomorrow at 9am. Still good for you?"
     * Jessica: "Oh! I actually forgot I booked that. I can't make it tomorrow, can we reschedule to next week?"
     * Manager: "Absolutely! How about next Monday same time?" ‚Üí Books for next Monday
     * **Outcome:** Cancellation discovered 18 hours before appointment ‚Üí Slot released to waitlist, filled by waitlist patient ‚Üí $450 revenue saved!
   - **What would have happened without AI:**
     * No call Sunday ‚Üí Jessica no-shows Monday 9am ‚Üí Slot sits empty ‚Üí $450 revenue lost

2. <b>Scenario: Repeat No-Shower, Prepayment Required</b>
   - **Patient History: Michael Brown**
     * No-show history: 4 times in past 6 months (67% no-show rate!)
     * Last appointment: No-showed, no call
     * Booking pattern: Books appointments, never shows
   - **AI Analysis for New Booking:**
     * Michael tries to book Friday 2pm Botox
     * **AI flags: "‚ö†Ô∏è WARNING: Patient has 67% no-show rate (4 of 6 appointments). Recommend prepayment requirement."**
   - **Front Desk Action:**
     * Front desk sees warning: "Require $100 deposit to book?"
     * Front desk: "Hi Michael, to secure this Friday slot, we require a $100 deposit (applied toward your $450 treatment)."
     * **Option A:** Michael pays $100 ‚Üí Appointment booked (prepayment incentivizes showing up)
     * **Option B:** Michael: "I don't want to pay deposit" ‚Üí Appointment not booked ‚Üí Saves slot for reliable patient
   - **Outcome:** Prepayment reduces no-show risk from 67% to ~5% (people don't forfeit $100)

3. <b>Scenario: Double-Booking High-Risk Slot</b>
   - **AI Analysis:**
     * Appointment: Monday 8am, Patient Sarah (new patient, unconfirmed, booked yesterday)
     * **Risk Score: 70% no-show probability**
   - **Strategic Double-Booking:**
     * Manager reviews: "70% likely to no-show, let's double-book as safeguard"
     * Books second patient (Emily, reliable patient with 0% no-show history) for same slot
     * **Scenario A (Sarah no-shows, Emily shows):**
       - 8am: Sarah doesn't show (as predicted)
       - 8am: Emily shows up, gets treated
       - Outcome: Slot filled, $450 revenue saved
     * **Scenario B (Both show up - rare!):**
       - 8am: Both Sarah and Emily show up
       - Options:
         1. Practitioner sees both (if 30-min appointments, sees one at 8am, one at 8:30am)
         2. Offer Emily 10% discount to reschedule to later today or tomorrow
         3. See Sarah (original booking), offer Emily free upgrade (premium service) for inconvenience
       - Outcome: Both patients happy, minimal disruption
   - **ROI:** Double-booking recovers 70% of high-risk slots

4. <b>Scenario: SMS Confirmation Non-Responders</b>
   - **Standard Flow:**
     * 24 hours before appointment: "Confirm your Botox tomorrow at 2pm. Reply C to confirm."
     * 50% of patients confirm immediately ("C")
     * 30% confirm later (check text at night)
     * **20% never respond (red flag!)**
   - **AI Insight:**
     * Patients who don't confirm SMS have 35% no-show rate (vs 5% for confirmed patients)
   - **Prevention:**
     * Morning of appointment (8am): "FINAL REMINDER: Botox today at 2pm. Reply C to confirm or call to cancel."
     * Still no response by noon ‚Üí Manager calls: "Just confirming you're coming at 2pm today?"
     * **Outcome A:** Patient answers: "Yes, I'll be there!" ‚Üí Shows up (95% show rate after verbal confirmation)
     * **Outcome B:** Patient answers: "Oh, I can't make it today." ‚Üí Cancels, slot released to waitlist ‚Üí Revenue recovered
     * **Outcome C:** Patient doesn't answer ‚Üí 80% no-show likelihood ‚Üí Consider double-booking

<b>YOUR TASKS:</b>

<b>PART 1: BUILD PREDICTION MODEL (Train AI to Identify Risk)</b>

1. <b>Data Collection (Historical No-Show Analysis):</b>
   - Gather 6+ months of appointment data (minimum 1,000 appointments for statistical significance)
   - For each appointment, record:
     * **Outcome:** [Showed up] [No-showed] [Cancelled <24hr] [Cancelled >24hr] [Rescheduled]
     * **Patient factors:**
       - New patient vs returning patient
       - No-show history (% of past appointments that were no-shows)
       - Cancellation history (% cancelled <24hr)
       - Total visits (loyalty indicator)
       - Lifetime value (VIP vs occasional)
       - Last visit date (active vs inactive)
     * **Appointment factors:**
       - Day of week (Monday = highest no-show rate)
       - Time of day (early morning 8-9am = high risk)
       - Service type (consultations = higher no-show than Botox)
       - Practitioner (some practitioners have higher no-show rates)
       - Location (if multi-location)
     * **Booking factors:**
       - How far in advance booked (booked 6 weeks ago vs yesterday)
       - Booking method (online vs phone vs in-person)
       - Rescheduled? (appointments rescheduled 2+ times = higher risk)
     * **Payment factors:**
       - Credit card on file? (yes/no)
       - Payment method last visit (cash vs card)
       - Outstanding balance (patients owing money = higher no-show)
       - Package credits vs paid appointment
     * **Communication factors:**
       - Confirmed SMS reminder? (yes/no)
       - Time of confirmation (immediate vs late)
       - Phone number valid? (texts delivered vs bounced)
   - <b>Test:</b> Export appointment data for past 6 months, verify all fields populated

2. <b>Feature Engineering (Identify Strongest Predictors):</b>
   - Analyze which factors most strongly correlate with no-shows
   - **Expected strongest predictors (based on industry research):**
     * #1: Patient no-show history (past behavior predicts future)
     * #2: SMS confirmation status (unconfirmed = 7√ó higher no-show rate)
     * #3: New patient (new patients no-show 3√ó more than returning)
     * #4: Monday morning appointments (2√ó higher no-show rate than Friday afternoon)
     * #5: Booking recency (booked yesterday = spontaneous = higher risk)
     * #6: Credit card on file (no card = 50% higher no-show rate)
   - Calculate correlation coefficients
   - <b>Test:</b> Run statistical analysis, identify top 10 risk factors

3. <b>Model Training (Machine Learning Algorithm):</b>
   - **Algorithm options:**
     * **Logistic Regression:** Simple, interpretable, good starting point
     * **Random Forest:** More accurate, handles non-linear patterns
     * **Gradient Boosting (XGBoost):** Most accurate, industry standard for tabular data
   - **Training process:**
     * Split data: 80% training data, 20% test data
     * Train model on 80% (learn patterns: "new patient + Monday 8am + unconfirmed + no card = 75% no-show risk")
     * Test on 20% (predict no-shows, measure accuracy)
   - **Evaluation metrics:**
     * Accuracy: % of predictions correct (goal: >80%)
     * Precision: Of appointments predicted to no-show, how many actually no-showed? (goal: >70%)
     * Recall: Of actual no-shows, how many did we predict? (goal: >75%)
     * AUC-ROC score: Overall model quality (goal: >0.85)
   - <b>Test:</b> Train model, achieve >80% accuracy on test set

4. <b>Risk Scoring (0-100% No-Show Probability):</b>
   - For each appointment in system, model outputs risk score:
     * **0-20% (Very Low Risk):** Regular patient, confirmed, Friday afternoon, card on file ‚Üí 3% actual no-show rate
     * **21-40% (Low Risk):** Returning patient, unconfirmed, weekday ‚Üí 12% actual no-show rate
     * **41-60% (Moderate Risk):** New patient, confirmed, weekday ‚Üí 25% actual no-show rate
     * **61-80% (High Risk):** New patient, unconfirmed, Monday morning ‚Üí 45% actual no-show rate
     * **81-100% (Very High Risk):** Repeat no-shower, unconfirmed, no card ‚Üí 75% actual no-show rate
   - Risk scores updated real-time (patient confirms SMS ‚Üí Risk drops from 70% to 25%)
   - <b>Test:</b> Generate risk scores for tomorrow's appointments, verify scores make intuitive sense

5. <b>Dashboard Visualization (Manager Reviews High-Risk Appointments):</b>
   - Manager dashboard: "Tomorrow's High-Risk Appointments"
   - List shows:
     * **Very High Risk (80-100%):** 3 appointments flagged üö®
       - Michael Brown, 8am Botox, 85% risk ‚Üí Suggested action: Require prepayment or cancel
     * **High Risk (60-80%):** 5 appointments flagged ‚ö†Ô∏è
       - Sarah Johnson, 9am Facial, 72% risk ‚Üí Suggested action: Call to confirm
     * **Moderate Risk (40-60%):** 8 appointments flagged ‚ö°
       - Emily Davis, 2pm Laser, 48% risk ‚Üí Suggested action: Send extra SMS reminder
   - Manager can:
     * Click "Call Patient" ‚Üí Auto-dials phone number
     * Click "Send Reminder" ‚Üí Extra SMS sent
     * Click "Require Prepayment" ‚Üí System blocks appointment unless $100 deposit paid
     * Click "Double-Book" ‚Üí Search for second patient to book same slot
   - <b>Test:</b> View dashboard, sort by risk score, take preventive actions

<b>PART 2: IMPLEMENT PREVENTION STRATEGIES (Reduce No-Shows)</b>

1. <b>Tiered Interventions (Risk-Based Actions):</b>
   - **Very Low Risk (0-20%):** No action needed (these patients almost never no-show)
   - **Low Risk (21-40%):** Standard reminder (24hr SMS confirmation)
   - **Moderate Risk (41-60%):**
     * Extra reminder (24hr + 2hr before appointment)
     * Check credit card on file (if no card, ask to add one)
   - **High Risk (61-80%):**
     * Phone call day before to verbally confirm
     * If no answer, send urgent SMS: "Please confirm by replying YES or appointment may be cancelled"
     * Consider credit card hold ($100 held, released after appointment)
   - **Very High Risk (81-100%):**
     * Require prepayment ($100 non-refundable if no-show, applied to treatment if show up)
     * OR: Don't allow booking (protect slot for reliable patients)
     * OR: Double-book slot (book backup patient)
   - <b>Test:</b> Set up automation rules, verify correct actions triggered based on risk score

2. <b>Prepayment Requirement (For Repeat No-Showers):</b>
   - Patient with 3+ no-shows in past 6 months ‚Üí Automatic prepayment requirement
   - When booking:
     * Front desk sees: "‚ö†Ô∏è PREPAYMENT REQUIRED: Patient has 4 no-shows in past 6 months."
     * Front desk: "To secure this appointment, we require $100 deposit. If you show up, it's applied to your $450 treatment. If you no-show, deposit is non-refundable."
     * Patient pays deposit ‚Üí Appointment booked
   - **Outcome:**
     * Patient shows up: $100 deposit + $350 remaining = $450 total (normal transaction)
     * Patient no-shows: Keep $100 deposit (partial revenue recovery)
     * Patient declines deposit: Appointment not booked (saves slot for reliable patient)
   - <b>ROI:</b> Prepayment reduces no-show rate from 67% to 5% (people won't forfeit $100)
   - <b>Test:</b> Patient with no-show history tries to book, prepayment required, deposit collected

3. <b>Credit Card on File (Hold Authorization):</b>
   - For moderate-high risk appointments (50%+ no-show risk):
     * Require credit card on file
     * 24 hours before appointment: Place $100 authorization hold (not charged yet, just reserved)
     * Patient shows up: Release hold, charge actual appointment amount ($450)
     * Patient no-shows: Charge $100 no-show fee, release remaining hold
   - **Benefit:** Incentivizes showing up (don't want $100 charge)
   - **Implementation:** Stripe/Square authorization API
   - <b>Test:</b> Place authorization hold, verify held (not charged), verify released or charged based on outcome

4. <b>Confirmation Call (Personal Touch for High Risk):</b>
   - High-risk appointments (70%+ no-show risk) ‚Üí Manager calls day before
   - Script: "Hi [Patient], this is [Manager] from [Practice]. I'm calling to confirm your appointment tomorrow at [time]. Are you still able to make it?"
   - **Outcome A:** Patient: "Yes, I'll be there!" ‚Üí Risk drops from 70% to 10% (verbal confirmation strong predictor)
   - **Outcome B:** Patient: "Actually, I need to cancel." ‚Üí Slot released immediately, waitlist notified ‚Üí Revenue recovered
   - **Outcome C:** No answer ‚Üí Leave voicemail + send SMS: "Please call us to confirm your appointment, or it may be cancelled."
   - **Data:** Personal confirmation calls reduce no-show rate 60-70%
   - <b>Test:</b> Call high-risk patients, track show rate (should improve from 30% to 90%+)

5. <b>Double-Booking High-Risk Slots (Advanced Strategy):</b>
   - **Strategy:** If appointment 70%+ likely to no-show, book second patient as backup
   - **Implementation:**
     * Manager sees: "Monday 8am - Sarah Johnson - 75% no-show risk - Recommend double-booking?"
     * Manager books Emily (reliable patient) for same slot
     * Notes: "Double-booked due to high no-show risk. If both show, offer Emily later slot with 10% discount."
   - **Outcomes:**
     * Sarah no-shows (75% probability): Emily shows up, slot filled ‚úì
     * Sarah shows, Emily no-shows: Sarah treated, slot filled ‚úì
     * Both show (25% √ó 5% = 1.25% probability):
       - See both if time allows (15 min each instead of 30 min)
       - Offer Emily reschedule with compensation (free add-on service, 10% discount)
       - Practitioner sees Sarah at 8am, Emily at 8:30am
   - **ROI:** Recovers 75% of high-risk slots that would otherwise sit empty
   - <b>Ethical consideration:</b> Only double-book if prepared to accommodate both patients (don't overbook recklessly)
   - <b>Test:</b> Double-book high-risk slot, track outcomes (both show, one shows, neither shows)

6. <b>Automated SMS Escalation (Progressive Reminders):</b>
   - **Standard patient (low risk):** 1 reminder (24hr before)
   - **High-risk patient (60%+ risk):** 3 reminders
     * **48hr before:** "Reminder: Botox on Friday at 2pm. Reply C to confirm."
     * **24hr before:** "Tomorrow at 2pm: Botox. Please confirm you're coming. Reply C."
     * **2hr before:** "FINAL REMINDER: Appointment at 2pm today (in 2 hours). See you soon!"
   - **If patient doesn't confirm after 3 reminders:** Phone call (last resort)
   - <b>Test:</b> High-risk patient gets 3 SMS reminders, verify sent at correct times

7. <b>Waitlist Integration (Fill No-Shows Instantly):</b>
   - **2:15pm:** Patient no-shows for 2pm appointment (15 min late = confirmed no-show)
   - **Automated action:**
     * Mark appointment as "No-showed"
     * Immediately notify waitlist (same as cancellation workflow)
     * **SMS to waitlist:** "Last-minute opening TODAY at 2pm (available NOW). Reply YES if you can come in next 30 min."
   - **3pm patient on waitlist:** Replies YES, comes in at 2:45pm
   - **Outcome:** Partial revenue recovery (lost 2-2:45pm, but recovered 2:45-3:30pm)
   - <b>Test:</b> Patient no-shows, waitlist notified within 2 minutes

<b>PART 3: A/B TESTING & OPTIMIZATION (Measure What Works)</b>

1. <b>A/B Test Interventions (Scientific Approach):</b>
   - **Hypothesis:** "Requiring credit card on file reduces no-show rate"
   - **Test design:**
     * Group A (Control): High-risk appointments, no credit card required ‚Üí Measure no-show rate
     * Group B (Treatment): High-risk appointments, credit card required ‚Üí Measure no-show rate
     * Run for 30 days, 50 appointments per group
   - **Results (example):**
     * Group A: 22 no-shows out of 50 (44% no-show rate)
     * Group B: 4 no-shows out of 50 (8% no-show rate)
     * **Conclusion:** Credit card requirement reduces no-shows 82% (44% ‚Üí 8%)!
   - **Other tests:**
     * SMS reminder timing (24hr vs 48hr vs both)
     * Personal call vs automated SMS
     * Prepayment amount ($50 vs $100 vs $150)
   - <b>Test:</b> Run A/B test for 30 days, analyze results, implement winning strategy

2. <b>Track ROI (Prove Value):</b>
   - **Before AI implementation (Baseline):**
     * No-show rate: 18% (27 no-shows out of 150 appointments/week)
     * Lost revenue: 27 √ó $450 = $12,150/week = $52,650/month
   - **After AI implementation (Month 1):**
     * High-risk appointments identified: 45/week
     * Interventions: 30 phone calls, 15 prepayments required
     * No-show rate: 8% (12 no-shows out of 150 appointments/week) ‚Üí 55% reduction!
     * Lost revenue: 12 √ó $450 = $5,400/week = $23,400/month
     * **Revenue saved: $52,650 - $23,400 = $29,250/month ($351K/year)!**
   - <b>Test:</b> Generate monthly ROI report, compare before vs after

3. <b>Model Retraining (Continuous Improvement):</b>
   - Every 3 months: Retrain model with new data
   - **Why:** Patient behavior changes over time (seasonality, economy, pandemics)
   - **Process:**
     * Gather last 6 months data (including data since model launched)
     * Retrain model with updated data
     * Test accuracy: Is new model better than old model?
     * Deploy new model if improved
   - <b>Test:</b> Retrain model quarterly, track accuracy over time

<b>DELIVERABLES:</b>
- Predictive model trained on historical data (6+ months, 1,000+ appointments)
- Risk scoring for all appointments (0-100% no-show probability, updated real-time)
- Manager dashboard showing high-risk appointments with suggested actions
- Tiered prevention strategies (extra reminders, confirmation calls, prepayment, double-booking)
- A/B testing framework (measure effectiveness of interventions)
- ROI tracking (no-show rate reduction, revenue saved)
- Model retraining pipeline (continuous improvement)

<b>TESTING CHECKLIST:</b>
- [ ] Historical data exported (6+ months appointments)
- [ ] Model trained (accuracy >80%)
- [ ] Risk scores generated for all appointments
- [ ] Dashboard shows high-risk appointments sorted by risk
- [ ] Very High Risk (80-100%) triggers prepayment requirement
- [ ] High Risk (60-80%) triggers confirmation call
- [ ] Moderate Risk (40-60%) triggers extra SMS reminder
- [ ] Credit card authorization hold placed for high-risk appointments
- [ ] Double-booking works (book 2 patients for same slot)
- [ ] SMS escalation (3 reminders for high-risk patients)
- [ ] No-show triggers waitlist notification
- [ ] A/B test framework operational (can split appointments into test groups)
- [ ] ROI dashboard tracks before/after no-show rates
- [ ] Model retraining script functional

<b>SUCCESS METRICS:</b>
- No-show rate reduction: 40-60% (from 15-20% industry average to 5-8% optimized)
- Revenue saved: $20K-$35K/month ($240K-$420K/year)
- Prediction accuracy: >80% (model correctly identifies 80%+ of no-shows)
- Prepayment conversion: 80%+ of repeat no-showers pay deposit (vs 20% who refuse and don't book)
- Confirmation call success: 90%+ of patients who verbally confirm actually show up
- Double-booking ROI: Recover 70%+ of high-risk slots
- Patient satisfaction: No increase in complaints (interventions feel helpful, not punitive)

<b>HOW TO APPROACH:</b>
1. Collect 6 months historical appointment data
2. Train machine learning model (start with logistic regression, upgrade to XGBoost if needed)
3. Test model accuracy on holdout data (20% of data), iterate until >80% accuracy
4. Deploy model to production (generate risk scores for all appointments)
5. Build manager dashboard (show high-risk appointments with recommended actions)
6. Implement prevention strategies (calls, prepayment, double-booking) for 30 days
7. A/B test interventions (measure effectiveness)
8. Track ROI: "Before AI: 18% no-show rate ($53K/month lost). After AI: 7% no-show rate ($23K/month lost). Saved: $30K/month ($360K/year). Model accuracy: 84%. High-risk appointments reduced from 45/week to 12/week. Patient satisfaction: No complaints, many patients appreciate confirmation calls. Ready to scale!"

Turn no-shows from inevitable losses into preventable revenue - predict, prevent, profit!</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('upsell-automation')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">17</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üí∞ Upsell Automation üî•</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1-2 weeks ‚Ä¢ ROI: Increase avg ticket 30% ‚Üí ~$15K-20K/month ‚Ä¢ üéØ BUILD ORDER: #6</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="upsell-automation" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Build an intelligent upsell system that automatically recommends complementary treatments and packages at checkout. When a patient books Botox, the system should suggest "Add a filler for lip enhancement?" or "Save 20% with our Botox + Facial package." This increases average ticket from $450 to $585 (30% increase) by presenting smart, relevant upsells at the perfect moment - right when the patient is already committing to treatment.

The system needs to show package options during booking and at checkout, with tiered pricing (Good/Better/Best), visual before/after comparisons, and clear savings calculations. Staff should see smart recommendations based on what the patient is already booking, their treatment history, and popular combinations. Make it easy to add recommended treatments with one click.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Package Builder Interface</b>
Create an admin screen where managers can build treatment packages. Each package has a name ("Botox & Glow Package"), included services (Botox + HydraFacial), regular price ($850), package price ($680), and savings (20%). Add ability to upload before/after photos and write package descriptions.

<b>Phase 2: Checkout Upsell Display</b>
When patient books a single treatment, show "Recommended for You" section at checkout with 2-3 relevant packages. Display each package as a card showing what's included, the savings amount, and an "Upgrade to Package" button. If they click it, replace their single treatment with the full package.

<b>Phase 3: Smart Recommendation Logic</b>
Build the system that decides which packages to show. If booking Botox ‚Üí show packages containing Botox. If patient has history of facials ‚Üí prioritize skincare packages. Track which combinations are most popular and recommend those first.

<b>Phase 4: Tiered Package Options (Good/Better/Best)</b>
For each service type, create 3 tiers. Example for anti-aging: Basic ($680 - Botox + Facial), Premium ($1,200 - Botox + Filler + Facial), Ultimate ($1,800 - Botox + Filler + Laser + Facial). Display all 3 so patients can choose their investment level.

<b>Phase 5: Add-On Quick Selections</b>
During booking, show quick add-ons: "Add lip filler? +$550", "Add vitamin C serum? +$85". One-click to add to cart. Make it frictionless to increase ticket size.

<b>Phase 6: Staff Dashboard & Analytics</b>
Show staff their upsell conversion rate, average ticket size, and how much additional revenue they've generated through packages. Gamify it - "You've helped patients save $2,400 this month through packages!"</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('treatment-series')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">18</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìù Treatment Series Tracking</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2 weeks ‚Ä¢ Lock in revenue ‚Ä¢ Better outcomes (6 sessions laser, etc.) ‚Ä¢ üéØ BUILD ORDER: #8</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="treatment-series" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Build a system to track multi-session treatment series like laser hair removal (6-8 sessions), chemical peels (4 sessions), or CoolSculpting (3 sessions). Patients buy the full series upfront, locking in revenue, then we track their progress through each session. The system needs to show which session they're on, when their next appointment should be scheduled, and send automatic reminders if they fall off track.

This prevents revenue leakage (patient completes 3 of 6 sessions and disappears) and ensures better clinical outcomes (laser only works if you complete all sessions on schedule). Staff needs a clear view of all active series, which patients are overdue, and automatic booking suggestions for the next session.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Create Series Templates</b>
Build admin interface to define treatment series templates. Example: "Laser Hair Removal - Full Legs" = 6 sessions, 4-6 weeks apart, $2,400 total. Each template specifies number of sessions, recommended spacing, and total price. Store these as reusable templates.

<b>Phase 2: Sell Series Package at Checkout</b>
When booking laser hair removal, show option: "Book single session ($450)" vs "Buy 6-session series ($2,400 - Save $300)". If they buy the series, create a series record tied to the patient and mark session 1 as scheduled for today's appointment.

<b>Phase 3: Session Progress Tracking</b>
Create a patient chart view showing series progress: "Laser Hair Removal - Session 3 of 6 completed. Next session due: Nov 15-29 (4-6 weeks from last)". Show visual progress bar, which sessions are complete, and when the next one should be scheduled. Color-code: Green = on track, Yellow = due soon, Red = overdue.

<b>Phase 4: Auto-Schedule Next Session</b>
After completing session 3, prompt staff: "Schedule session 4 now? Recommended: Nov 15-29". Pre-populate the booking with correct date range and same practitioner. Make it one-click to book the next session before patient leaves.

<b>Phase 5: Overdue Series Alerts</b>
Create a dashboard widget: "5 patients overdue for series continuation". Show patient name, which session they're stuck on, and how many days overdue. Staff can click to call patient: "Hi Sarah, you're due for laser session 4. Want to get that scheduled?"

<b>Phase 6: Series Completion Tracking</b>
Mark series as "Completed" when all 6 sessions done. Send congratulations message and before/after photo request. Track completion rate: "85% of series patients complete all sessions" - if dropping, investigate why patients are falling off.</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('cross-location')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">19</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìç Cross-Location Scheduling</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2 weeks ‚Ä¢ Fill empty slots at other locations ‚Ä¢ Better convenience ‚Ä¢ üéØ BUILD ORDER: #17</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="cross-location" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Enable patients to book appointments at any of your locations and allow staff to see availability across all locations when scheduling. If Downtown location is fully booked Friday but Uptown has 5 open slots, the system should show "Downtown fully booked. Uptown available Friday 2pm, 3pm, 4pm." This maximizes utilization across locations and gives patients more flexibility.

Patients should be able to choose their preferred location but also see "other locations available sooner" if they're willing to travel. Staff needs a unified calendar showing all locations so they can optimize practitioner schedules and balance patient load across sites.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Multi-Location Calendar View</b>
Add location filter to calendar: dropdown showing "All Locations", "Downtown", "Uptown", "Westside". When viewing "All Locations", show color-coded appointments (blue = Downtown, green = Uptown, purple = Westside). Each appointment shows location tag.

<b>Phase 2: Location Selection During Booking</b>
When patient calls to book, staff sees "Select Location" dropdown first. After selecting location + service + practitioner, show that location's availability. If no availability, show alert: "Downtown fully booked this week. Check other locations?"

<b>Phase 3: Cross-Location Availability Search</b>
Add "Search All Locations" button. When clicked, show availability across all 3 locations side-by-side. Example: "Downtown: Next available Nov 18. Uptown: Available tomorrow 2pm. Westside: Available today 5pm." Patient picks most convenient.

<b>Phase 4: Practitioner Multi-Location Schedules</b>
Some practitioners work multiple locations (Dr. Smith: Mon/Wed Downtown, Tue/Thu Uptown). Calendar shows their schedule with location markers. When booking with Dr. Smith, show which location they're at each day: "Monday 2pm (Downtown)" vs "Tuesday 2pm (Uptown)".

<b>Phase 5: Patient Location Preferences</b>
Track patient's usual location in their profile. When booking, default to their preferred location but always show "Other locations available" option. If they've been to Downtown 8 times, default to Downtown but make it easy to try Uptown.

<b>Phase 6: Location Utilization Dashboard</b>
Show manager which locations are over/under-utilized. "Downtown: 92% booked (excellent). Uptown: 68% booked (promote this location). Westside: 45% booked (need more demand)." Helps balance patient flow and staffing across locations.</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('pre-visit-prep')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">20</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üìã Pre-Visit Preparation Reminders</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 1 week ‚Ä¢ Treatment-specific prep ‚Ä¢ Reduce delays ‚Ä¢ üéØ BUILD ORDER: #5</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="pre-visit-prep" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Send automated, treatment-specific preparation instructions to patients before their appointment. If they're getting laser, text them 24 hours before: "Tomorrow's laser appt: Shave treatment area tonight. Avoid sun exposure. No makeup." If getting Botox: "Avoid blood thinners 24hrs before to minimize bruising." This reduces appointment delays, improves outcomes, and shows patients you're organized and professional.

Each treatment type has different prep requirements. The system needs to automatically detect what treatment they booked and send the right instructions at the right time (24-48 hours before). Include what to do, what to avoid, and what to bring.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Prep Instructions Library</b>
Create admin interface to define prep instructions for each service. Example: "Laser Hair Removal" prep = "Shave treatment area the night before. Avoid sun exposure 2 weeks prior. No makeup, lotion, or deodorant on treatment day. Arrive with clean skin." Store these as templates tied to each service type.

<b>Phase 2: Automatic Prep Reminders</b>
When appointment is booked, automatically schedule a prep reminder SMS for 24 hours before. The SMS pulls the correct prep instructions based on the service type. Example: "Hi Sarah! Your laser hair removal is tomorrow at 2pm. PREP: Shave legs tonight, no sun exposure, arrive with clean skin. See you tomorrow!"

<b>Phase 3: Treatment-Specific Timing</b>
Some treatments need longer prep (chemical peel: avoid retinol 1 week before). Set different reminder timing per service: Botox = 24hrs before, Chemical peel = 1 week before, Laser = 24hrs before. System sends each at the right time.

<b>Phase 4: Multi-Step Prep for Complex Treatments</b>
For treatments needing multiple prep steps, send multiple reminders. Example: Microneedling ‚Üí 7 days before: "Stop retinol", 24 hours before: "Avoid alcohol and blood thinners", 2 hours before: "Arrive with clean face, no makeup". Automated sequence.

<b>Phase 5: Prep Checklist on Patient Portal</b>
When patient logs into portal, show their upcoming appointment with expandable prep checklist. They can check off each item: ‚úì Shaved treatment area, ‚úì Stopped retinol, ‚úì No sun exposure. Helps them track compliance.

<b>Phase 6: Staff Pre-Visit Verification</b>
When patient checks in, show staff quick verification: "Did you shave the treatment area? Yes/No." If No, offer to reschedule: "Laser won't work properly on unshaved skin. Let's reschedule." Prevents wasted appointments and poor outcomes.</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE V: ADVANCED VOICE AI -->
                <div class="roadmap-queue" style="margin-top: 60px;">
                    <h2 class="section-title">üé§ PHASE V: Advanced Voice AI Features</h2>
                    <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Future expansion to maximize AI capabilities throughout the platform.</p>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('voice-intake')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">21</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üé§ Voice Medical Intake</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 3-4 weeks ‚Ä¢ ROI: 2-3x completion rate ‚Ä¢ 10-15 min savings ‚Ä¢ üéØ BUILD ORDER: #22</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="voice-intake" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Build a voice-enabled medical intake system where patients can complete their intake forms by speaking instead of typing. Patient clicks "Start Voice Intake" and answers questions verbally: "What medications are you taking?" ‚Üí Patient speaks: "Metformin 500mg twice daily and Lisinopril 10mg once daily" ‚Üí AI transcribes and auto-fills the medications field. This dramatically increases completion rates (typing on phone is tedious, many abandon) and saves 10-15 minutes per patient.

Voice intake is especially powerful for mobile users and patients with accessibility needs. The system records their voice, transcribes to text using AI, intelligently parses responses to fill structured form fields, and lets them review/edit before submitting. Staff gets a completed intake form without having to ask all the questions manually.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Voice Recording Interface</b>
Add "Voice Intake" option to patient portal. Shows questions one at a time with a microphone button. Patient taps mic, speaks their answer, releases. Visual waveform shows recording is active. Can re-record if they misspoke.

<b>Phase 2: Voice Transcription</b>
Send audio to speech-to-text API (OpenAI Whisper). Display transcribed text in real-time so patient sees what was captured. Show "Is this correct?" with Edit/Confirm buttons. If incorrect, they can type corrections or re-record.

<b>Phase 3: Smart Form Field Mapping</b>
AI parses transcribed response and extracts structured data. Example: Patient says "I'm allergic to penicillin and shellfish" ‚Üí System auto-fills Allergies field with "Penicillin, Shellfish" as separate entries. Shows what it extracted for patient to verify.

<b>Phase 4: Question Flow & Progress</b>
Build conversational flow through intake questions. "Let's start with medications. What medications are you currently taking?" ‚Üí After answer ‚Üí "Great! Now, any allergies?" Progress bar shows "Question 3 of 12". Feels like a conversation, not a form.

<b>Phase 5: Review & Edit Screen</b>
After voice intake complete, show summary of all captured information organized by section. Patient can click any field to edit or re-record just that answer. "Medical History: ‚úì Complete. Medications: ‚úì 2 medications captured. Allergies: ‚ö†Ô∏è Please review."

<b>Phase 6: Hybrid Voice + Text Mode</b>
Let patients mix voice and typing. Some questions easier to type (email, phone), others faster by voice (medical history). Each question shows both microphone and keyboard icons. Patient chooses their preferred input method per question.</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('voice-commands')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">22</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üé§ Quick Voice Commands</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 2-3 weeks ‚Ä¢ "Search patient [name]" ‚Ä¢ "Book appointment" ‚Ä¢ üéØ BUILD ORDER: #21</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="voice-commands" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Add hands-free voice commands throughout the system so staff can navigate without clicking. Front desk has phone in one hand, patient file in the other - they say "Search patient Sarah Johnson" and the system instantly searches. Or during treatment charting on iPad: "Add Botox 40 units forehead" ‚Üí AI adds it to the chart. This saves countless clicks and makes the system faster when multitasking.

Voice commands work across all modules: patient search, appointment booking, calendar navigation, chart updates, inventory checks. Staff clicks the microphone icon (or uses a keyboard shortcut), speaks their command, and the system executes it. Much faster than navigating through multiple screens, especially on mobile/iPad.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Voice Command Button</b>
Add persistent microphone button to navigation bar (top right). Click to activate voice listening. Visual indicator shows "Listening..." with animated waveform. Supports keyboard shortcut (Cmd+K or Ctrl+K) to activate without clicking.

<b>Phase 2: Patient Search Commands</b>
Recognize commands like "Search patient [name]", "Find Sarah Johnson", "Open chart for John Smith". System searches patient database and shows results. If exact match, opens chart directly. If multiple matches, shows list to select from.

<b>Phase 3: Appointment Booking Commands</b>
"Book appointment for Sarah Johnson", "Schedule Botox for next Friday at 2pm", "Show Dr. Smith's calendar". AI extracts patient name, service, date/time and pre-fills booking form. Staff just confirms and saves.

<b>Phase 4: Calendar Navigation Commands</b>
"Show today's schedule", "Go to next Monday", "Show Dr. Smith's appointments", "How many openings tomorrow?". Voice controls calendar view without clicking through date pickers and filters.

<b>Phase 5: Treatment Charting Commands</b>
During iPad charting: "Add Botox 40 units", "Patient reports no pain", "Mark treatment complete". Hands-free chart updates while practitioner treats patient. Especially useful when wearing gloves.

<b>Phase 6: Command Suggestions & Learning</b>
After voice input, show "Did you mean: [interpreted command]?" for confirmation. Track most-used commands per user and show personalized suggestions. "You frequently search patients - try 'Find [name]' for faster access."</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('ai-communication-hub')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">23</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">ü§ñ AI Communication Hub</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 4-6 weeks ‚Ä¢ Unified inbox ‚Ä¢ Auto-triage ‚Ä¢ Smart routing ‚Ä¢ üéØ BUILD ORDER: #9</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="ai-communication-hub" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Build a unified inbox that consolidates all patient communications - SMS, emails, portal messages, voicemails, and missed calls - into one stream. AI automatically categorizes each message (Appointment Request, Question About Treatment, Billing Issue, Emergency, General Inquiry) and routes to the right team member. Front desk sees booking requests, billing team sees payment questions, practitioners see clinical questions.

Stop checking 5 different places for messages. Everything appears in one clean inbox with AI-suggested responses, smart routing, and automatic prioritization. Emergency keywords ("can't breathe", "severe reaction") get flagged immediately. Routine requests get template responses. Staff responds faster and nothing falls through the cracks.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Unified Inbox View</b>
Create inbox screen showing all communications in chronological order. Each message shows: patient name, channel icon (üì± SMS, ‚úâÔ∏è Email, üí¨ Portal, üìû Voicemail), timestamp, preview text, and unread indicator. Filter by channel, patient, or date range.

<b>Phase 2: Message Auto-Categorization</b>
AI reads each incoming message and tags it: "Appointment Request", "Question", "Billing", "Emergency", "Complaint", "Compliment". Color-coded tags make it easy to scan. Red = Emergency, Yellow = Needs Response Today, Green = Informational.

<b>Phase 3: Smart Routing & Assignment</b>
Based on category, auto-assign to team: Appointment Requests ‚Üí Front Desk, Billing Questions ‚Üí Billing Team, Clinical Questions ‚Üí Nurse/Practitioner. Shows in their inbox as "Assigned to You". Manager sees all messages, staff see only their assigned messages.

<b>Phase 4: AI Response Suggestions</b>
For common questions, AI suggests response templates. Patient asks "How much is Botox?" ‚Üí AI suggests: "Botox pricing starts at $12/unit. Most patients need 30-40 units ($360-$480). Want to schedule a free consultation?" Staff can edit or send as-is.

<b>Phase 5: Emergency Detection & Escalation</b>
AI scans for emergency keywords: "can't breathe", "severe swelling", "allergic reaction", "bleeding won't stop". Flags message red, sends instant notification to manager + practitioner, and suggests calling patient immediately.

<b>Phase 6: Communication History & Context</b>
When viewing a message, show sidebar with patient's full communication history: "Last contact: 3 days ago about appointment. Previous: 2 weeks ago asking about pricing." Context helps staff give better, more personalized responses without searching through old messages.</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('ai-before-after')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">24</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üì∏ AI Before/After Analysis & Outcome Tracking</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 3-4 weeks ‚Ä¢ Measure wrinkle reduction ‚Ä¢ Track practitioner performance ‚Ä¢ üéØ BUILD ORDER: #10</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="ai-before-after" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Use AI to analyze before/after photos and quantify treatment outcomes. Upload before photo (day of Botox) and after photo (2 weeks later) ‚Üí AI measures: "Forehead wrinkle depth reduced 68%. Crow's feet improved 54%. Overall skin smoothness increased 41%." This gives objective data to show patients their results, track practitioner performance, and prove treatment effectiveness for marketing.

Stop relying on subjective assessments ("looks better to me"). AI provides consistent, measurable analysis: wrinkle reduction %, skin tone improvement, symmetry changes, volume enhancement. Track each practitioner's average outcomes, identify top performers, and spot practitioners needing more training. Show patients their quantified results to increase satisfaction and rebooking.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Photo Upload & Pairing</b>
In patient chart, add "Before/After Photos" section. Upload "Before" photo tagged with date and treatment. Later, upload "After" photo and link to the same treatment session. Shows paired photos side-by-side with treatment details (Botox 40 units forehead, Dr. Smith, Oct 15).

<b>Phase 2: AI Analysis Engine</b>
When after photo uploaded, run AI analysis comparing before vs after. AI detects: wrinkle depth changes, skin texture, tone, redness, pigmentation, volume, symmetry. Returns numerical scores: "Wrinkle reduction: 68%", "Skin smoothness: +41%", "Redness reduction: 23%".

<b>Phase 3: Results Dashboard for Patients</b>
Create patient-facing results page showing their before/after comparison with AI metrics overlaid. Visual highlighting shows areas of improvement. "Your forehead wrinkles improved 68% after Botox treatment. Crow's feet reduced 54%." Shareable via patient portal or email.

<b>Phase 4: Practitioner Performance Tracking</b>
Manager dashboard shows each practitioner's average outcome scores. "Dr. Smith: 72% avg wrinkle reduction. Dr. Jones: 58% avg." Identifies top performers and practitioners needing additional training. Filter by treatment type to see who excels at Botox vs fillers vs laser.

<b>Phase 5: Treatment Effectiveness Analytics</b>
Track which treatments produce best outcomes. "Botox: 68% avg improvement. Dysport: 71% avg improvement. Laser resurfacing: 84% avg improvement." Helps decide which treatments to promote and which protocols to refine.

<b>Phase 6: Marketing & Social Proof</b>
Auto-generate before/after galleries filtered by treatment type for marketing (with patient consent). Shows real results with AI-verified improvement metrics. "Real patient results: 68% wrinkle reduction in 2 weeks." Much more credible than subjective claims.</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE VI: INNOVATION & DIFFERENTIATORS -->
                <div class="roadmap-queue" style="margin-top: 60px;">
                    <h2 class="section-title">üöÄ PHASE VI: Competitive Differentiators</h2>
                    <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Innovative features to set us apart from all competitors.</p>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('dynamic-pricing')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">25</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üí∞ Dynamic Pricing & Revenue Optimization</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 3-4 weeks ‚Ä¢ Off-peak discounts ‚Ä¢ Last-minute deals ‚Ä¢ Surge pricing ‚Ä¢ üéØ BUILD ORDER: #11</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="dynamic-pricing" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Build a dynamic pricing system that automatically adjusts treatment prices based on demand, time, and availability to maximize revenue. Offer 20% off-peak discounts (Tuesday mornings when calendar is empty) to fill slow times, and surge pricing (+15%) for high-demand slots (Friday evenings). Last-minute deals appear 48 hours before empty appointments: "Botox tomorrow 2pm - $360 (save $90)". This fills otherwise empty slots and captures price-sensitive patients while maximizing revenue during peak times.

The system intelligently balances revenue optimization with patient perception. Never show surge pricing to existing patients (only new prospects), grandfather loyal patients at standard rates, and make discounts feel like exclusive deals rather than desperation. Track which pricing strategies work best and automatically adjust. Airlines and hotels do this brilliantly - medical spas should too.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Pricing Rules Engine</b>
Build admin interface to define pricing rules. "Tuesday-Thursday 9am-12pm: 20% off all services (off-peak)". "Friday 4pm-7pm: Standard pricing (high demand)". "Same-day appointments: 15% off if booked <24 hours before". Each rule has conditions (day, time, service type, patient type) and pricing adjustment (%, $ amount, or fixed price).

<b>Phase 2: Time-Based Dynamic Pricing</b>
When patient books online, show prices adjusted by time slot. "Tuesday 10am: $360 (20% off)". "Friday 5pm: $450 (standard)". Color-code calendar: Green = discounted slots, Yellow = standard, Red = peak pricing. Patient sees savings and is incentivized to book off-peak times.

<b>Phase 3: Demand-Based Pricing</b>
Track historical demand patterns. If Botox consistently sells out on Fridays, automatically increase Friday prices 10-15%. If Tuesdays are always slow, deepen discounts to 25-30%. System learns optimal pricing per day/time/service combination over 3-6 months.

<b>Phase 4: Last-Minute Deal Alerts</b>
48 hours before empty appointments, send "Flash Deal" texts to waitlisted patients: "TOMORROW 2pm - Botox $360 (save $90)! Limited time offer." Only notify patients who opted into promotional messages. Track conversion rate: if >60% claimed, reduce discount next time.

<b>Phase 5: Patient Segmentation & Pricing</b>
VIP patients always see standard pricing (never surge). New patients see promotional pricing to win them over. Price-sensitive patients get targeted discounts. High-value patients never see discounts (avoid devaluing services). Segment pricing by patient tier automatically.

<b>Phase 6: Revenue Optimization Dashboard</b>
Manager dashboard shows: "Revenue increase from dynamic pricing: +$8,400 this month (12%)". Track average ticket by time slot, discount redemption rate, peak vs off-peak utilization. A/B test different discount levels: "20% off Tuesday" vs "25% off Tuesday" - which fills more slots?</pre>
                            </div>
                        </div>
                    </div>

                    <div class="queue-item" style="cursor: pointer; flex-direction: column; align-items: stretch;" onclick="toggleSection('practitioner-marketplace')">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div class="priority-number">26</div>
                                <div class="queue-item-content">
                                    <div class="queue-item-title">üè™ Practitioner Marketplace</div>
                                    <div class="queue-item-meta">‚è±Ô∏è 8-12 weeks ‚Ä¢ Independent practitioners rent time ‚Ä¢ Revenue sharing ‚Ä¢ üéØ BUILD ORDER: #12 (Most Complex)</div>
                                </div>
                            </div>
                            <div class="status-badge status-not-started">üî¥ Not Started</div>
                        </div>

                        <div id="practitioner-marketplace" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                            <div class="detail-card" style="background: #fff3cd; border-left: 5px solid #ffc107; margin-bottom: 20px;">
                                <h4 style="color: #f57c00;">üìã COPY THIS PROMPT TO CLAUDE CODE:</h4>
                                <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; font-size: 0.95em; line-height: 1.6;">Create a marketplace platform where independent practitioners can rent chair/room time at your spa and bring their own clients. Practitioner pays 30-40% of revenue to spa (covers space, equipment, front desk, billing), keeps 60-70% for themselves. They get access to your booking system, treatment rooms, equipment, and administrative support without the overhead of running their own practice. You get revenue from otherwise unused capacity and attract new patients through their client base.

This transforms empty treatment rooms into revenue generators. If Dr. Smith only works Mon-Wed, rent Thu-Fri to an independent injector who brings 15 clients/week. Spa makes $2,700/week (40% of $6,750 revenue) from capacity that was previously $0. Practitioners get premium space and systems without startup costs. Win-win marketplace model like Airbnb for medical spas.

<b>IMPLEMENTATION PHASES:</b>

<b>Phase 1: Practitioner Profile & Onboarding</b>
Create "Marketplace Practitioner" account type separate from employees. During signup, practitioner enters: credentials (medical license #, certifications), services offered, availability (which days/times they want), revenue split agreement (typically 60/40 or 70/30), and booking preferences. Admin approves before they go live.

<b>Phase 2: Availability & Room Booking</b>
Practitioner sets their available hours: "Thursdays 10am-6pm, Fridays 9am-5pm". System blocks those times in their calendar. They can book their own clients into these slots. Spa calendar shows "Room 2: Dr. Williams (Marketplace) - 2pm Botox". Prevents double-booking of treatment rooms.

<b>Phase 3: Client Management & Isolation</b>
Marketplace practitioner's clients are tagged as "Dr. Williams' clients" (not spa's general patient pool). Practitioner can only see/book their own clients. Cannot access spa's existing patient database. This protects spa's patient relationships while letting practitioner manage theirs.

<b>Phase 4: Automated Revenue Splitting</b>
When marketplace practitioner's patient checks out, system automatically splits payment: 60% to practitioner account, 40% to spa. Monthly statement shows: "Dr. Williams - October: $18,500 total revenue. Your share: $11,100 (60%). Spa share: $7,400 (40%)." Automated payout or monthly invoice.

<b>Phase 5: Marketplace Dashboard & Performance</b>
Practitioner sees their performance: "October: 45 patients, $18,500 revenue, $11,100 your share". Spa owner sees all marketplace practitioners: "Dr. Williams: $7,400/mo, Dr. Chen: $5,200/mo. Total marketplace revenue: $12,600/mo from unused capacity." Track utilization and ROI.

<b>Phase 6: Public Marketplace Listing (Optional)</b>
Create "Rent Space at Our Spa" page where independent practitioners can apply. Shows available time slots, revenue split terms, amenities (laser equipment, Botox fridge, front desk support). Attracts qualified practitioners to fill remaining unused capacity. Vetting process before approval.</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Summary & Timeline -->
                <div style="margin-top: 60px; background: linear-gradient(135deg, #667eea15, #764ba215); padding: 40px; border-radius: 15px;">
                    <h2 style="color: #667eea; margin-bottom: 20px;">üìä TOTAL ROADMAP SUMMARY</h2>

                    <div class="detail-grid">
                        <div class="detail-card">
                            <h4>Feature Count by Status</h4>
                            <ul class="benefits-list">
                                <li><strong>‚úÖ COMPLETE:</strong> ~40-50 core features built</li>
                                <li><strong>üü° IN PROGRESS:</strong> Virtual Waiting Room (60%)</li>
                                <li><strong>üîµ NEEDS REVIEW:</strong> ~60-70 existing features</li>
                                <li><strong>üî¥ NOT STARTED - High Priority:</strong> 6 features (Phase II-III)</li>
                                <li><strong>üî¥ NOT STARTED - Medium Priority:</strong> 10 features (Phase IV-V)</li>
                                <li><strong>üî¥ NOT STARTED - Advanced:</strong> 6 features (Phase VI)</li>
                            </ul>
                        </div>

                        <div class="detail-card">
                            <h4>Estimated Timeline</h4>
                            <ul class="benefits-list">
                                <li><strong>Phase I (Current):</strong> 2-3 weeks</li>
                                <li><strong>Phase II (Voice AI):</strong> 4-6 weeks</li>
                                <li><strong>Phase III (Competitive Gaps):</strong> 6-8 weeks</li>
                                <li><strong>Phase IV (Review & Optimize):</strong> 8-10 weeks</li>
                                <li><strong>Phase V (Automation):</strong> 6-8 weeks</li>
                                <li><strong>Phase VI (Advanced AI):</strong> 6-8 weeks</li>
                                <li><strong>Phase VII (Innovation):</strong> 12-16 weeks</li>
                            </ul>
                            <p style="margin-top: 15px; color: #667eea; font-weight: bold;">TOTAL: 44-59 weeks (~10-14 months)</p>
                        </div>
                    </div>

                    <div style="margin-top: 30px; padding: 20px; background: white; border-radius: 10px; border-left: 5px solid #28a745;">
                        <h4 style="color: #28a745; margin-bottom: 10px;">üí° Recommendations</h4>
                        <p><strong>This Week:</strong></p>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Complete Virtual Waiting Room (60% ‚Üí 100%)</li>
                            <li>Start SMS Reply Suggestions (High ROI)</li>
                            <li>Document all edge cases for existing features</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>Weekly Cadence:</strong> Review Monday (last week's progress), Update Friday (roadmap status)</p>
                        <p style="margin-top: 15px;"><strong>Track Metrics:</strong> Time savings, revenue impact, patient satisfaction, competitive position</p>
                    </div>
                </div>

                <div class="note" style="margin-top: 40px;">
                    <strong>üí° How This Works:</strong> Click "View Full Specs" on any item to see requirements, edge cases, and technical details. Check off items as you complete them. When done, mark as complete and the next feature auto-promotes to "Currently Building."
                </div>
            </div>
        </div>

        <!-- OVERVIEW TAB -->
        <div class="tab-content" id="overview">
            <div class="section">
                <h2 class="section-title">System Architecture Overview</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 20px;">
                    Luxe Medical Spa EMR is a multi-application ecosystem with separate interfaces for different user types and workflows. Each application communicates through a central database and messaging system.
                </p>
                <div class="note" style="background: #fff8e1; border-color: #ff9800;">
                    <strong style="color: #ff9800;">‚ö†Ô∏è Realistic Approach:</strong> This document shows both IDEAL workflows (how things should work) and REAL-WORLD edge cases (what actually goes wrong). Each major workflow includes a collapsible "Reality Check" section with common problems, fallback solutions, and when human intervention is needed. <strong>Click the orange "Reality Check" sections to expand edge cases.</strong>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                        <span>Application/Interface</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                        <span>User Type</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #f8f9fa; border-color: #28a745;"></div>
                        <span>Action/Process</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #fff3cd; border: 2px dashed #ffc107;"></div>
                        <span>Automated Process</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #ffe5e5; border: 2px dashed #ff6b6b;"></div>
                        <span>Edge Case/Problem</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #fff8e1; border: 2px solid #ff9800;"></div>
                        <span>Fallback/Recovery</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #ffe0e0; border: 2px dashed #dc3545;"></div>
                        <span>Gap/Opportunity</span>
                    </div>
                </div>

                <h3 class="section-subtitle">Core Applications</h3>
                <div class="app-grid">
                    <div class="app-card">
                        <h3>üñ•Ô∏è Admin Dashboard</h3>
                        <p style="margin-bottom: 15px; color: #666;">Main desktop application for front desk and management</p>
                        <ul>
                            <li>Calendar & Scheduling</li>
                            <li>Patient Management</li>
                            <li>Billing & Checkout</li>
                            <li>Reports & Analytics</li>
                            <li>Staff Management</li>
                            <li>Inventory</li>
                            <li>Settings</li>
                        </ul>
                    </div>

                    <div class="app-card">
                        <h3>üì± Treatment Room iPad</h3>
                        <p style="margin-bottom: 15px; color: #666;">Practitioner charting app used during treatment</p>
                        <ul>
                            <li>Today's Appointments</li>
                            <li>Quick Charting (SOAP)</li>
                            <li>Before/After Photos</li>
                            <li>Treatment Templates</li>
                            <li>Consent Forms</li>
                            <li>Product Usage Tracking</li>
                            <li>Mark Complete</li>
                        </ul>
                    </div>

                    <div class="app-card">
                        <h3>üåê Patient Portal</h3>
                        <p style="margin-bottom: 15px; color: #666;">Public-facing website for patients</p>
                        <ul>
                            <li>Online Booking</li>
                            <li>View Appointments</li>
                            <li>Medical History Forms</li>
                            <li>Treatment History</li>
                            <li>Before/After Gallery</li>
                            <li>Payment & Invoices</li>
                            <li>Membership Management</li>
                        </ul>
                    </div>

                    <div class="app-card">
                        <h3>üìû Check-In Kiosk</h3>
                        <p style="margin-bottom: 15px; color: #666;">Tablet at front desk or mobile check-in</p>
                        <ul>
                            <li>Patient Check-In</li>
                            <li>Virtual Waiting Room</li>
                            <li>Forms Completion</li>
                            <li>Payment on File Update</li>
                            <li>COVID Screening</li>
                            <li>Consent Signatures</li>
                        </ul>
                    </div>

                    <div class="app-card">
                        <h3>üí¨ SMS/Messaging System</h3>
                        <p style="margin-bottom: 15px; color: #666;">Two-way patient communication via Twilio</p>
                        <ul>
                            <li>Appointment Reminders</li>
                            <li>Confirmations</li>
                            <li>Virtual Waiting Room</li>
                            <li>Post-Treatment Follow-Up</li>
                            <li>Marketing Campaigns</li>
                            <li>Two-Way Conversations</li>
                            <li>AI-Powered Responses</li>
                        </ul>
                    </div>

                    <div class="app-card">
                        <h3>üìä Staff Mobile App</h3>
                        <p style="margin-bottom: 15px; color: #666;">Mobile app for staff on-the-go</p>
                        <ul>
                            <li>View Schedule</li>
                            <li>Block Off Time</li>
                            <li>View Patient Info</li>
                            <li>Complete Charting</li>
                            <li>Notifications</li>
                            <li>Commissions View</li>
                        </ul>
                    </div>
                </div>

                <div class="note">
                    <strong>Key Insight:</strong> Each app serves a specific purpose but they all connect to the same central database. Changes in one app instantly reflect in all others. This separation allows for optimized UX for each user type while maintaining data consistency.
                </div>
            </div>
        </div>

        <!-- APPS TAB -->
        <div class="tab-content" id="apps">
            <div class="section">
                <h2 class="section-title">Detailed App Breakdown</h2>

                <div class="journey">
                    <h3 style="margin-bottom: 20px;">1. Admin Dashboard (Main Desktop App)</h3>

                    <div class="section-subtitle">Dashboard Page</div>
                    <div class="workflow-row" style="margin: 20px 0;">
                        <div class="box action">
                            <div class="box-title">Today's Stats</div>
                            <div class="box-subtitle">Revenue, Appointments, No-shows</div>
                        </div>
                        <div class="box action">
                            <div class="box-title">Quick Actions</div>
                            <div class="box-subtitle">New Appointment, Walk-in, Messages</div>
                        </div>
                        <div class="box action">
                            <div class="box-title">Alerts</div>
                            <div class="box-subtitle">Late arrivals, Urgent messages</div>
                        </div>
                    </div>

                    <div class="section-subtitle">Calendar Page</div>
                    <div class="workflow-row" style="margin: 20px 0;">
                        <div class="box action">
                            <div class="box-title">Multi-Practitioner View</div>
                            <div class="box-subtitle">Day/Week/Month views</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Click to Book</div>
                            <div class="box-subtitle">Patient search, Service select</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Auto-Confirm SMS</div>
                            <div class="box-subtitle">Instant notification</div>
                        </div>
                    </div>

                    <div class="section-subtitle">Patients Page</div>
                    <div class="workflow-row" style="margin: 20px 0;">
                        <div class="box action">
                            <div class="box-title">Patient List</div>
                            <div class="box-subtitle">Search, Filter, Tags</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Patient Profile</div>
                            <div class="box-subtitle">History, Charts, Photos, Notes</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Quick Actions</div>
                            <div class="box-subtitle">Book, Message, Create Invoice</div>
                        </div>
                    </div>

                    <div class="section-subtitle">Billing Page</div>
                    <div class="workflow-row" style="margin: 20px 0;">
                        <div class="box action">
                            <div class="box-title">Create Invoice</div>
                            <div class="box-subtitle">Services + Products</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Payment Processing</div>
                            <div class="box-subtitle">Card, Cash, Package</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Receipt SMS/Email</div>
                            <div class="box-subtitle">Auto-send receipt</div>
                        </div>
                    </div>
                </div>

                <div class="journey">
                    <h3 style="margin-bottom: 20px;">2. Treatment Room iPad App</h3>

                    <div class="workflow-container">
                        <div class="workflow-row">
                            <div class="box app">
                                <div class="box-title">üîê Login</div>
                                <div class="box-subtitle">Practitioner PIN or Face ID</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">Today's Schedule</div>
                                <div class="box-subtitle">List of appointments</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">Select Patient</div>
                                <div class="box-subtitle">View chart history</div>
                            </div>
                        </div>

                        <div class="workflow-row" style="margin-top: 20px;">
                            <div class="box action">
                                <div class="box-title">üìã SOAP Notes</div>
                                <div class="box-subtitle">Subjective, Objective, Assessment, Plan</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">üì∏ Photos</div>
                                <div class="box-subtitle">Before/After with markup tools</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">‚úçÔ∏è Consent</div>
                                <div class="box-subtitle">Digital signature capture</div>
                            </div>
                        </div>

                        <div class="workflow-row" style="margin-top: 20px;">
                            <div class="box action">
                                <div class="box-title">üíâ Products Used</div>
                                <div class="box-subtitle">Auto-deduct from inventory</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">‚úÖ Mark Complete</div>
                                <div class="box-subtitle">Timestamp + Signature</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box automation">
                                <div class="box-title">Notify Front Desk</div>
                                <div class="box-subtitle">Patient ready for checkout</div>
                            </div>
                        </div>
                    </div>

                    <div class="note">
                        <strong>Why separate iPad app?</strong> Practitioners need a focused, distraction-free interface optimized for touch input during treatment. They shouldn't access billing, scheduling, or other admin features from the treatment room.
                    </div>
                </div>

                <div class="journey">
                    <h3 style="margin-bottom: 20px;">3. Patient Portal (Public Website)</h3>

                    <div class="workflow-container">
                        <div class="workflow-row">
                            <div class="box app">
                                <div class="box-title">üåê Homepage</div>
                                <div class="box-subtitle">Services, About, Book Now CTA</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">Create Account</div>
                                <div class="box-subtitle">Email + Password or Social Login</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">Medical History Forms</div>
                                <div class="box-subtitle">HIPAA-compliant intake</div>
                            </div>
                        </div>

                        <div class="workflow-row" style="margin-top: 20px;">
                            <div class="box action">
                                <div class="box-title">Online Booking</div>
                                <div class="box-subtitle">Service ‚Üí Date ‚Üí Time ‚Üí Confirm</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box automation">
                                <div class="box-title">Auto-Confirmation</div>
                                <div class="box-subtitle">SMS + Email instantly</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box database">
                                <div class="box-title">Synced to Calendar</div>
                                <div class="box-subtitle">Appears in admin dashboard</div>
                            </div>
                        </div>

                        <div class="workflow-row" style="margin-top: 20px;">
                            <div class="box action">
                                <div class="box-title">My Account</div>
                                <div class="box-subtitle">Appointments, History, Membership</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">View Invoices</div>
                                <div class="box-subtitle">Pay online, Download receipts</div>
                            </div>
                            <span class="arrow">‚Üí</span>
                            <div class="box action">
                                <div class="box-title">Before/After Gallery</div>
                                <div class="box-subtitle">Private photo access</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PATIENT JOURNEY TAB -->
        <div class="tab-content" id="patient-journey">
            <div class="section">
                <h2 class="section-title">Complete Patient Journey: First Contact ‚Üí Follow-Up</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    This is the end-to-end experience from a patient's first interaction with Luxe through post-treatment care.
                </p>

                <div class="journey">
                    <div class="journey-step">
                        <div class="journey-number">1</div>
                        <div class="journey-content">
                            <h4>Discovery & Research</h4>
                            <p><strong>Patient Actions:</strong> Finds Luxe via Google, Instagram, referral, or Facebook ads. Browses website, reads reviews, looks at before/after photos.</p>
                            <p><strong>Touchpoints:</strong> Website, Social Media, Google My Business, Review sites</p>
                            <div class="journey-automation">
                                <strong>Automation Opportunity:</strong> Retargeting ads for website visitors, chatbot on website answering common questions
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">2</div>
                        <div class="journey-content">
                            <h4>Booking (Multiple Paths)</h4>
                            <p><strong>Path A - Online Booking:</strong> Patient books via website ‚Üí Auto-confirmation SMS sent ‚Üí Appears in admin calendar instantly</p>
                            <p><strong>Path B - Phone Call:</strong> Front desk answers ‚Üí Searches patient in system ‚Üí Books appointment ‚Üí Manual confirmation SMS sent</p>
                            <p><strong>Path C - Text Message:</strong> Patient texts "I want to book Botox" ‚Üí AI routes to front desk ‚Üí Staff books ‚Üí Confirmation sent</p>
                            <p><strong>Path D - Walk-In:</strong> Patient walks in ‚Üí Front desk checks availability ‚Üí Books on the spot</p>
                            <div class="journey-automation">
                                <strong>All paths trigger:</strong> Confirmation SMS, Email with appointment details, Add to Google Calendar link, Pre-visit instructions
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">3</div>
                        <div class="journey-content">
                            <h4>Pre-Appointment Communications</h4>
                            <p><strong>T-48 hours:</strong> Reminder SMS with prep instructions (avoid alcohol, blood thinners, arrive makeup-free)</p>
                            <p><strong>T-24 hours:</strong> Reminder SMS + Link to complete medical forms if not done</p>
                            <p><strong>T-2 hours:</strong> Final reminder SMS with address and parking instructions</p>
                            <div class="journey-automation">
                                <strong>Fully automated:</strong> All reminders sent automatically based on appointment time. Patient can reply C to confirm, R to reschedule.
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">4</div>
                        <div class="journey-content">
                            <h4>Arrival & Check-In</h4>
                            <p><strong>Option 1 - Virtual Waiting Room:</strong> Patient texts "HERE" when they arrive ‚Üí Front desk sees notification ‚Üí Patient waits in car</p>
                            <p><strong>Option 2 - Physical Check-In:</strong> Patient walks in ‚Üí Checks in at kiosk or front desk ‚Üí Status updated to "Arrived"</p>
                            <p><strong>Option 3 - Self-Service Kiosk:</strong> Patient enters phone number ‚Üí Confirms identity ‚Üí Completes any remaining forms ‚Üí Seated in waiting area</p>
                            <div class="journey-automation">
                                <strong>Triggers:</strong> Practitioner notification that patient arrived, Waiting room queue updated, COVID screening if required
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">5</div>
                        <div class="journey-content">
                            <h4>Waiting Room</h4>
                            <p><strong>Physical Waiting:</strong> Patient sits in waiting area. Reception monitors queue on dashboard. Can see wait times.</p>
                            <p><strong>Virtual Waiting:</strong> Patient waits in car. When room is ready, front desk clicks "Call Patient" ‚Üí Auto SMS sent: "Your room is ready!"</p>
                            <p><strong>Staff View:</strong> Waiting room dashboard shows all patients, arrival times, priority (VIP/Urgent), estimated wait.</p>
                            <div class="journey-automation">
                                <strong>Smart features:</strong> Auto-prioritization by appointment time and VIP status, Predicted wait times based on previous treatment durations
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">6</div>
                        <div class="journey-content">
                            <h4>Pre-Treatment Consultation</h4>
                            <p><strong>Practitioner Actions:</strong> Reviews patient chart on iPad, Reviews medical history and previous treatments, Discusses today's treatment plan, Takes before photos</p>
                            <p><strong>Patient Actions:</strong> Asks questions, Reviews and signs consent form on iPad, Agrees to treatment plan and pricing</p>
                            <div class="journey-automation">
                                <strong>Pre-populated data:</strong> Patient medical history, allergies, previous treatments, before photos from past visits all auto-loaded
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">7</div>
                        <div class="journey-content">
                            <h4>Treatment</h4>
                            <p><strong>During treatment:</strong> Practitioner updates SOAP notes on iPad in real-time, Documents products used (Botox units, filler syringes), Takes during/after photos, Marks areas treated with annotation tools</p>
                            <p><strong>System Actions:</strong> Auto-deducts inventory for products used, Calculates practitioner commission, Tracks treatment duration for scheduling analytics</p>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">8</div>
                        <div class="journey-content">
                            <h4>Treatment Completion</h4>
                            <p><strong>Practitioner:</strong> Clicks "Mark Complete" on iPad ‚Üí Signs digitally ‚Üí Provides aftercare instructions verbally</p>
                            <div class="journey-automation">
                                <strong>Automatic triggers:</strong> Notification to front desk (patient ready for checkout), Aftercare SMS sent with written instructions, Chart auto-saved and locked, Products auto-billed to invoice
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">9</div>
                        <div class="journey-content">
                            <h4>Checkout & Payment</h4>
                            <p><strong>Front Desk:</strong> Reviews auto-generated invoice (services + products), Processes payment (card/cash/membership credits), Books next appointment if applicable, Schedules future treatments if on a series</p>
                            <p><strong>Patient:</strong> Pays, Receives printed receipt, Books follow-up appointment, Leaves</p>
                            <div class="journey-automation">
                                <strong>Instant actions:</strong> Receipt SMS/Email sent, Payment logged in accounting, Membership credits deducted if applicable, Next appointment confirmation SMS
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">10</div>
                        <div class="journey-content">
                            <h4>Post-Treatment Follow-Up (Automated Sequence)</h4>
                            <p><strong>T+1 hour:</strong> Aftercare SMS with instructions (ice, avoid exercise, etc.)</p>
                            <p><strong>T+24 hours:</strong> "How are you feeling?" check-in SMS. Patient can reply with concerns.</p>
                            <p><strong>T+3 days:</strong> "Initial results should be visible" SMS. Ask if any questions.</p>
                            <p><strong>T+2 weeks:</strong> "Results at peak!" SMS. Request before/after photos for marketing (with consent). Suggest booking next treatment.</p>
                            <p><strong>T+1 month:</strong> Review request SMS with link to Google/Yelp. Offer 10% off next treatment for leaving review.</p>
                            <div class="journey-automation">
                                <strong>AI-powered:</strong> All messages personalized by treatment type. Patient replies analyzed by AI for urgency. High-priority responses flagged for staff immediately.
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">11</div>
                        <div class="journey-content">
                            <h4>Re-Engagement (Ongoing)</h4>
                            <p><strong>Birthday:</strong> Auto SMS with 20% off offer</p>
                            <p><strong>Membership credits expiring:</strong> Alert SMS to use credits before they expire</p>
                            <p><strong>Win-back:</strong> After 3 months of no activity, "We miss you" campaign with special offer</p>
                            <p><strong>Seasonal promotions:</strong> Summer skin prep, Holiday party specials, etc.</p>
                        </div>
                    </div>
                </div>

                <div class="note">
                    <strong>Key Insight:</strong> The patient journey has 10+ automation touchpoints. Every booking, completion, and follow-up triggers automated actions that would otherwise require manual work. This is what makes modern med spa EMRs powerful.
                </div>

                <div class="edge-cases-container">
                    <div class="edge-cases-header collapsed">
                        ‚ö†Ô∏è REALITY CHECK: What Can Go Wrong in Patient Journey? (Click to expand)
                    </div>
                    <div class="edge-cases-content">
                        <div class="edge-case-item">
                            <h5>üî¥ Patient Texts "HERE" But No Appointment Found <span class="reality-badge common">Happens daily</span></h5>
                            <p class="problem">Problem: Patient texts "HERE" from parking lot. System searches for today's appointments with their phone number. Nothing found. Patient confused and frustrated.</p>
                            <p class="solution">Auto-reply: "We couldn't find an appointment for today under this number. Please call us at (555) 100-0000 or come inside." Possible reasons system checks: (1) Wrong date (appointment is tomorrow), (2) Different phone number on file, (3) Appointment was cancelled, (4) Patient at wrong location. Create alert for front desk with patient's phone number for manual lookup.</p>
                            <p class="human-needed">Front desk searches patient by name/partial phone. Common scenario: Patient changed phone numbers. Update in system and manually check them in. If no appointment exists, determine if they need to be booked.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Texts "HERE" 45 Minutes Early <span class="reality-badge common">3-4x per week</span></h5>
                            <p class="problem">Problem: Appointment is at 2:00 PM. Patient texts "HERE" at 1:15 PM. Practitioner not ready, previous patient still in treatment.</p>
                            <p class="solution">System detects: Patient arrived >30 mins early. Auto-reply: "Thanks for letting us know! You're a bit early for your 2:00 PM appointment. We'll text you when your room is ready. Estimated wait: 30-45 mins. You're welcome to wait inside where it's comfortable!" Add to queue with note: "EARLY ARRIVAL"</p>
                            <p class="human-needed">Front desk monitors early arrivals. If practitioner running ahead, may bring patient in early. Otherwise, keep them comfortable in car or lobby. Update wait time estimate if delays occur.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Doesn't Speak English <span class="reality-badge">Language barrier</span></h5>
                            <p class="problem">Problem: Patient texts "AQU√ç" (Spanish for "here") or doesn't understand English SMS instructions.</p>
                            <p class="solution">System should detect: Non-English text ‚Üí Try to identify language ‚Üí Send bilingual response: "Gracias! Te enviaremos un texto cuando tu sala est√© lista. / Thanks! We'll text you when your room is ready." Or: Flag for front desk: "Patient may need Spanish-speaking staff." Front desk can switch patient's language preference for future messages.</p>
                            <p class="human-needed">Front desk identifies Spanish-speaking staff member to assist. Updates patient profile: "Primary Language: Spanish" so all future communications are bilingual. Uses Google Translate or bilingual staff for check-in.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient's Phone Dies While Waiting <span class="reality-badge common">Battery/tech issues</span></h5>
                            <p class="problem">Problem: Patient checks in via SMS, waits in car. Front desk sends "Room ready!" SMS but patient's phone is dead. Patient doesn't receive message. 15 minutes pass, room empty, patient still waiting.</p>
                            <p class="solution">System tracks: "Room ready" SMS sent but not delivered (phone off/no signal). After 5 mins of no response, auto-escalate to phone call. If no answer, flag on dashboard: "PATIENT NOT RESPONDING - May need to find in parking lot." After 10 mins, consider patient a no-show and move to next patient.</p>
                            <p class="human-needed">Front desk staff physically goes to parking lot to find patient's car (system stored car description if collected). Or tries calling from different number. If can't locate after 15 mins, mark no-show and offer reschedule.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Waits in Car During Extreme Weather <span class="reality-badge">Seasonal issue</span></h5>
                            <p class="problem">Problem: It's 95¬∞F outside or below freezing. Patient checks in to virtual waiting room from car. Unsafe to wait in car for 20+ minutes.</p>
                            <p class="solution">System should be weather-aware. In extreme temps (>90¬∞F or <32¬∞F): Auto-message includes: "It's very hot/cold today! You're welcome to wait in our comfortable lobby instead of your car." Front desk dashboard highlights: "Weather Alert - Encourage lobby waiting." Track if patient chooses car vs lobby.</p>
                            <p class="human-needed">Front desk calls patients who checked in via SMS during extreme weather: "Hi Sarah, just making sure you know you can wait inside where it's air conditioned!" Prioritize these patients to minimize outdoor wait time.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Two Patients Named "Sarah" Both Checked In <span class="reality-badge">Name collision</span></h5>
                            <p class="problem">Problem: Sarah Johnson (2:00 PM) and Sarah Williams (2:15 PM) both in queue. Front desk clicks "Call Patient" for first Sarah. Which Sarah gets the text?</p>
                            <p class="solution">System uses FULL NAME + APPOINTMENT TIME in all communications. "Room ready SMS" says: "Hi Sarah Johnson, your room is ready for your 2:00 PM Botox appointment!" Front desk dashboard shows: "Sarah J. (2:00 - Botox)" and "Sarah W. (2:15 - Filler)" clearly separated. When calling patient, confirmation required: "Calling Sarah Johnson - 2:00 PM - Botox. Confirm: [YES] [NO]"</p>
                            <p class="human-needed">Front desk trained to verify: "Sarah Johnson for 2 o'clock?" when calling patients. If wrong Sarah comes back, apologize and bring correct patient.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Never Received Reminder SMS (Carrier Blocked) <span class="reality-badge">Technical issue</span></h5>
                            <p class="problem">Problem: System sends reminders at T-48hrs, T-24hrs, T-2hrs. All marked "Delivered" but patient never got them. Carrier spam filter blocked medical spa texts. Patient shows up confused: "I never got any reminders!"</p>
                            <p class="solution">Track SMS delivery status: "Sent" vs "Delivered" vs "Read". If pattern of un-delivered messages to same carrier (e.g., T-Mobile), alert IT. Use shortcode or verified sender ID to avoid spam filters. Fallback to email if SMS consistently fails. Backup: Front desk calls unconfirmed appointments 24hrs before.</p>
                            <p class="human-needed">IT works with Twilio to resolve deliverability issues. Front desk manually calls patients who haven't confirmed to verify they're coming. Consider switching SMS providers if delivery rate <95%.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Shows Up for Wrong Appointment Time <span class="reality-badge common">Memory/confusion</span></h5>
                            <p class="problem">Problem: Patient's appointment is Friday 2:00 PM. They show up Thursday 2:00 PM. Or show up at 2:00 PM when appointment is 4:00 PM.</p>
                            <p class="solution">When patient checks in (any method), system confirms: "Checking you in for your 2:00 PM appointment on Friday, September 15. Correct? [YES] [NO]". If patient clicks NO or arrives on wrong day, system detects mismatch and alerts front desk: "Sarah checked in but appointment is tomorrow!" Auto-message: "We see your appointment is scheduled for tomorrow. Would you like to reschedule for today if available?"</p>
                            <p class="human-needed">Front desk checks practitioner availability. If slot available today, offer to switch. If no availability, apologize and confirm tomorrow's appointment. Update patient with correct date/time via SMS immediately.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Replies Angrily to Automated SMS <span class="reality-badge common">Customer service issue</span></h5>
                            <p class="problem">Problem: Patient receives reminder SMS, replies: "STOP TEXTING ME I ALREADY CANCELLED THIS APPOINTMENT YOU PEOPLE ARE INCOMPETENT." System doesn't know how to handle angry messages.</p>
                            <p class="solution">AI analyzes sentiment: Detects negative emotion + "cancelled" keyword. Auto-creates URGENT task for manager: "Angry patient response detected - needs immediate attention." Auto-reply: "We sincerely apologize for the confusion. A manager will call you within 30 minutes to resolve this." Remove from all automated message sequences immediately. Flag account: "SENSITIVE - Manager approval required for future communications."</p>
                            <p class="human-needed">Manager calls patient within 30 mins to apologize and resolve issue. Often scenarios: (1) Appointment was cancelled in system but SMS already queued, (2) Patient confused with different practice, (3) Legitimate complaint about over-messaging. Manager documents resolution and adjusts messaging frequency if needed.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Has Medical Emergency at Home After Treatment <span class="reality-badge rare">Critical situation</span></h5>
                            <p class="problem">Problem: Patient had Botox at 2 PM, now it's 8 PM. They reply to aftercare SMS: "My face is very swollen and I can't breathe well, should I go to ER?"</p>
                            <p class="solution">AI detects MEDICAL EMERGENCY keywords: "can't breathe", "severe reaction", "swelling", "allergic". Auto-escalate to URGENT: (1) Immediate push notification to on-call practitioner's phone, (2) Auto-reply: "This may be a medical emergency. If you're having trouble breathing, CALL 911 immediately. We've alerted your practitioner who will call you within 5 minutes." (3) Log incident with timestamp for legal/medical records.</p>
                            <p class="human-needed">On-call practitioner calls patient immediately (within 5 mins). Assesses severity over phone. Advises: Go to ER, take Benadryl and monitor, or come to clinic immediately. Practitioner documents all advice given. Manager follows up next day and files incident report. Contact patient's emergency contact if can't reach patient directly.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient at Wrong Location (Multi-Location Practice) <span class="reality-badge">Multi-location issue</span></h5>
                            <p class="problem">Problem: Patient's appointment is at Downtown location. They drive to Westside location and text "HERE" from that parking lot.</p>
                            <p class="solution">System GPS-detects: Patient checked in from address that doesn't match appointment location. Auto-reply: "‚ö†Ô∏è Your appointment is at our DOWNTOWN location (123 Main St), but it looks like you might be at Westside. Please call us immediately: (555) 100-0000. Here's directions to Downtown: [Google Maps link]" Alert both locations' front desks.</p>
                            <p class="human-needed">Front desk at Downtown location calls patient immediately. Options: (1) Patient drives to correct location (if time allows), (2) Cancel and reschedule, (3) See if Westside location can accommodate (call to check availability). Apologize and offer transportation compensation if it's clinic's fault (e.g., confirmation SMS had wrong address).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOOKING FLOWS TAB -->
        <div class="tab-content" id="booking">
            <div class="section">
                <h2 class="section-title">All Appointment Booking Flows</h2>

                <h3 class="section-subtitle">Flow 1: Online Booking (Patient Portal)</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box user">
                            <div class="box-title">Patient</div>
                            <div class="box-subtitle">On website</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Click "Book Now"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Select Service</div>
                            <div class="box-subtitle">Botox, Filler, Laser, etc.</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Select Practitioner</div>
                            <div class="box-subtitle">Or "First Available"</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box action">
                            <div class="box-title">Choose Date</div>
                            <div class="box-subtitle">Calendar with availability</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Choose Time</div>
                            <div class="box-subtitle">Available slots shown</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Enter Info</div>
                            <div class="box-subtitle">Name, email, phone</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Confirm Booking</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box automation">
                            <div class="box-title">Save to Database</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Send Confirmation SMS</div>
                            <div class="box-subtitle">"Your Botox appointment with Dr. Smith is confirmed for Jan 15 at 2pm"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Send Confirmation Email</div>
                            <div class="box-subtitle">With calendar attachment</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box automation">
                            <div class="box-title">Appear in Admin Calendar</div>
                            <div class="box-subtitle">Instantly visible to staff</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Block Time Slot</div>
                            <div class="box-subtitle">No double booking</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Trigger Reminder Sequence</div>
                            <div class="box-subtitle">48hr, 24hr, 2hr reminders scheduled</div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Flow 2: Phone Booking (Manual Entry)</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box user">
                            <div class="box-title">Patient</div>
                            <div class="box-subtitle">Calls clinic</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box user">
                            <div class="box-title">Front Desk</div>
                            <div class="box-subtitle">Answers phone</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Search Patient</div>
                            <div class="box-subtitle">By phone or name</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">New Patient?</div>
                            <div class="box-subtitle">Create profile if needed</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box action">
                            <div class="box-title">Open Calendar</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Find Available Slot</div>
                            <div class="box-subtitle">Check practitioner availability</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Click to Book</div>
                            <div class="box-subtitle">Add service + patient</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Save Appointment</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box automation">
                            <div class="box-title">Auto-Send SMS</div>
                            <div class="box-subtitle">Same as online booking</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Trigger Reminders</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box user">
                            <div class="box-title">Front Desk</div>
                            <div class="box-subtitle">Confirms details verbally</div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Flow 3: SMS Booking (AI-Assisted)</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box user">
                            <div class="box-title">Patient</div>
                            <div class="box-subtitle">Texts "I want Botox"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">AI Analyzes</div>
                            <div class="box-subtitle">Intent: Book appointment</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Create Staff Notification</div>
                            <div class="box-subtitle">Shows in messages dashboard</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box automation">
                            <div class="box-title">Auto-Reply</div>
                            <div class="box-subtitle">"We'd love to book you! What dates work?"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box user">
                            <div class="box-title">Patient</div>
                            <div class="box-subtitle">Replies with preferred dates</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box user">
                            <div class="box-title">Front Desk</div>
                            <div class="box-subtitle">Sees conversation, books appointment</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box automation">
                            <div class="box-title">Confirmation SMS</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Reminders Scheduled</div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Flow 4: Walk-In Booking</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box user">
                            <div class="box-title">Patient</div>
                            <div class="box-subtitle">Walks into clinic</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box user">
                            <div class="box-title">Front Desk</div>
                            <div class="box-subtitle">"Do you have an appointment?"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Check Availability</div>
                            <div class="box-subtitle">Can we fit them in now?</div>
                        </div>
                    </div>
                    <div class="workflow-row">
                        <div class="box action">
                            <div class="box-title">Book Immediately</div>
                            <div class="box-subtitle">Or schedule for later</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Check-In Patient</div>
                            <div class="box-subtitle">Update status to "Arrived"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Add to Queue</div>
                            <div class="box-subtitle">Waiting room dashboard</div>
                        </div>
                    </div>
                </div>

                <div class="note">
                    <strong>Critical Rule:</strong> No matter which booking flow is used, the outcome is THE SAME: Appointment in calendar, Confirmation SMS sent, Reminders scheduled, Patient profile updated. This consistency is key to seamless operations.
                </div>

                <div class="edge-cases-container">
                    <div class="edge-cases-header collapsed">
                        ‚ö†Ô∏è REALITY CHECK: What Can Go Wrong with Booking? (Click to expand)
                    </div>
                    <div class="edge-cases-content">
                        <div class="edge-case-item">
                            <h5>üî¥ Race Condition: Double Booking <span class="reality-badge common">Happens Weekly</span></h5>
                            <p class="problem">Problem: Two patients select the same time slot simultaneously (2:00 PM). Both click "Book" before system updates availability.</p>
                            <p class="solution">Lock time slot for 5 minutes when "Booking in progress" (shopping cart hold). First to complete payment wins. Second person sees "Sorry, that slot was just taken. Here are alternatives..."</p>
                            <p class="human-needed">Front desk monitors dashboard for conflicts and calls affected patient immediately.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Wrong Phone Number Entered <span class="reality-badge common">Happens Daily</span></h5>
                            <p class="problem">Problem: Patient types phone number incorrectly (555-1234 instead of 555-1235). Confirmations go to wrong person. Patient shows up confused.</p>
                            <p class="solution">Send confirmation SMS immediately. If it bounces back (invalid number), flag appointment as "UNCONFIRMED - Bad Phone" in dashboard. Auto-email instead. Front desk must call to verify before appointment.</p>
                            <p class="human-needed">Front desk calls patient 24hrs before to confirm + verify phone number.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Never Confirms Appointment <span class="reality-badge common">20% of bookings</span></h5>
                            <p class="problem">Problem: Patient books online but never responds to any confirmation requests. Are they coming or not?</p>
                            <p class="solution">Mark as "UNCONFIRMED" in system. Send escalating reminders: T-48hrs (SMS), T-24hrs (SMS + Email), T-2hrs (Final SMS). If still no response, flag as 60% no-show risk. Manager decides: keep appointment or double-book?</p>
                            <p class="human-needed">Manager reviews unconfirmed appointments each morning and decides whether to keep, call patient, or release slot.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Service Requires Consultation First <span class="reality-badge">New patients only</span></h5>
                            <p class="problem">Problem: New patient books laser treatment online. But policy requires consultation first for safety/expectations.</p>
                            <p class="solution">During booking, system detects: New patient + High-risk service ‚Üí Show warning: "This service requires a free consultation first. Would you like to book a consultation instead?" Auto-switch to consultation booking. After consultation, practitioner can book actual treatment.</p>
                            <p class="human-needed">If patient ignores warning and books anyway, front desk calls to reschedule as consultation.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Payment Card Declined (Pre-Payment Required) <span class="reality-badge">VIP/packages</span></h5>
                            <p class="problem">Problem: Practice requires prepayment for new patients or packages. Card on file is declined at booking.</p>
                            <p class="solution">Booking fails gracefully: "We couldn't process your payment. Please verify card details or call us at (555) 100-0000 to complete booking." Hold time slot for 30 mins. Send email with payment link.</p>
                            <p class="human-needed">Front desk sees "Payment Failed" flag and calls patient to take payment over phone.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Minor Patient (Under 18) <span class="reality-badge rare">Rare but legal issue</span></h5>
                            <p class="problem">Problem: 16-year-old books Botox online. Illegal to treat minors without parent consent for most cosmetic procedures.</p>
                            <p class="solution">Intake form asks age. If under 18: "Patients under 18 require parent/guardian consent. Please call us at (555) 100-0000 to book with a parent." Booking blocked for minors online.</p>
                            <p class="human-needed">Front desk handles all minor bookings via phone, requires parent signature, verifies ID.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Texts "I want Botox" at 3 AM <span class="reality-badge common">Nights/weekends</span></h5>
                            <p class="problem">Problem: Patient sends booking request via SMS outside business hours. No staff available to respond.</p>
                            <p class="solution">AI auto-responds immediately: "Thanks for your interest! We're currently closed but we'll respond first thing tomorrow morning (9 AM). In the meantime, you can book online at [link]." Flag message for staff review at 9 AM. If patient hasn't booked online, staff calls to assist.</p>
                            <p class="human-needed">First staff member to arrive reviews overnight messages and responds/books within 1 hour of opening.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Walk-In During Fully Booked Day <span class="reality-badge common">Happens 2-3x/week</span></h5>
                            <p class="problem">Problem: Patient walks in wanting immediate Botox. Calendar completely full, no practitioner availability.</p>
                            <p class="solution">Front desk checks: (1) Can we squeeze 15-min Botox between appointments? (2) Is practitioner willing to stay late? (3) Can we book at sister location today? If all no: "We're fully booked today. I can get you in tomorrow at 2 PM or Friday at 10 AM. Which works better?"</p>
                            <p class="human-needed">Front desk uses judgment: If VIP patient or urgent medical need, may interrupt practitioner for approval to add extra appointment.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ System Crash During Booking <span class="reality-badge rare">Once per month</span></h5>
                            <p class="problem">Problem: Server error, internet outage, or database issue during booking process. Patient sees error page.</p>
                            <p class="solution">Show error message: "We're experiencing technical difficulties. Your booking was NOT completed. Please try again in a few minutes or call us at (555) 100-0000." Log failed booking attempt with patient contact info. Send recovery email: "We noticed you tried to book with us. Click here to complete your booking [link]."</p>
                            <p class="human-needed">IT alerted immediately. Front desk reviews failed bookings log and calls patients to manually complete booking.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Books at Wrong Location <span class="reality-badge">Multi-location only</span></h5>
                            <p class="problem">Problem: Practice has 3 locations. Patient books at "Downtown" but lives near "Westside." Shows up at Westside location confused.</p>
                            <p class="solution">Confirmation SMS includes location: "Your appointment is at our DOWNTOWN location: 123 Main St. Map: [link]". If patient shows up at wrong location, front desk sees appointment in system with different location. Options: (1) Call Downtown to see if they can squeeze in, (2) Reschedule at correct location, (3) Cancel and apologize.</p>
                            <p class="human-needed">Front desk coordinates with other location to transfer appointment if possible, or reschedules with apology discount.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TREATMENT FLOW TAB -->
        <div class="tab-content" id="treatment">
            <div class="section">
                <h2 class="section-title">Treatment Room Flow: Patient Entry ‚Üí Exit</h2>

                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box action">
                            <div class="box-title">1. Patient Called</div>
                            <div class="box-subtitle">From waiting room/virtual queue</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">2. Escort to Treatment Room</div>
                            <div class="box-subtitle">Room assignment visible on dashboard</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">3. Pract iter Opens iPad</div>
                            <div class="box-subtitle">Sees patient chart automatically</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">4. Review History</div>
                            <div class="box-subtitle">Previous treatments, allergies, photos</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">5. Consultation</div>
                            <div class="box-subtitle">Discuss treatment plan</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">6. Before Photos</div>
                            <div class="box-subtitle">Multiple angles, auto-saved to chart</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">7. Consent Form</div>
                            <div class="box-subtitle">Digital signature on iPad</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">8. Perform Treatment</div>
                            <div class="box-subtitle">Document in real-time</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">9. After Photos</div>
                            <div class="box-subtitle">Auto-matched with before photos</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">10. Complete SOAP Notes</div>
                            <div class="box-subtitle">S, O, A, P - all required fields</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">11. Log Products Used</div>
                            <div class="box-subtitle">Units of Botox, Filler syringes, etc.</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Auto-Deduct Inventory</div>
                            <div class="box-subtitle">Real-time inventory update</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">12. Mark Complete</div>
                            <div class="box-subtitle">Digital signature + timestamp</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Notify Front Desk</div>
                            <div class="box-subtitle">"Patient ready for checkout"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Auto-Generate Invoice</div>
                            <div class="box-subtitle">Services + Products priced</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box automation">
                            <div class="box-title">Send Aftercare SMS</div>
                            <div class="box-subtitle">Treatment-specific instructions</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Schedule Follow-Ups</div>
                            <div class="box-subtitle">24hr, 3-day, 2-week check-ins</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Escort to Checkout</div>
                            <div class="box-subtitle">Patient leaves treatment room</div>
                        </div>
                    </div>
                </div>

                <div class="note">
                    <strong>Key Point:</strong> The iPad app is LOCKED to the treatment room workflow. Practitioners cannot access scheduling, billing, or other admin features. This focuses their attention on patient care and prevents accidental data exposure.
                </div>

                <div class="edge-cases-container">
                    <div class="edge-cases-header collapsed">
                        ‚ö†Ô∏è REALITY CHECK: What Can Go Wrong in Treatment Room? (Click to expand)
                    </div>
                    <div class="edge-cases-content">
                        <div class="edge-case-item">
                            <h5>üî¥ Patient Has Allergic Reaction During Treatment <span class="reality-badge rare">Medical Emergency</span></h5>
                            <p class="problem">Problem: Patient has adverse reaction to Botox or filler during treatment. Swelling, difficulty breathing, hives, anaphylaxis.</p>
                            <p class="solution">IMMEDIATE EMERGENCY PROTOCOL: (1) Stop treatment, (2) Hit "Medical Emergency" button on iPad ‚Üí Auto-calls 911, alerts all staff, logs incident time, (3) Administer emergency meds (EpiPen if severe), (4) Chart auto-saves with "EMERGENCY - INCOMPLETE" flag, (5) System locks and preserves all data for legal/medical review.</p>
                            <p class="human-needed">Practitioner focuses 100% on patient care. Front desk handles 911, family notification, incident report. Manager reviews incident, contacts insurance, files reports.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ iPad Crashes Mid-Treatment <span class="reality-badge common">Happens monthly</span></h5>
                            <p class="problem">Problem: iPad freezes, loses wifi, or app crashes while practitioner is in middle of charting SOAP notes. Partial data lost.</p>
                            <p class="solution">App auto-saves every 30 seconds to cloud. On crash: "Connection lost. Your work is saved. Reconnecting..." When back online, restore from last auto-save. Practitioner reviews and completes notes. If complete data loss (rare), practitioner logs into desktop to chart from scratch - all treatment photos are already uploaded.</p>
                            <p class="human-needed">If iPad fully broken, practitioner completes charting on desktop admin panel after treatment. Front desk provides backup iPad if available.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Practitioner Forgets to Mark Treatment Complete <span class="reality-badge common">10% of treatments</span></h5>
                            <p class="problem">Problem: Practitioner finishes treatment, patient leaves, but practitioner never clicks "Mark Complete." Chart left in "In Progress" state. No invoice created, no aftercare SMS sent.</p>
                            <p class="solution">System detects: Treatment in progress > 2 hours with no activity. Auto-alert: "Dr. Smith, did you forget to mark Sarah's 2pm Botox complete?" If no response after 30 mins, alert front desk: "Sarah's treatment may be incomplete. Please verify with Dr. Smith." Chart remains in draft state until marked complete.</p>
                            <p class="human-needed">Front desk sees "Incomplete Chart" alert and asks practitioner before patient checks out. If practitioner left for the day, front desk manually marks complete (with permission) or delays checkout until next day.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Wrong Product Quantities Logged <span class="reality-badge common">Billing disputes</span></h5>
                            <p class="problem">Problem: Practitioner logs "50 units Botox" but actually used 52 units. Or logs filler syringe but used 2. Patient gets wrong bill, inventory wrong.</p>
                            <p class="solution">iPad shows real-time pricing as quantities entered: "50 units Botox = $500". Before marking complete, confirmation screen: "You used: 50 units Botox ($500), Review and confirm or edit." If patient disputes at checkout, front desk can see chart with quantity, call practitioner for verification. Chart is locked after completion, but manager can make corrections with note: "Corrected by Manager - Reason: Billing dispute"</p>
                            <p class="human-needed">If dispute occurs, front desk calls practitioner immediately for clarification. Manager reviews all corrections for patterns (is practitioner consistently logging wrong amounts?).</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Before Photos Not Taken <span class="reality-badge">Legal/marketing issue</span></h5>
                            <p class="problem">Problem: Practitioner rushes through workflow, skips before photos, performs treatment. Later wants before/after comparison for patient records or marketing. No before photos exist.</p>
                            <p class="solution">Make before photos REQUIRED for certain treatments (Botox, filler, laser). Cannot mark treatment complete without before photos: "Before photos required. Please take photos or mark 'Patient Refused Photos'." If patient refuses, digital consent: "Patient declined before/after photos on [date] - Signature".</p>
                            <p class="human-needed">If practitioner genuinely forgot and treatment done, they must chart: "Before photos not obtained - treatment already performed." Manager reviews these incidents to ensure compliance.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Changes Mind Mid-Treatment <span class="reality-badge rare">Awkward situation</span></h5>
                            <p class="problem">Problem: Practitioner has consent signed, begins Botox injections, patient says "Stop! I don't want this anymore." Treatment partially done.</p>
                            <p class="solution">STOP IMMEDIATELY. Patient has right to refuse treatment anytime. In charting, select "Treatment Discontinued - Patient Request". Log exactly what was done: "Completed forehead (20 units), patient declined remainder." Create partial invoice for work completed. Get signature on "Partial Treatment Acknowledgment" form. Send modified aftercare instructions.</p>
                            <p class="human-needed">Practitioner handles with empathy, doesn't pressure. Front desk processes partial payment, offers full refund of prepayment minus work done. Manager follows up with patient to ensure satisfaction and address concerns.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Wrong Patient Brought to Treatment Room <span class="reality-badge rare">HIPAA/safety risk</span></h5>
                            <p class="problem">Problem: Two patients named "Sarah Johnson" in waiting room. Front desk calls wrong Sarah. Practitioner starts reviewing wrong patient's chart on iPad.</p>
                            <p class="solution">When practitioner opens patient chart, first screen is PHOTO ID VERIFICATION: Shows patient's photo from intake + date of birth. "Is this your patient? YES / NO". If NO, alert: "WRONG PATIENT! Return to waiting room and verify identity." Log incident for review.</p>
                            <p class="human-needed">Practitioner verifies patient identity verbally: "Can you confirm your date of birth?" before starting. If wrong patient was brought back, apologize and bring correct patient. Manager reviews to prevent future incidents.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Refuses to Sign Consent <span class="reality-badge rare">Legal risk</span></h5>
                            <p class="problem">Problem: Patient wants treatment but refuses to sign consent form (concerned about side effects, legal language, etc.).</p>
                            <p class="solution">NO SIGNATURE = NO TREATMENT. Policy enforcement: iPad will not allow treatment to proceed without signed consent. Practitioner must explain: "For your safety and ours, we require this consent. Let me explain each section..." If patient still refuses, practitioner selects "Treatment Cancelled - Consent Not Obtained". Patient escorted to front desk for discussion or cancellation.</p>
                            <p class="human-needed">Manager or senior practitioner discusses concerns with patient. If patient wants treatment without consent, they must go elsewhere. Document refusal for legal protection.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Practitioner Running 45+ Minutes Behind <span class="reality-badge common">2-3x per month</span></h5>
                            <p class="problem">Problem: Morning treatments take longer than expected. By 2pm, practitioner is 45 mins behind schedule. All afternoon patients waiting or angry.</p>
                            <p class="solution">System detects: "Dr. Smith is 30+ mins behind schedule". Auto-alerts front desk dashboard with RED WARNING. Front desk MUST: (1) Call/text upcoming patients: "Dr. Smith is running 30 mins late. Your 2pm is now approximately 2:30. Can you still make it?" (2) Offer to reschedule no penalty. (3) Update waiting room patients. System suggests: Can we move patient to Dr. Jones who is on-time?</p>
                            <p class="human-needed">Front desk manages patient expectations proactively. Manager decides if practitioner should skip lunch to catch up, or if we reschedule remainder of day. Apologize profusely, offer discount if patient frustrated.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Products Used Not in Inventory System <span class="reality-badge">New products</span></h5>
                            <p class="problem">Problem: Practice just got new filler brand "Juvederm Ultra XC". Not yet added to inventory system. Practitioner uses it on patient but can't log it in iPad.</p>
                            <p class="solution">iPad allows "Add Custom Product" for one-time use. Practitioner enters: Product name, Quantity, Cost. Flags invoice: "Custom Product - Verify Pricing". Auto-creates task for manager: "Add Juvederm Ultra XC to inventory system with proper pricing/codes".</p>
                            <p class="human-needed">Front desk verifies pricing with manager before charging patient. Manager adds product to system within 24 hours so it's available for future treatments.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STAFF WORKFLOWS TAB -->
        <div class="tab-content" id="staff">
            <div class="section">
                <h2 class="section-title">Staff Workflows & Management</h2>

                <h3 class="section-subtitle">Practitioner Daily Flow</h3>
                <div class="journey">
                    <div class="journey-step">
                        <div class="journey-number">1</div>
                        <div class="journey-content">
                            <h4>Morning Review</h4>
                            <p>Practitioner logs into iPad or mobile app ‚Üí Views today's schedule ‚Üí Reviews patient charts for upcoming appointments ‚Üí Notes any special requests or preparation needed</p>
                            <div class="journey-automation">
                                <strong>Auto-notifications:</strong> Alerts for new bookings, cancellations, or schedule changes sent via push notification
                            </div>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">2</div>
                        <div class="journey-content">
                            <h4>Treatment Execution</h4>
                            <p>See treatment room details ‚Üí Complete charting on iPad ‚Üí Mark treatments complete ‚Üí Products auto-billed</p>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">3</div>
                        <div class="journey-content">
                            <h4>End of Day</h4>
                            <p>Review completed treatments ‚Üí Check commission summary ‚Üí Add any notes for tomorrow ‚Üí Log out</p>
                            <div class="journey-automation">
                                <strong>Auto-generated:</strong> Daily summary email with patient count, revenue generated, commission earned
                            </div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Front Desk Daily Flow</h3>
                <div class="journey">
                    <div class="journey-step">
                        <div class="journey-number">1</div>
                        <div class="journey-content">
                            <h4>Opening Tasks (8:00 AM)</h4>
                            <p>Review today's appointments ‚Üí Check for unconfirmed appointments ‚Üí Send manual confirmation texts if needed ‚Üí Check waiting room queue (should be empty)</p>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">2</div>
                        <div class="journey-content">
                            <h4>During Business Hours</h4>
                            <p>Answer phones ‚Üí Book appointments ‚Üí Check patients in ‚Üí Manage waiting room ‚Üí Process checkouts ‚Üí Respond to SMS conversations ‚Üí Handle walk-ins</p>
                        </div>
                    </div>

                    <div class="journey-step">
                        <div class="journey-number">3</div>
                        <div class="journey-content">
                            <h4>Closing Tasks (6:00 PM)</h4>
                            <p>Reconcile cash drawer ‚Üí Review tomorrow's appointments ‚Üí Send reminder SMS for tomorrow's early appointments ‚Üí Close out day in system</p>
                            <div class="journey-automation">
                                <strong>Auto-generated:</strong> End-of-day report with total revenue, number of patients seen, outstanding balances
                            </div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Manager/Admin Weekly Flow</h3>
                <div class="integration-grid">
                    <div class="integration-card">
                        <h4>Monday: Week Planning</h4>
                        <div class="trigger">Review upcoming week schedule</div>
                        <div class="trigger">Check practitioner availability</div>
                        <div class="trigger">Review inventory levels</div>
                        <div class="trigger">Plan marketing campaigns</div>
                    </div>

                    <div class="integration-card">
                        <h4>Wednesday: Mid-Week Check</h4>
                        <div class="trigger">Review revenue vs. targets</div>
                        <div class="trigger">Check no-show rates</div>
                        <div class="trigger">Review staff performance</div>
                        <div class="trigger">Adjust schedule if needed</div>
                    </div>

                    <div class="integration-card">
                        <h4>Friday: Week Close</h4>
                        <div class="trigger">Generate weekly reports</div>
                        <div class="trigger">Review practitioner commissions</div>
                        <div class="trigger">Plan next week inventory orders</div>
                        <div class="trigger">Review patient feedback</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BILLING & PAYMENTS TAB -->
        <div class="tab-content" id="billing">
            <div class="section">
                <h2 class="section-title">Billing & Payment Workflows</h2>

                <h3 class="section-subtitle">Checkout Flow</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box action">
                            <div class="box-title">Treatment Complete</div>
                            <div class="box-subtitle">Practitioner marks done on iPad</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Invoice Auto-Created</div>
                            <div class="box-subtitle">Services + Products added</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Notification to Front Desk</div>
                            <div class="box-subtitle">"Sarah ready for checkout"</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">Patient Arrives at Front</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Front Desk Opens Invoice</div>
                            <div class="box-subtitle">Auto-populated with treatment details</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Review with Patient</div>
                            <div class="box-subtitle">"Your Botox today is $400"</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box action">
                            <div class="box-title">Payment Method</div>
                            <div class="box-subtitle">Card, Cash, Package, Membership</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">Process Payment</div>
                            <div class="box-subtitle">Stripe/Square integration</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Receipt SMS + Email</div>
                            <div class="box-subtitle">Instant delivery</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box automation">
                            <div class="box-title">Update Patient Balance</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Deduct Membership Credits</div>
                            <div class="box-subtitle">If applicable</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">Log to Accounting</div>
                            <div class="box-subtitle">QuickBooks sync</div>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">Payment Options Matrix</h3>
                <div class="integration-grid">
                    <div class="integration-card">
                        <h4>1. Credit/Debit Card</h4>
                        <div class="trigger"><strong>Process:</strong> Swipe/tap/chip reader</div>
                        <div class="trigger"><strong>Fees:</strong> 2.9% + 30¬¢</div>
                        <div class="trigger"><strong>Settlement:</strong> Next day</div>
                        <div class="trigger"><strong>Receipt:</strong> Auto SMS + Email</div>
                    </div>

                    <div class="integration-card">
                        <h4>2. Cash</h4>
                        <div class="trigger"><strong>Process:</strong> Manual entry in system</div>
                        <div class="trigger"><strong>Fees:</strong> None</div>
                        <div class="trigger"><strong>Reconciliation:</strong> End of day cash count</div>
                        <div class="trigger"><strong>Receipt:</strong> Printed + optional email</div>
                    </div>

                    <div class="integration-card">
                        <h4>3. Package/Membership Credits</h4>
                        <div class="trigger"><strong>Process:</strong> Auto-deduct from balance</div>
                        <div class="trigger"><strong>Validation:</strong> Check expiration date</div>
                        <div class="trigger"><strong>Remaining:</strong> Show balance after payment</div>
                        <div class="trigger"><strong>Alert:</strong> If credits low, offer refill</div>
                    </div>

                    <div class="integration-card">
                        <h4>4. Payment Plan</h4>
                        <div class="trigger"><strong>Setup:</strong> Split into installments</div>
                        <div class="trigger"><strong>Auto-charge:</strong> Saved card on file</div>
                        <div class="trigger"><strong>Reminders:</strong> Before each charge</div>
                        <div class="trigger"><strong>Tracking:</strong> Payment status dashboard</div>
                    </div>
                </div>

                <h3 class="section-subtitle">Invoicing & Collections</h3>
                <div class="workflow-container">
                    <div class="workflow-row">
                        <div class="box gap">
                            <div class="box-title">Unpaid Invoice Created</div>
                            <div class="box-subtitle">Patient left without paying</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">T+24hrs: Reminder SMS</div>
                            <div class="box-subtitle">"You have an outstanding balance"</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box automation">
                            <div class="box-title">T+7 days: Email Invoice</div>
                            <div class="box-subtitle">With payment link</div>
                        </div>
                    </div>

                    <div class="workflow-row" style="margin-top: 20px;">
                        <div class="box automation">
                            <div class="box-title">T+14 days: Phone Call</div>
                            <div class="box-subtitle">Staff manually reaches out</div>
                        </div>
                        <span class="arrow">‚Üí</span>
                        <div class="box action">
                            <div class="box-title">T+30 days: Collections</div>
                            <div class="box-subtitle">Send to collections agency or write off</div>
                        </div>
                    </div>
                </div>

                <div class="edge-cases-container">
                    <div class="edge-cases-header collapsed">
                        ‚ö†Ô∏è REALITY CHECK: What Can Go Wrong with Billing & Payments? (Click to expand)
                    </div>
                    <div class="edge-cases-content">
                        <div class="edge-case-item">
                            <h5>üî¥ Card Declined at Checkout <span class="reality-badge common">Happens 3-5x per week</span></h5>
                            <p class="problem">Problem: Patient's treatment complete. Total is $650. Front desk swipes card. DECLINED. Patient says "That's weird, I just used this card." Awkward situation.</p>
                            <p class="solution">System shows specific decline reason: "Insufficient funds", "Card expired", "Call issuer", or generic "Declined". Front desk offers options: (1) Try another card, (2) Try debit card, (3) Call bank to approve, (4) Pay half now, half later (payment plan), (5) Invoice and pay online within 24hrs. Don't shame patient. If card works after calling bank, process it. If truly no payment method, create invoice with 24hr due date.</p>
                            <p class="human-needed">Front desk handles with empathy: "Cards get declined all the time! Let's try another one or you can call your bank real quick." If patient has no other payment method, manager decides: Let them go with invoice, or require payment plan setup before leaving. For VIP/regular patients, may allow invoice. New patients may need to setup payment plan immediately.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Disputes Charges <span class="reality-badge common">1-2x per month</span></h5>
                            <p class="problem">Problem: Patient gets invoice for $850. Says "I thought it was only $400!" or "You charged me for filler I didn't get!" Angry, refuses to pay full amount.</p>
                            <p class="solution">Front desk pulls up treatment chart on screen. Shows exactly what practitioner documented: "52 units Botox ($520) + 1 syringe Juvederm ($330) = $850". Explains each line item. If patient still disputes, check if pricing was clearly communicated before treatment. Review consent form for pricing acknowledgment. If legitimate error (practitioner logged wrong amount), manager can adjust invoice. If patient's memory vs documentation, offer to call practitioner for clarification.</p>
                            <p class="human-needed">Manager reviews dispute immediately. If clinic error: Apologize profusely, adjust invoice, offer discount on next visit. If patient error/misunderstanding: Show documentation respectfully, explain pricing, offer payment plan if needed. If patient refuses to pay despite documentation, may escalate to: (1) Send to collections, (2) Write off bad debt, (3) Ban patient if fraud suspected. Document everything for legal protection.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Wants Refund After Treatment <span class="reality-badge rare">Delicate situation</span></h5>
                            <p class="problem">Problem: Patient paid $600 for Botox yesterday. Today texts: "I'm not happy with results, I want a full refund." Treatment already performed and paid for.</p>
                            <p class="solution">System flags: "Refund request after treatment - Manager approval required". Manager must: (1) Review treatment chart and photos, (2) Determine if results are medically appropriate or if mistake made, (3) Call patient to discuss concerns. Policy should be clear: "Cosmetic treatments are final sale unless practitioner error." But for customer service, may offer: Free touch-up, Partial credit toward future treatment, or Discount on next visit. Full refunds typically only if: Practitioner error, Medical complication, or Treatment never performed.</p>
                            <p class="human-needed">Manager personally calls patient to understand concern. Often: Patient has unrealistic expectations or results not yet visible (Botox takes 7-14 days). Manager educates, offers free follow-up appointment for practitioner to assess. If legitimate complaint, may offer partial refund or service credit. Document all customer service actions. If patient threatens lawsuit, refer to practice attorney.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Leaves Without Paying <span class="reality-badge rare">Walkout</span></h5>
                            <p class="problem">Problem: Treatment complete. Patient says "I need to run to my car to get my wallet." Never comes back. Just left without paying $750 invoice.</p>
                            <p class="solution">PREVENTION: Front desk should collect card on file before treatment. For new patients or high-value treatments, require payment or preauth before treatment. If patient leaves without paying: (1) Call immediately, (2) Send invoice via SMS/Email immediately, (3) Flag account: "UNPAID INVOICE - Do not book future appointments", (4) Start collections sequence: 24hr reminder, 7-day email, 14-day phone call, 30-day collections agency.</p>
                            <p class="human-needed">Front desk calls patient immediately (while they're probably still in car). Often honest mistake: "Oh I'm so sorry, I got a call and forgot! I'll come back right now." If patient ignores calls, manager sends formal invoice. After 30 days unpaid, decide: Send to collections or write off. For patients who "forget" repeatedly, require prepayment for all future services.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Membership Credits Expired <span class="reality-badge">Frustrating for patient</span></h5>
                            <p class="problem">Problem: Patient bought $2,000 membership package 13 months ago. Policy says credits expire after 12 months. Patient shows up for treatment expecting to use credits. "What do you mean they expired?! I paid for those!"</p>
                            <p class="solution">PREVENTION: System auto-alerts patients 60 days, 30 days, and 7 days before credits expire. "You have $800 in credits expiring on March 31. Book now!" Track if patient never used credits - may indicate they forgot about membership. If credits expire: Check if patient ever received expiration warnings (delivery confirmation). Manager decides: (1) Strict policy - credits gone, (2) One-time extension as courtesy, (3) Partial credit recovery (50% of expired amount). Policy should be clearly stated in membership agreement with signature.</p>
                            <p class="human-needed">Manager reviews: Did we send expiration warnings? Did patient acknowledge them? If system failure (emails went to spam, patient changed number), consider courtesy extension. If patient simply didn't book despite reminders, enforce policy but offer compromise: "I can give you 30 more days as a one-time courtesy." Document exception. If patient becomes hostile, may need to maintain boundary and explain signed agreement.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ System Double-Charges Patient <span class="reality-badge rare">Technical error</span></h5>
                            <p class="problem">Problem: Front desk swipes card for $400. System lags. They swipe again thinking it didn't work. Patient charged $800 total - twice for same transaction.</p>
                            <p class="solution">System should prevent: After successful charge, disable payment button for 30 seconds with message: "Processing... Please wait." If double charge occurs: Front desk sees two transactions in system immediately. MUST void second charge within 24hrs (easier than refund). If patient already left, call immediately: "We accidentally charged you twice. We're voiding the second charge right now. You'll see $400 credit in 3-5 business days." Send email confirmation of void.</p>
                            <p class="human-needed">Front desk voids second charge immediately via payment processor dashboard. Manager personally calls patient to apologize and confirm void. If patient already contacted bank to dispute, work with bank to resolve. Send written confirmation of void via email. If void window passed, process refund instead (takes 7-10 days). Offer discount on next visit for inconvenience.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Payment Plan Autopay Fails <span class="reality-badge common">Monthly payments</span></h5>
                            <p class="problem">Problem: Patient on $2,000 payment plan ($400/month for 5 months). Month 3 autopay scheduled. Card declined. Patient doesn't realize, thinks they're paid up.</p>
                            <p class="solution">System auto-detects failed payment. Actions: (1) Retry charge after 3 days (maybe temporary insufficient funds), (2) Send SMS: "Your payment plan charge of $400 was declined. Please update your payment method at [link]", (3) Email invoice with pay now button, (4) If not paid within 7 days, suspend account: "Cannot book new appointments until payment plan current", (5) After 14 days, flag for collections.</p>
                            <p class="human-needed">Front desk calls patient after first failed attempt: "Hi Sarah, just letting you know your $400 payment didn't go through. Can we try a different card?" Often patient says "Oh that card expired, here's my new one." Update payment method and reprocess. If patient avoiding payment, manager discusses: Continue payment plan with new card, or pay remaining balance in full. If repeated failures, may require upfront payment for future treatments.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Cash Drawer Doesn't Balance at End of Day <span class="reality-badge common">Weekly occurrence</span></h5>
                            <p class="problem">Problem: Front desk closes cash drawer. System says should be $450 cash. Drawer has $475 - $25 over. Or $425 - $25 short. Where's the discrepancy?</p>
                            <p class="solution">System shows all cash transactions for the day with timestamps and staff member names. Front desk reviews: (1) Check if cash transaction was logged as card or vice versa, (2) Check if someone gave wrong change, (3) Check if refund was given in cash but logged as card, (4) Review security camera if large discrepancy. Document overage/shortage: "Cash drawer over $25 - investigating." If under $5 discrepancy, often write off as counting error. If over $20, requires investigation.</p>
                            <p class="human-needed">Manager reviews all cash transactions. Common issues: Staff member accepted $100 bill, gave change, but logged as exact amount. Or patient paid $100 for $85 treatment, change given but system shows $100 received. If recurring shortages for same staff member, may indicate theft or training issue. For overages, check if patient overpaid and left (need to refund). Balancing issues addressed in weekly staff meeting.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üü° Patient Wants to Use FSA/HSA Card <span class="reality-badge">Compliance issue</span></h5>
                            <p class="problem">Problem: Patient wants to pay with HSA card for Botox. Cosmetic Botox is NOT HSA-eligible (must be medical necessity). System accepts card (just looks like a debit card), but patient's HSA administrator may reject and audit clinic.</p>
                            <p class="solution">Train staff: Cosmetic treatments NOT eligible for FSA/HSA. Medical treatments (Botox for TMJ, laser for acne scarring) ARE eligible. At checkout, staff must ask: "Is this a Health Savings Account card? This treatment is cosmetic so it won't be covered." If patient insists, make them sign waiver: "I understand this is not HSA-eligible and I'm responsible if my HSA administrator rejects this charge." System flags: "HSA used for cosmetic - patient waiver required".</p>
                            <p class="human-needed">Front desk trained to identify FSA/HSA cards and explain eligibility. For medical treatments, provide superbill/documentation for patient's HSA. If patient's HSA rejects charge later and chargesback, clinic may need to refund and collect payment via different method. Keep all waivers for audit protection. Manager reviews HSA transactions quarterly to ensure compliance.</p>
                        </div>

                        <div class="edge-case-item">
                            <h5>üî¥ Patient Tip Added to Card (Staff Compensation) <span class="reality-badge">Gratuity complexity</span></h5>
                            <p class="problem">Problem: Patient wants to tip nurse/practitioner for excellent service. Adds $50 tip to $400 charge. How is tip tracked, distributed, and taxed?</p>
                            <p class="solution">System must separate: Service charge ($400) vs Gratuity ($50). Invoice shows: "Services: $400, Gratuity: $50, Total: $450". Tip automatically allocated to practitioner who performed service. At end of day, system generates: "Tips received by practitioner" report. Tips must be: (1) Given to practitioner in next paycheck (or cash if allowed), (2) Reported to IRS as income, (3) Tracked separately from commission/wages. Some practices pool tips, others give directly to practitioner.</p>
                            <p class="human-needed">Manager ensures tips properly distributed and reported. Payroll system tracks: Base pay + Commission + Tips = Total compensation (for tax reporting). Some states have rules about tip sharing. If patient tips via cash, staff must log it immediately for tax compliance. Year-end: All tips reported on W-2 for practitioners. Clinic doesn't keep any portion of tips (illegal in most states).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AUTOMATION & TRIGGERS TAB -->
        <div class="tab-content" id="automation">
            <div class="section">
                <h2 class="section-title">All Automation Triggers & Integrations</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    These are ALL the places where actions in one part of the system automatically trigger actions elsewhere. This is the "glue" that makes Luxe seamless.
                </p>

                <div class="integration-grid">
                    <div class="integration-card">
                        <h4>üìÖ Calendar Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Appointment booked (any method)</div>
                        <div class="trigger"><strong>Actions:</strong> Send confirmation SMS, Send confirmation email with calendar .ics file, Schedule reminder sequence (48hr, 24hr, 2hr), Block practitioner's calendar, Update dashboard stats</div>
                    </div>

                    <div class="integration-card">
                        <h4>‚è∞ Time-Based Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> T-48 hours before appointment</div>
                        <div class="trigger"><strong>Actions:</strong> Send reminder SMS with prep instructions</div>
                        <div class="trigger"><strong>Trigger:</strong> T-24 hours before appointment</div>
                        <div class="trigger"><strong>Actions:</strong> Send reminder SMS, Check if forms completed (if not, send link)</div>
                        <div class="trigger"><strong>Trigger:</strong> T-2 hours before appointment</div>
                        <div class="trigger"><strong>Actions:</strong> Send final reminder with address</div>
                    </div>

                    <div class="integration-card">
                        <h4>üè• Check-In Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Patient texts "HERE"</div>
                        <div class="trigger"><strong>Actions:</strong> Add to waiting room queue, Send confirmation "We'll text you when ready", Notify practitioner patient arrived, Update appointment status to "Arrived"</div>
                        <div class="trigger"><strong>Trigger:</strong> Front desk clicks "Call Patient"</div>
                        <div class="trigger"><strong>Actions:</strong> Send "Room is ready" SMS, Update queue status to "Room Ready", Start treatment timer</div>
                    </div>

                    <div class="integration-card">
                        <h4>üíâ Treatment Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Practitioner marks "Complete" on iPad</div>
                        <div class="trigger"><strong>Actions:</strong> Lock chart (no more edits), Auto-create invoice with services + products, Deduct inventory for products used, Calculate practitioner commission, Send aftercare SMS immediately, Notify front desk patient ready for checkout, Schedule follow-up SMS sequence (24hr, 3-day, 2-week)</div>
                    </div>

                    <div class="integration-card">
                        <h4>üí≥ Payment Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Payment processed successfully</div>
                        <div class="trigger"><strong>Actions:</strong> Send receipt SMS + Email, Update patient balance to $0, Log to QuickBooks, Deduct membership credits if used, Update dashboard revenue</div>
                        <div class="trigger"><strong>Trigger:</strong> Payment plan installment due</div>
                        <div class="trigger"><strong>Actions:</strong> Charge card on file, Send receipt if successful, Send "Payment failed" SMS if declined</div>
                    </div>

                    <div class="integration-card">
                        <h4>üì¶ Inventory Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Product used in treatment</div>
                        <div class="trigger"><strong>Actions:</strong> Deduct from inventory count, Check if below reorder threshold, Send low stock alert if needed, Add to invoice automatically</div>
                        <div class="trigger"><strong>Trigger:</strong> Product stock hits reorder point</div>
                        <div class="trigger"><strong>Actions:</strong> Send alert to manager, Create draft purchase order, Add to inventory report</div>
                    </div>

                    <div class="integration-card">
                        <h4>üí¨ SMS Reply Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Patient replies to SMS</div>
                        <div class="trigger"><strong>Actions:</strong> AI analyzes intent and urgency, If urgent/requires human ‚Üí Create staff notification, If simple confirmation ‚Üí Auto-respond, Log conversation in patient record, Update conversation status</div>
                        <div class="trigger"><strong>Trigger:</strong> Patient replies "C" (confirm)</div>
                        <div class="trigger"><strong>Actions:</strong> Update appointment to "Confirmed", Send acknowledgment "Thanks for confirming!"</div>
                        <div class="trigger"><strong>Trigger:</strong> Patient replies "R" (reschedule)</div>
                        <div class="trigger"><strong>Actions:</strong> Create task for staff, Send "We'll call you to reschedule"</div>
                    </div>

                    <div class="integration-card">
                        <h4>üéÇ Date-Based Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Patient's birthday</div>
                        <div class="trigger"><strong>Actions:</strong> Send birthday SMS with 20% off code, Add birthday tag to patient profile, Create marketing opportunity</div>
                        <div class="trigger"><strong>Trigger:</strong> Membership credits expiring in 7 days</div>
                        <div class="trigger"><strong>Actions:</strong> Send alert SMS "Use your credits before they expire!", Show alert in admin when booking</div>
                        <div class="trigger"><strong>Trigger:</strong> 90 days since last visit</div>
                        <div class="trigger"><strong>Actions:</strong> Send "We miss you" win-back SMS with offer</div>
                    </div>

                    <div class="integration-card">
                        <h4>üì∏ Photo Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Before photo taken on iPad</div>
                        <div class="trigger"><strong>Actions:</strong> Auto-save to patient record, Tag with treatment type, Enable after photo comparison mode, Add to before/after gallery (if consent given)</div>
                        <div class="trigger"><strong>Trigger:</strong> After photo taken</div>
                        <div class="trigger"><strong>Actions:</strong> Auto-match with before photo, Create side-by-side view, Add to patient's gallery, Ask for marketing consent</div>
                    </div>

                    <div class="integration-card">
                        <h4>üìä Reporting Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> End of day (6:00 PM)</div>
                        <div class="trigger"><strong>Actions:</strong> Generate daily summary report, Email to manager, Calculate practitioner commissions, Close cash drawer summary</div>
                        <div class="trigger"><strong>Trigger:</strong> End of week (Sunday 11:59 PM)</div>
                        <div class="trigger"><strong>Actions:</strong> Generate weekly report, Calculate retention rate, Identify top services, Flag at-risk patients (no booking next week)</div>
                        <div class="trigger"><strong>Trigger:</strong> End of month</div>
                        <div class="trigger"><strong>Actions:</strong> Full financial report, Inventory audit, Staff performance review, Marketing campaign results</div>
                    </div>

                    <div class="integration-card">
                        <h4>üîî Staff Notification Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Patient arrives (virtual or physical)</div>
                        <div class="trigger"><strong>Actions:</strong> Push notification to practitioner, Add to today's queue view, Highlight in dashboard</div>
                        <div class="trigger"><strong>Trigger:</strong> Urgent patient message</div>
                        <div class="trigger"><strong>Actions:</strong> Immediate push notification, Email alert, SMS to on-call staff, Create priority task</div>
                        <div class="trigger"><strong>Trigger:</strong> Appointment cancelled < 24hrs</div>
                        <div class="trigger"><strong>Actions:</strong> Alert front desk, Check waitlist for fill-in, Calculate cancellation fee if policy applies</div>
                    </div>

                    <div class="integration-card">
                        <h4>‚úçÔ∏è Form Triggers</h4>
                        <div class="trigger"><strong>Trigger:</strong> Patient completes medical history online</div>
                        <div class="trigger"><strong>Actions:</strong> Save to patient record, Flag for practitioner review, Send confirmation "Forms received!", Remove "incomplete forms" alert</div>
                        <div class="trigger"><strong>Trigger:</strong> Consent form signed on iPad</div>
                        <div class="trigger"><strong>Actions:</strong> Lock form (no edits), Attach to treatment record, Store signature image, Email copy to patient</div>
                    </div>
                </div>

                <div class="note">
                    <strong>The Magic:</strong> With 50+ automation triggers, staff spend less time on manual tasks and more time on patient care. The system works 24/7 sending reminders, following up, and managing data - so humans don't have to.
                </div>
            </div>
        </div>

        <!-- VOICE AI STRATEGY TAB -->
        <div class="tab-content" id="voice-ai">
            <div class="section">
                <div class="hero-voice">
                    <h2>üé§ The Competitive Advantage</h2>
                    <p><strong>Voice AI eliminates 60-80% of manual data entry</strong> while keeping the human touch that patients expect in medical services. Staff verify instead of typing everything from scratch.</p>
                </div>

                <h2 class="section-title">Core Philosophy: AI Assists, Humans Decide</h2>

                <div class="note">
                    <strong>The Golden Rule:</strong> Voice AI should make staff faster and more accurate, NOT replace human judgment or patient interaction. Patients call because they want to talk to a real person. AI listens in the background, extracts data, and prepares everything so staff can focus on the conversation, not data entry.
                </div>

                <div class="use-case-grid" style="grid-template-columns: 1fr 1fr;">
                    <div>
                        <h3 style="color: #28a745; margin-bottom: 15px;">‚úÖ DO Use Voice AI For:</h3>
                        <ul class="benefits-list">
                            <li>Extracting structured data from conversations</li>
                            <li>Auto-filling forms while staff talks to patient</li>
                            <li>Dictating notes hands-free</li>
                            <li>Quick commands ("Book Sarah for Botox tomorrow 2pm")</li>
                            <li>Drafting SMS replies for staff approval</li>
                            <li>Medical transcription (SOAP notes)</li>
                        </ul>
                    </div>
                    <div>
                        <h3 style="color: #dc3545; margin-bottom: 15px;">‚ùå DON'T Use Voice AI For:</h3>
                        <ul class="concerns-list">
                            <li>Fully automated patient conversations</li>
                            <li>Making booking decisions without staff approval</li>
                            <li>Discussing medical advice autonomously</li>
                            <li>Processing payments without verification</li>
                            <li>Anything that removes human empathy</li>
                            <li>Replacing staff interactions</li>
                        </ul>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top: 60px;">üî• High-Value Use Cases (Build These First)</h2>

                <div class="use-case-grid">
                    <!-- Use Case 1: Phone Booking -->
                    <div class="use-case-card high-value">
                        <div class="use-case-header">
                            <div class="use-case-title">1. Phone Booking Assistant</div>
                            <span class="value-badge high">HIGH ROI</span>
                        </div>
                        <div class="use-case-description">
                            AI listens to front desk phone calls with patients. While the staff member has a natural conversation, AI extracts booking details in real-time and auto-fills the booking form.
                        </div>

                        <div class="workflow-example">
                            <h4>How It Works:</h4>
                            <div class="workflow-step">
                                <div class="step-icon">1</div>
                                <div>Front desk answers: "Thanks for calling Luxe! How can I help you?" Patient: "Hi, I'd like to book Botox for next Wednesday if possible."</div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon ai">AI</div>
                                <div><strong>AI extracts:</strong> Service = "Botox", Preferred day = "Wednesday"</div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon">2</div>
                                <div>Staff: "Great! What's your name?" Patient: "Sarah Johnson"</div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon ai">AI</div>
                                <div><strong>AI auto-fills:</strong> Patient name field, searches existing patients for match</div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon human">‚úì</div>
                                <div><strong>Staff reviews:</strong> All fields pre-filled. Clicks "Book". Done in 60 seconds instead of 3 minutes.</div>
                            </div>
                        </div>

                        <ul class="benefits-list">
                            <li><strong>Time saved:</strong> 2-3 minutes per booking call</li>
                            <li><strong>Errors reduced:</strong> No typos in names/phones</li>
                            <li><strong>Staff focus:</strong> Conversation quality, not typing</li>
                            <li><strong>Frequency:</strong> 20-30 booking calls per day</li>
                        </ul>
                    </div>

                    <!-- Use Case 2: Treatment Charting -->
                    <div class="use-case-card high-value">
                        <div class="use-case-header">
                            <div class="use-case-title">2. Treatment Charting Dictation</div>
                            <span class="value-badge high">HIGH ROI</span>
                        </div>
                        <div class="use-case-description">
                            Practitioners dictate SOAP notes while performing treatment instead of typing afterwards. Hands stay free, charting is real-time.
                        </div>

                        <div class="workflow-example">
                            <h4>Practitioner During Treatment:</h4>
                            <div class="workflow-step">
                                <div class="step-icon">üé§</div>
                                <div><em>"Starting Botox treatment. Patient reports mild headaches, wants forehead and crow's feet. Injecting 20 units forehead, 12 units crow's feet each side. Total 44 units. Patient tolerated well, no adverse reactions."</em></div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon ai">AI</div>
                                <div><strong>AI structures into SOAP:</strong><br>
                                ‚Ä¢ Subjective: "Patient reports mild headaches"<br>
                                ‚Ä¢ Objective: "Forehead and crow's feet"<br>
                                ‚Ä¢ Plan: "20u forehead, 24u crow's feet, total 44u"<br>
                                ‚Ä¢ Products: Botox 44 units
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon human">‚úì</div>
                                <div><strong>Practitioner reviews:</strong> Quick scan, confirms, clicks "Sign". 30 seconds instead of 5 minutes.</div>
                            </div>
                        </div>

                        <ul class="benefits-list">
                            <li><strong>Time saved:</strong> 4-5 minutes per treatment</li>
                            <li><strong>Quality improved:</strong> Real-time documentation</li>
                            <li><strong>No end-of-day backlog</strong></li>
                            <li><strong>Better compliance</strong></li>
                        </ul>
                    </div>

                    <!-- Use Case 3: SMS Reply -->
                    <div class="use-case-card high-value">
                        <div class="use-case-header">
                            <div class="use-case-title">3. Smart SMS Reply Suggestions</div>
                            <span class="value-badge high">HIGH ROI</span>
                        </div>
                        <div class="use-case-description">
                            When patients text, AI drafts 2-3 appropriate reply options. Staff selects best one, edits if needed, and sends.
                        </div>

                        <div class="workflow-example">
                            <h4>Patient Incoming SMS:</h4>
                            <div class="workflow-step">
                                <div class="step-icon">üì±</div>
                                <div><strong>Patient:</strong> "I need to move my appointment tomorrow to later in the week"</div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon ai">AI</div>
                                <div><strong>Suggested replies:</strong><br>
                                1Ô∏è‚É£ "No problem! I have Friday at 2pm or Saturday at 11am available. Which works better?"<br>
                                2Ô∏è‚É£ "Of course! What days work best for you this week?"
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-icon human">‚úì</div>
                                <div><strong>Staff selects option 1,</strong> maybe tweaks time, sends. 10 seconds instead of 2 minutes.</div>
                            </div>
                        </div>

                        <ul class="benefits-list">
                            <li><strong>Time saved:</strong> 1-2 minutes per SMS</li>
                            <li><strong>Consistency:</strong> Professional tone maintained</li>
                            <li><strong>Frequency:</strong> 50-100 patient texts per day</li>
                        </ul>
                    </div>

                    <!-- Use Case 4: Voice Intake -->
                    <div class="use-case-card high-value">
                        <div class="use-case-header">
                            <div class="use-case-title">4. Voice Medical Intake</div>
                            <span class="value-badge high">HIGH ROI</span>
                        </div>
                        <div class="use-case-description">
                            New patient speaks medical history instead of typing forms. AI asks follow-up questions and structures responses.
                        </div>

                        <ul class="benefits-list">
                            <li><strong>Completion rate:</strong> 2-3x higher than typing</li>
                            <li><strong>Accuracy:</strong> AI confirms ambiguous responses</li>
                            <li><strong>Better for older patients</strong></li>
                            <li><strong>Time saved:</strong> 10-15 minutes per new patient</li>
                        </ul>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top: 60px;">‚öôÔ∏è Technical Implementation Strategy</h2>

                <div class="tech-stack">
                    <h3>Recommended Tech Stack</h3>

                    <div class="tech-item">
                        <strong>Speech-to-Text:</strong> OpenAI Whisper API or AssemblyAI
                        <br><em>Why:</em> High accuracy for medical terminology, real-time transcription (~$0.006/min)
                    </div>

                    <div class="tech-item">
                        <strong>AI Processing:</strong> Claude (Anthropic) via API or MCP
                        <br><em>Why:</em> Excellent at instruction-following, structured data extraction, HIPAA-compliant with BAA
                    </div>

                    <div class="tech-item">
                        <strong>Voice Input:</strong> Browser Web Speech API (Chrome/Safari built-in)
                        <br><em>Why:</em> No extra cost, works on desktop and mobile, real-time streaming
                    </div>

                    <div class="tech-item">
                        <strong>Phone Call Integration:</strong> Twilio Voice API + Stream
                        <br><em>Why:</em> Already using Twilio for SMS, can stream phone audio to Whisper for real-time transcription
                    </div>
                </div>

                <div class="cost-estimate">
                    <h3>üí∞ Cost Estimate (500 patients/month practice)</h3>

                    <table class="comparison-table">
                        <tr>
                            <th>Service</th>
                            <th>Usage</th>
                            <th>Cost/Month</th>
                        </tr>
                        <tr>
                            <td>OpenAI Whisper API</td>
                            <td>~100 hours of audio</td>
                            <td>$36</td>
                        </tr>
                        <tr>
                            <td>Claude API</td>
                            <td>~10M tokens</td>
                            <td>$30</td>
                        </tr>
                        <tr>
                            <td>Twilio Voice Streaming</td>
                            <td>~500 phone calls</td>
                            <td>$25</td>
                        </tr>
                        <tr>
                            <td>Storage & Processing</td>
                            <td>AWS/Vercel hosting</td>
                            <td>$50</td>
                        </tr>
                        <tr style="border-top: 3px solid #333; font-weight: bold;">
                            <td>TOTAL</td>
                            <td></td>
                            <td>~$141/month</td>
                        </tr>
                    </table>

                    <div class="note">
                        <strong>ROI Calculation:</strong> If voice AI saves each staff member 2 hours per week, that's 8 hours/month √ó $20/hour = $160/month saved per employee. With 2 front desk staff, that's $320/month savings for $141/month cost. <strong>Pays for itself 2.2x over.</strong>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top: 60px;">üó∫Ô∏è Implementation Roadmap (Priority Order)</h2>

                <div class="implementation-priority">
                    <div class="priority-number">1</div>
                    <div>
                        <strong>Phase 1: Phone Booking Assistant (Weeks 1-2)</strong>
                        <div style="color: #666; margin-top: 8px;">
                            Integrate Twilio call streaming ‚Üí Whisper transcription ‚Üí Claude extraction ‚Üí Auto-fill booking form. Test with 10 real calls, measure time savings.
                        </div>
                    </div>
                </div>

                <div class="implementation-priority">
                    <div class="priority-number">2</div>
                    <div>
                        <strong>Phase 2: SMS Reply Suggestions (Weeks 3-4)</strong>
                        <div style="color: #666; margin-top: 8px;">
                            When patient SMS arrives, Claude analyzes and generates 3 reply options. Front desk clicks to select and send.
                        </div>
                    </div>
                </div>

                <div class="implementation-priority">
                    <div class="priority-number">3</div>
                    <div>
                        <strong>Phase 3: Treatment Dictation (Weeks 5-6)</strong>
                        <div style="color: #666; margin-top: 8px;">
                            Add microphone button to iPad charting. Practitioner dictates, Claude structures into SOAP format.
                        </div>
                    </div>
                </div>

                <div class="implementation-priority">
                    <div class="priority-number">4</div>
                    <div>
                        <strong>Phase 4: Voice Medical Intake (Weeks 7-8)</strong>
                        <div style="color: #666; margin-top: 8px;">
                            Add voice option to patient portal intake forms. Claude asks questions, patient speaks answers, data auto-fills.
                        </div>
                    </div>
                </div>

                <div class="implementation-priority">
                    <div class="priority-number">5</div>
                    <div>
                        <strong>Phase 5: Quick Voice Commands (Weeks 9-10)</strong>
                        <div style="color: #666; margin-top: 8px;">
                            Add "Hey Luxe" wake word for voice commands. Start with 10 common commands (search patient, show schedule, create task).
                        </div>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top: 60px;">üîí Privacy, Security & HIPAA Compliance</h2>

                <div class="note">
                    <strong>HIPAA Requirements for Voice AI:</strong>
                </div>

                <ul class="benefits-list">
                    <li><strong>Business Associate Agreement (BAA):</strong> Sign BAA with Claude (Anthropic), Whisper (OpenAI), and Twilio</li>
                    <li><strong>Encryption:</strong> All audio must be encrypted in transit (TLS) and at rest (AES-256)</li>
                    <li><strong>Data Retention:</strong> Audio recordings deleted after processing, only keep text transcripts if medically necessary</li>
                    <li><strong>Access Controls:</strong> Only authorized staff can access voice transcriptions, audit logs of all access</li>
                    <li><strong>Patient Consent:</strong> Inform patients that calls may be transcribed for quality and record-keeping</li>
                </ul>

                <div class="tech-item" style="margin-top: 20px;">
                    <strong>Recommended Architecture:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>Audio captured on device/server (HIPAA-compliant infrastructure)</li>
                        <li>Sent to Whisper API via encrypted connection (OpenAI has BAA available)</li>
                        <li>Text transcript sent to Claude API (Anthropic has BAA)</li>
                        <li>Structured data returned to Luxe EMR database</li>
                        <li>Original audio deleted within 24 hours (only keep text)</li>
                        <li>All access logged in audit trail</li>
                    </ol>
                </div>

                <h2 class="section-title" style="margin-top: 60px;">‚úÖ Success Metrics to Track</h2>

                <ul class="benefits-list">
                    <li><strong>Time per booking call:</strong> Baseline 3-5 minutes ‚Üí Target 1-2 minutes</li>
                    <li><strong>SMS reply time:</strong> Baseline 2-3 minutes ‚Üí Target 15-30 seconds</li>
                    <li><strong>Charting time per treatment:</strong> Baseline 5-7 minutes ‚Üí Target 30-60 seconds</li>
                    <li><strong>New patient intake completion rate:</strong> Baseline 40-50% ‚Üí Target 80-90%</li>
                    <li><strong>Data entry errors:</strong> Track reduction in name/phone typos</li>
                    <li><strong>Staff satisfaction:</strong> Survey staff monthly on voice AI helpfulness</li>
                </ul>

                <div class="note warning" style="margin-top: 30px;">
                    <strong>‚ö†Ô∏è Important:</strong> Always show staff what the AI extracted and let them verify before committing. AI should never silently update records. The workflow is: <strong>AI drafts ‚Üí Human verifies ‚Üí Human commits.</strong> This keeps humans in control while eliminating 80% of the typing work.
                </div>
            </div>
        </div>

        <!-- COMPETITIVE ANALYSIS (SWOT) TAB -->
        <div class="tab-content" id="competitors">
            <div class="section">
                <h2 class="section-title">üèÜ Mango Mint SWOT Analysis</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    Comprehensive Strengths, Weaknesses, Opportunities, and Threats analysis of our primary competitor across all 19 feature categories.
                </p>

                <!-- Executive Summary -->
                <div class="legend" style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 25px; border-radius: 15px; margin-bottom: 40px;">
                    <h3 style="width: 100%; margin-bottom: 15px; color: #333;">üìä Executive Summary</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #667eea;">360+</div>
                            <div style="color: #666;">Features Analyzed</div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #dc3545;">34%</div>
                            <div style="color: #666;">Current Parity</div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #28a745;">19</div>
                            <div style="color: #666;">Categories</div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #ffc107;">5</div>
                            <div style="color: #666;">Key Differentiators</div>
                        </div>
                    </div>
                </div>

                <!-- Category 1: Calendar & Appointments -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #dc3545;">
                    <h3 style="color: #333; margin-bottom: 15px;">üìÖ 1. Calendar & Appointments <span style="background: #dc3545; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P0 Critical</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">51 articles analyzed | 15+ features</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Express Booking‚Ñ¢</strong> - SMS booking with payment</li>
                                <li><strong>Group Booking</strong> - Wedding parties, events</li>
                                <li><strong>Time Blocks</strong> - Drag-resize visual blocking</li>
                                <li><strong>Virtual Waiting Room</strong> - Digital check-in</li>
                                <li><strong>Intelligent Waitlist</strong> - Auto-match cancellations</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>No AI Scheduling</strong> - Manual only</li>
                                <li><strong>No Predictive No-Shows</strong> - Reactive</li>
                                <li><strong>Generic Calendar</strong> - Not medical-specific</li>
                                <li><strong>No Processing Optimization</strong> - Limited multi-phase</li>
                                <li><strong>No Load Balancing</strong> - Manual workload</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>AI-powered schedule optimization</li>
                                <li>Treatment-specific calendar views</li>
                                <li>Smart buffer times for injectables</li>
                                <li>No-show risk scoring with ML</li>
                                <li>Voice booking assistant</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Express Booking‚Ñ¢ is strong differentiator</li>
                                <li>Established user base = switching costs</li>
                                <li>Could add AI features later</li>
                                <li>Mature integration ecosystem</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Category 2: Payments & Checkout -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #ffc107;">
                    <h3 style="color: #333; margin-bottom: 15px;">üí≥ 2. Payments & Checkout <span style="background: #ffc107; color: #333; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P1 High</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">31 articles analyzed | 10+ features</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Multi-Payment Types</strong> - Cards, cash, gift cards</li>
                                <li><strong>Self Checkout</strong> - SMS mobile payment</li>
                                <li><strong>Cards on File</strong> - Secure storage</li>
                                <li><strong>Split Payments</strong> - Multiple methods</li>
                                <li><strong>Dispute Management</strong> - Built-in handling</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>No BNPL</strong> - No Affirm, Klarna, Cherry</li>
                                <li><strong>No Medical Financing</strong> - Limited options</li>
                                <li><strong>No Subscription Billing</strong> - Basic recurring</li>
                                <li><strong>Basic Tip Management</strong> - Standard only</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>CareCredit, Cherry, Affirm integration</li>
                                <li>HSA/FSA payment processing</li>
                                <li>AI-calculated deposits (no-show risk)</li>
                                <li>Package prepayment (Botox units)</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Stripe integration is robust</li>
                                <li>Self Checkout UX is excellent</li>
                                <li>Card reader ecosystem mature</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Category 3: Client Management -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #ffc107;">
                    <h3 style="color: #333; margin-bottom: 15px;">üë• 3. Client Management <span style="background: #ffc107; color: #333; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P1 High</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">37 articles analyzed | 7+ features</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Client Portal</strong> - Self-service management</li>
                                <li><strong>Account Balances</strong> - Prepaid credits</li>
                                <li><strong>Client Timeline</strong> - Full history</li>
                                <li><strong>Advanced Filters</strong> - Segmentation</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>No Before/After Photos</strong> - Limited photo mgmt</li>
                                <li><strong>No Medical History</strong> - Basic info only</li>
                                <li><strong>No AI Recommendations</strong> - Manual suggestions</li>
                                <li><strong>No Fitzpatrick Tracking</strong> - No skin types</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Before/after photo library w/ consent</li>
                                <li>Medical history + contraindications</li>
                                <li>Fitzpatrick skin typing (laser safety)</li>
                                <li>AI treatment recommendations</li>
                                <li>Family account management</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Client portal well-established</li>
                                <li>Works well for non-medical spas</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Category 4: Staff & Payroll -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #28a745;">
                    <h3 style="color: #333; margin-bottom: 15px;">üëî 4. Staff & Payroll <span style="background: #28a745; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P2 Medium</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">38 articles analyzed | 9+ features</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Full Payroll</strong> - Complete with tax filing</li>
                                <li><strong>Time Clock</strong> - PIN-based clock in/out</li>
                                <li><strong>Commission Tracking</strong> - Multiple models</li>
                                <li><strong>Direct Deposit</strong> - Multi-account splitting</li>
                                <li><strong>Tax Documents</strong> - W-2s, 1099s auto-generated</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>No Credential Tracking</strong> - No RN/NP licenses</li>
                                <li><strong>No DEA Tracking</strong> - No controlled substance</li>
                                <li><strong>No Skill-Based Routing</strong> - Manual assignment</li>
                                <li><strong>No Certification Tracking</strong> - No laser certs</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Medical credential management</li>
                                <li>License expiration alerts</li>
                                <li>DEA number tracking</li>
                                <li>Skill-based patient routing</li>
                                <li>Provider performance analytics</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Full payroll is major selling point</li>
                                <li>Switching payroll is painful</li>
                                <li>Tax automation reduces burden</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Category 5: Marketing & Automation -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #ffc107;">
                    <h3 style="color: #333; margin-bottom: 15px;">üì£ 5. Marketing & Automation <span style="background: #ffc107; color: #333; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P1 High</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">26 articles analyzed | 8+ features</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Email Campaigns</strong> - Built-in marketing</li>
                                <li><strong>Client Segmentation</strong> - Filter targeting</li>
                                <li><strong>Automated Flows</strong> - Trigger-based</li>
                                <li><strong>SMS Automation</strong> - Text sequences</li>
                                <li><strong>Flow Builder</strong> - Visual designer</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>No AI Personalization</strong> - Rule-based only</li>
                                <li><strong>No Predictive Timing</strong> - Manual send times</li>
                                <li><strong>No Revenue Attribution</strong> - Hard to track ROI</li>
                                <li><strong>Generic Reminders</strong> - Not treatment-specific</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>AI treatment recommendations</li>
                                <li>"Time for your Botox touchup" automation</li>
                                <li>Treatment-specific follow-ups</li>
                                <li>Revenue attribution tracking</li>
                                <li>Behavioral triggers</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Built-in marketing reduces tools</li>
                                <li>SMS has high engagement</li>
                                <li>Easy setup = adoption</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Category 6: Compliance & Setup -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #dc3545;">
                    <h3 style="color: #333; margin-bottom: 15px;">üîí 6. Compliance & Business Setup <span style="background: #dc3545; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">P0 Critical</span></h3>
                    <p style="color: #666; margin-bottom: 20px;">33 articles analyzed | Legal requirement for medical spas</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">üí™ Strengths</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Multi-Location</strong> - Manage multiple sites</li>
                                <li><strong>Booth Renter Support</strong> - Independent contractors</li>
                                <li><strong>Data Import</strong> - Migration assistance</li>
                                <li><strong>Basic Security</strong> - Standard encryption</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">üìâ Weaknesses</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li><strong>Basic HIPAA</strong> - Not medical-grade</li>
                                <li><strong>No BAA Automation</strong> - Manual agreements</li>
                                <li><strong>No Audit Logging</strong> - Limited access logs</li>
                                <li><strong>No PHI Encryption</strong> - Standard only</li>
                                <li><strong>No Compliance Dashboard</strong> - No monitoring</li>
                            </ul>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #1976d2; margin-bottom: 10px;">üéØ Opportunities</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Full HIPAA compliance suite</li>
                                <li>Automated BAA management</li>
                                <li>Complete audit trail</li>
                                <li>PHI-specific encryption</li>
                                <li>Real-time compliance monitoring</li>
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">‚ö†Ô∏è Threats</h4>
                            <ul style="margin-left: 15px; color: #333;">
                                <li>Basic compliance may be "good enough" for some</li>
                                <li>Salon customers don't need HIPAA</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Strategic Summary Section -->
                <h3 class="section-subtitle" style="margin-top: 50px;">üéØ Strategic Summary</h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <!-- Must Match -->
                    <div class="integration-card" style="background: #ffebee; border-color: #dc3545;">
                        <h4 style="color: #dc3545; margin-bottom: 15px;">üî¥ Must Match (Their Strengths)</h4>
                        <ul style="margin-left: 15px;">
                            <li>SMS-First Automation (Express Booking)</li>
                            <li>Group Booking System</li>
                            <li>Virtual Waiting Room</li>
                            <li>Intelligent Waitlist</li>
                            <li>Self Checkout</li>
                        </ul>
                    </div>

                    <!-- Our Advantages -->
                    <div class="integration-card" style="background: #e8f5e9; border-color: #28a745;">
                        <h4 style="color: #28a745; margin-bottom: 15px;">üü¢ Our Advantages (Their Weaknesses)</h4>
                        <ul style="margin-left: 15px;">
                            <li>Medical-specific features</li>
                            <li>Before/after photos</li>
                            <li>Fitzpatrick skin typing</li>
                            <li>Lot number tracking</li>
                            <li>Unit-based packages</li>
                        </ul>
                    </div>

                    <!-- Differentiation -->
                    <div class="integration-card" style="background: #e3f2fd; border-color: #1976d2;">
                        <h4 style="color: #1976d2; margin-bottom: 15px;">üîµ Differentiation Strategy</h4>
                        <ul style="margin-left: 15px;">
                            <li><strong>AI-Powered</strong> - Smarter than rule-based</li>
                            <li><strong>Medical Focus</strong> - Built for med spas</li>
                            <li><strong>Outcome Tracking</strong> - Measurable results</li>
                            <li><strong>HIPAA-First</strong> - True compliance</li>
                            <li><strong>Injectable Optimization</strong> - Perfect for Botox</li>
                        </ul>
                    </div>
                </div>

                <!-- Implementation Priority -->
                <h3 class="section-subtitle">üìã Implementation Priority</h3>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.95em;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Priority</th>
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Features</th>
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Timeline</th>
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #ffebee;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #dc3545;">P0 Critical</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Virtual Waiting Room, Time Blocks, Express Booking, HIPAA Foundation</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Next 30 days</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Core functionality + compliance</td>
                            </tr>
                            <tr style="background: #fff3e0;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #ff9800;">P1 High</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Group Booking, Resource Management, Intelligent Waitlist, Enhanced Forms</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Next 60 days</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Competitive parity</td>
                            </tr>
                            <tr style="background: #e8f5e9;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #28a745;">P2 Medium</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Marketing Automation, Advanced Payments, Staff Management, Reporting</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Next 90 days</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Enhanced experience</td>
                            </tr>
                            <tr style="background: #e3f2fd;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #1976d2;">Differentiators</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">AI Scheduling, Treatment Analytics, Voice AI, Medical Credentials</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Ongoing</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Competitive advantage</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="note" style="background: #e7f9ed; border-color: #28a745; margin-top: 30px;">
                    <strong style="color: #28a745;">Key Insight:</strong> Mango Mint is a <strong>generic salon/spa platform</strong> adapted for medical spas. Our opportunity is to be the <strong>medical-first platform</strong> that happens to also work for regular spas. By focusing on HIPAA compliance, medical credentials, treatment outcomes, and injectable-specific workflows, we can capture the premium medical spa market where Mango Mint is weakest.
                </div>

                <div class="note warning" style="margin-top: 20px;">
                    <strong>Full Analysis:</strong> Complete SWOT analysis with all 13 categories available at: <code>/docs/competitor_analysis/MANGOMINT_SWOT_ANALYSIS.md</code>
                </div>
            </div>
        </div>

        <!-- OPPORTUNITIES & GAPS TAB -->
        <div class="tab-content" id="gaps">
            <div class="section">
                <h2 class="section-title">Seamless Opportunities & Current Gaps</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    Areas where we can add seamless automation or fix current gaps in the workflow.
                </p>

                <h3 class="section-subtitle">‚úÖ What We're Doing Right</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="background: #e7f9ed;">
                        <h4 style="color: #28a745;">Virtual Waiting Room</h4>
                        <div class="trigger">‚úì SMS check-in</div>
                        <div class="trigger">‚úì Queue management</div>
                        <div class="trigger">‚úì Room ready notifications</div>
                        <div class="trigger">‚úì Priority handling</div>
                    </div>

                    <div class="integration-card" style="background: #e7f9ed;">
                        <h4 style="color: #28a745;">Automated Messaging</h4>
                        <div class="trigger">‚úì Appointment confirmations</div>
                        <div class="trigger">‚úì Reminder sequences</div>
                        <div class="trigger">‚úì Aftercare instructions</div>
                        <div class="trigger">‚úì Follow-up sequences</div>
                    </div>

                    <div class="integration-card" style="background: #e7f9ed;">
                        <h4 style="color: #28a745;">Treatment Charting</h4>
                        <div class="trigger">‚úì iPad app for practitioners</div>
                        <div class="trigger">‚úì SOAP notes</div>
                        <div class="trigger">‚úì Before/after photos</div>
                        <div class="trigger">‚úì Digital signatures</div>
                    </div>

                    <div class="integration-card" style="background: #e7f9ed;">
                        <h4 style="color: #28a745;">Online Booking</h4>
                        <div class="trigger">‚úì Patient portal</div>
                        <div class="trigger">‚úì Real-time availability</div>
                        <div class="trigger">‚úì Instant confirmations</div>
                        <div class="trigger">‚úì Calendar sync</div>
                    </div>
                </div>

                <h3 class="section-subtitle">‚ö†Ô∏è Gaps & Opportunities</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Waitlist Management</h4>
                        <div class="trigger"><strong>Gap:</strong> No automated waitlist when appointments cancel</div>
                        <div class="trigger"><strong>Solution:</strong> When cancellation occurs, auto-text waitlist patients "Spot opened up on [date] at [time]. Reply YES to book!"</div>
                        <div class="trigger"><strong>Impact:</strong> Fill 80% of last-minute cancellations, Increase revenue by ~$10K/month</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Smart Scheduling</h4>
                        <div class="trigger"><strong>Gap:</strong> No AI-powered optimal booking suggestions</div>
                        <div class="trigger"><strong>Solution:</strong> AI suggests best time slots based on: Patient history (prefers mornings?), Practitioner efficiency (works faster 2-5pm), Treatment type (Botox takes 20min, not 30min with Dr. Smith)</div>
                        <div class="trigger"><strong>Impact:</strong> Book 2-3 more patients per day, Reduce practitioner idle time</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Pre-Visit Preparation</h4>
                        <div class="trigger"><strong>Gap:</strong> Patients arrive unprepared (makeup on, took blood thinners)</div>
                        <div class="trigger"><strong>Solution:</strong> 24hr reminder includes treatment-specific prep: "Tomorrow's Botox: Arrive makeup-free, avoid alcohol 24hrs, no blood thinners"</div>
                        <div class="trigger"><strong>Impact:</strong> Reduce appointment delays, Improve treatment outcomes</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Upsell Automation</h4>
                        <div class="trigger"><strong>Gap:</strong> Front desk forgets to mention add-ons</div>
                        <div class="trigger"><strong>Solution:</strong> At checkout, system suggests: "Sarah's been coming for Botox for 6 months. Suggest adding filler for better results? [Yes] [No]"</div>
                        <div class="trigger"><strong>Impact:</strong> Increase average ticket by 30%, More comprehensive patient care</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Treatment Series Tracking</h4>
                        <div class="trigger"><strong>Gap:</strong> No automatic booking for treatment series (e.g., laser requires 6 sessions)</div>
                        <div class="trigger"><strong>Solution:</strong> When booking laser treatment #1, system asks: "This requires 6 sessions. Book all now?" ‚Üí Auto-schedules 4-6 weeks apart</div>
                        <div class="trigger"><strong>Impact:</strong> Ensure treatment compliance, Lock in revenue upfront, Better patient outcomes</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Review Request Timing</h4>
                        <div class="trigger"><strong>Gap:</strong> Asking for reviews too early (results not visible yet)</div>
                        <div class="trigger"><strong>Solution:</strong> Treatment-specific review timing: Botox ‚Üí 2 weeks (full results), Laser ‚Üí 1 month (redness gone), Filler ‚Üí 2 weeks (swelling resolved)</div>
                        <div class="trigger"><strong>Impact:</strong> 3x more positive reviews, Better online reputation</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">No-Show Prediction</h4>
                        <div class="trigger"><strong>Gap:</strong> Can't predict who will no-show</div>
                        <div class="trigger"><strong>Solution:</strong> AI scores each appointment: New patient + unconfirmed + no payment on file = 60% no-show risk ‚Üí Send extra reminder or require prepayment</div>
                        <div class="trigger"><strong>Impact:</strong> Reduce no-shows by 50%, Double-book high-risk slots</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Inventory Forecasting</h4>
                        <div class="trigger"><strong>Gap:</strong> Running out of Botox mid-week</div>
                        <div class="trigger"><strong>Solution:</strong> AI predicts weekly usage based on: Scheduled appointments, Historical usage per patient, Seasonal trends ‚Üí Auto-orders when stock will run out in 3 days</div>
                        <div class="trigger"><strong>Impact:</strong> Never run out of products, Optimize cash flow</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Membership Retention</h4>
                        <div class="trigger"><strong>Gap:</strong> Members cancel without warning</div>
                        <div class="trigger"><strong>Solution:</strong> Track engagement: Credits unused 2 months in a row ‚Üí "At risk" flag ‚Üí Manager calls: "How can we help you use your membership?"</div>
                        <div class="trigger"><strong>Impact:</strong> Retain 30% more members, Recurring revenue stability</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Cross-Location Scheduling</h4>
                        <div class="trigger"><strong>Gap:</strong> Patients don't know they can go to other locations</div>
                        <div class="trigger"><strong>Solution:</strong> When booking shows "No availability at Downtown", suggest: "Would you like to see Dr. Smith at Westside location? Available tomorrow at 2pm"</div>
                        <div class="trigger"><strong>Impact:</strong> Fill empty slots at other locations, Better patient convenience</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Staff Performance Insights</h4>
                        <div class="trigger"><strong>Gap:</strong> Don't know which staff are best at upselling, booking, etc.</div>
                        <div class="trigger"><strong>Solution:</strong> Track metrics: Average ticket per staff member, Upsell success rate, Patient satisfaction by practitioner ‚Üí Use for training and bonuses</div>
                        <div class="trigger"><strong>Impact:</strong> Reward top performers, Train struggling staff, Increase overall revenue</div>
                    </div>

                    <div class="integration-card" style="background: #fff3e0; border-color: #ff9800;">
                        <h4 style="color: #ff9800;">Patient Lifecycle Value</h4>
                        <div class="trigger"><strong>Gap:</strong> Don't track lifetime value or identify VIP patients automatically</div>
                        <div class="trigger"><strong>Solution:</strong> Calculate LTV (total spent + projected future revenue) ‚Üí Auto-tag VIPs (>$5K spent) ‚Üí Give priority in waiting room, exclusive offers, birthday gifts</div>
                        <div class="trigger"><strong>Impact:</strong> Retain high-value patients, Focus marketing on best customers</div>
                    </div>
                </div>

                <div class="note" style="background: #e7f9ed; border-color: #28a745;">
                    <strong style="color: #28a745;">Next Steps:</strong> Prioritize these gaps by ROI (return on investment). Start with quick wins like automated waitlist texts (1 week to build, huge impact). Then tackle AI-powered features like no-show prediction (2-3 weeks to build, requires historical data).
                </div>
            </div>
        </div>

        <!-- INTEGRATIONS TAB -->
        <div class="tab-content" id="integrations">
            <div class="section">
                <h2 class="section-title">üîå Med Spa Integration Ecosystem</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    Based on extensive Reddit research, industry forums, and competitor analysis. These are the integrations med spa owners are actively requesting.
                </p>

                <!-- Integration Priority Matrix -->
                <div class="legend" style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 25px; border-radius: 15px; margin-bottom: 40px;">
                    <h3 style="width: 100%; margin-bottom: 15px; color: #333;">Priority Legend</h3>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #dc3545;"></div>
                        <span><strong>Critical</strong> - Must have for launch</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #ffc107;"></div>
                        <span><strong>High</strong> - Key differentiator</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #28a745;"></div>
                        <span><strong>Medium</strong> - Nice to have</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #6c757d;"></div>
                        <span><strong>Future</strong> - Phase 2+</span>
                    </div>
                </div>

                <!-- COMPETITOR INTEGRATION COMPARISON -->
                <h3 class="section-subtitle">üìä Competitor Integration Comparison</h3>
                <div style="overflow-x: auto; margin-bottom: 40px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.95em;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Integration</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">Mangomint</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">Boulevard</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">Aesthetic Record</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">Zenoti</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd; background: #28a745;">MedSpot (Target)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Zapier</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Priority</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Google Calendar</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ One-way</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ö†Ô∏è Limited</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Two-way</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">QuickBooks</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ö†Ô∏è Manual</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Auto-sync</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Stripe Payments</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Yes</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Cherry/PatientFi</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Cherry</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ö†Ô∏è Limited</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Both</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Allƒì/ASPIRE Loyalty</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ö†Ô∏è Manual</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #fff3cd;">üéØ Opportunity!</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Voice AI Receptionist</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #fff3cd;">üéØ Differentiator!</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Shopify E-commerce</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Yes</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Mailchimp/Klaviyo</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚úÖ Yes</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e7f9ed;">‚úÖ Yes</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">HIPAA-Compliant AI</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ùå No</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">‚ö†Ô∏è Basic</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #fff3cd;">üéØ Differentiator!</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- MANGOMINT DEEP DIVE -->
                <h3 class="section-subtitle">ü•≠ Mangomint Deep Dive</h3>
                <div class="note" style="background: #fff8e1; border-color: #ff9800; margin-bottom: 30px;">
                    <strong style="color: #ff9800;">Key Competitor:</strong> Mangomint has 363 documented features across 19 categories. They're strong on SMS automation but weak on medical-specific integrations.
                </div>

                <div class="integration-grid">
                    <div class="integration-card" style="border-color: #28a745;">
                        <h4 style="color: #28a745;">‚úÖ What Mangomint Has</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>Shopify</strong> - Inventory sync via SKU matching</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>Mailchimp</strong> - Client sync for email marketing</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>WaiverForever</strong> - Store forms on client timelines</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>Gift Up!</strong> - Auto-import gift cards</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>Webhooks</strong> - Custom event triggers (appointments, sales, forms)</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>Stripe</strong> - Payment processing</li>
                            <li style="padding: 8px 0;">‚Ä¢ <strong>QuickBooks</strong> - Accounting sync</li>
                        </ul>
                    </div>

                    <div class="integration-card" style="border-color: #dc3545;">
                        <h4 style="color: #dc3545;">‚ùå What Mangomint LACKS</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Zapier/Make</strong> - Major limitation for automation</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Allergan Allƒì</strong> - Manual loyalty tracking</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Galderma ASPIRE</strong> - No points integration</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Cherry/PatientFi</strong> - No embedded financing</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Voice AI</strong> - No AI receptionist</li>
                            <li style="padding: 8px 0; border-bottom: 1px solid #eee;">‚Ä¢ <strong>NO Before/After Photos</strong> - Limited clinical photography</li>
                            <li style="padding: 8px 0;">‚Ä¢ <strong>NO Injectable Tracking</strong> - No lot/expiration management</li>
                        </ul>
                    </div>
                </div>

                <!-- CRITICAL INTEGRATIONS -->
                <h3 class="section-subtitle">üî¥ Critical Integrations (Must Have for Launch)</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="background: #ffe5e5; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">üí≥ Payment Processing</h4>
                        <div class="trigger"><strong>Stripe:</strong> Primary processor - 2.9% + 30¬¢ online, 2.7% + 5¬¢ in-person</div>
                        <div class="trigger"><strong>Square:</strong> Alternative for mobile payments - Excellent hardware</div>
                        <div class="trigger" style="background: #fff3cd; border-left-color: #ffc107;"><strong>Why Critical:</strong> 100% of transactions flow through this</div>
                    </div>

                    <div class="integration-card" style="background: #ffe5e5; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">üè• HIPAA Compliance</h4>
                        <div class="trigger"><strong>E-Signature:</strong> DocuSign or PandaDoc with BAA</div>
                        <div class="trigger"><strong>Photo Storage:</strong> HIPAA-compliant cloud (AWS HIPAA, Google Cloud Healthcare)</div>
                        <div class="trigger" style="background: #fff3cd; border-left-color: #ffc107;"><strong>Why Critical:</strong> $120-$1.8M per HIPAA violation</div>
                    </div>

                    <div class="integration-card" style="background: #ffe5e5; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">üìÖ Calendar Sync</h4>
                        <div class="trigger"><strong>Google Calendar:</strong> Two-way sync for practitioners</div>
                        <div class="trigger"><strong>Apple Calendar:</strong> iCal feed support</div>
                        <div class="trigger"><strong>Outlook:</strong> Enterprise clients need this</div>
                        <div class="trigger" style="background: #fff3cd; border-left-color: #ffc107;"><strong>Why Critical:</strong> #1 requested feature on Reddit - practitioners manage personal calendars</div>
                    </div>

                    <div class="integration-card" style="background: #ffe5e5; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">üì± SMS/Communication</h4>
                        <div class="trigger"><strong>Twilio:</strong> SMS API - 95% open rate vs 20% email</div>
                        <div class="trigger"><strong>SendGrid:</strong> Transactional emails</div>
                        <div class="trigger" style="background: #fff3cd; border-left-color: #ffc107;"><strong>Why Critical:</strong> Appointment reminders reduce no-shows by 50%</div>
                    </div>
                </div>

                <!-- HIGH PRIORITY INTEGRATIONS -->
                <h3 class="section-subtitle">üü° High Priority Integrations (Competitive Differentiation)</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">üí∞ Patient Financing</h4>
                        <div class="trigger"><strong>Cherry:</strong> 80%+ approval rate, lowest merchant fees, up to $35K</div>
                        <div class="trigger"><strong>PatientFi:</strong> 0% APR up to 24 months, 40% approval</div>
                        <div class="trigger"><strong>CareCredit:</strong> Industry standard</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Impact:</strong> Avg ticket increases 40% when financing offered at checkout</div>
                    </div>

                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">üèÜ Manufacturer Loyalty Programs</h4>
                        <div class="trigger"><strong>Allergan Allƒì:</strong> Botox, Juvederm, SkinMedica points</div>
                        <div class="trigger"><strong>Galderma ASPIRE:</strong> Dysport, Restylane, Alastin</div>
                        <div class="trigger"><strong>Merz Xperience:</strong> Xeomin, Radiesse, Belotero</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Impact:</strong> NO competitor has native integration - HUGE opportunity!</div>
                    </div>

                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">üé§ Voice AI Receptionist</h4>
                        <div class="trigger"><strong>My AI Front Desk:</strong> 24/7 AI answering, CRM integration</div>
                        <div class="trigger"><strong>Smith.ai:</strong> Hybrid AI + human, 7000+ integrations</div>
                        <div class="trigger"><strong>Build Custom:</strong> HIPAA-compliant voice AI</div>
                        <div class="trigger" style="background: #ffe5e5; border-left-color: #dc3545;"><strong>Gap:</strong> Most AI solutions are NOT HIPAA compliant - major opportunity</div>
                    </div>

                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">üìä Accounting & Payroll</h4>
                        <div class="trigger"><strong>QuickBooks Online:</strong> Most requested - auto journal entries</div>
                        <div class="trigger"><strong>Xero:</strong> Cloud-first, 1000+ app integrations</div>
                        <div class="trigger"><strong>Gusto:</strong> Payroll with commission tracking</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Impact:</strong> Saves 5+ hours/week on manual reconciliation</div>
                    </div>

                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">‚ö° Automation Platform</h4>
                        <div class="trigger"><strong>Zapier:</strong> 4000+ app connections - Mangomint LACKS this!</div>
                        <div class="trigger"><strong>Make (Integromat):</strong> More complex workflows</div>
                        <div class="trigger"><strong>Webhooks:</strong> Custom event triggers</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Impact:</strong> Users can build custom automations without dev help</div>
                    </div>

                    <div class="integration-card" style="background: #fff8e1; border-color: #ffc107;">
                        <h4 style="color: #ff9800;">üì∏ Photo Management</h4>
                        <div class="trigger"><strong>RxPhoto:</strong> Before/after, integrates with PatientNow</div>
                        <div class="trigger"><strong>Custom Build:</strong> HIPAA-compliant photo storage</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Impact:</strong> 75% of consumers won't book without seeing before/afters</div>
                    </div>
                </div>

                <!-- MEDIUM PRIORITY -->
                <h3 class="section-subtitle">üü¢ Medium Priority Integrations</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="border-color: #28a745;">
                        <h4 style="color: #28a745;">üìß Marketing Automation</h4>
                        <div class="trigger"><strong>Mailchimp:</strong> Email campaigns, audience sync</div>
                        <div class="trigger"><strong>Klaviyo:</strong> E-commerce focused, better for product sales</div>
                        <div class="trigger"><strong>ActiveCampaign:</strong> Strong automation + CRM</div>
                    </div>

                    <div class="integration-card" style="border-color: #28a745;">
                        <h4 style="color: #28a745;">‚≠ê Reputation Management</h4>
                        <div class="trigger"><strong>Podium:</strong> Auto review requests via SMS, 4.8x more reviews</div>
                        <div class="trigger"><strong>Birdeye:</strong> Multi-platform review aggregation</div>
                        <div class="trigger"><strong>Google Business Profile:</strong> Direct booking from search</div>
                    </div>

                    <div class="integration-card" style="border-color: #28a745;">
                        <h4 style="color: #28a745;">üõí E-commerce</h4>
                        <div class="trigger"><strong>Shopify:</strong> Product inventory sync</div>
                        <div class="trigger"><strong>WooCommerce:</strong> WordPress integration</div>
                    </div>

                    <div class="integration-card" style="border-color: #28a745;">
                        <h4 style="color: #28a745;">üìã Forms & Consent</h4>
                        <div class="trigger"><strong>DocuSign:</strong> HIPAA-compliant e-signatures</div>
                        <div class="trigger"><strong>PandaDoc:</strong> 50K+ healthcare customers</div>
                        <div class="trigger"><strong>Jotform:</strong> Custom intake forms</div>
                    </div>
                </div>

                <!-- FUTURE PHASE -->
                <h3 class="section-subtitle">‚¨ú Future Phase Integrations</h3>
                <div class="integration-grid">
                    <div class="integration-card" style="border-color: #6c757d; background: #f8f9fa;">
                        <h4 style="color: #6c757d;">üè• Telehealth</h4>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Doxy.me:</strong> HIPAA-compliant video consultations</div>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Built-in:</strong> Custom telehealth solution</div>
                    </div>

                    <div class="integration-card" style="border-color: #6c757d; background: #f8f9fa;">
                        <h4 style="color: #6c757d;">üíä E-Prescribe</h4>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Surescripts:</strong> Electronic prescription network</div>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>DrFirst:</strong> E-prescribing platform</div>
                    </div>

                    <div class="integration-card" style="border-color: #6c757d; background: #f8f9fa;">
                        <h4 style="color: #6c757d;">üìä Advanced Analytics</h4>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Google Analytics 4:</strong> Web tracking</div>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Looker/Tableau:</strong> BI dashboards</div>
                    </div>

                    <div class="integration-card" style="border-color: #6c757d; background: #f8f9fa;">
                        <h4 style="color: #6c757d;">üè∑Ô∏è Inventory (Advanced)</h4>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Terso RFID:</strong> Smart enclosures for injectables</div>
                        <div class="trigger" style="border-left-color: #6c757d;"><strong>Lot/Expiration:</strong> Auto-deduction from charts</div>
                    </div>
                </div>

                <!-- REDDIT PAIN POINTS -->
                <h3 class="section-subtitle">üî• Top Pain Points from Reddit & Forums</h3>
                <div class="note" style="background: #ffe5e5; border-color: #dc3545; margin-bottom: 20px;">
                    <strong style="color: #dc3545;">Real User Complaints:</strong> These are the most common frustrations med spa owners share online.
                </div>
                <div class="integration-grid">
                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#1 Fragmented Systems</h4>
                        <div class="trigger">"We use 7 different systems that don't talk to each other"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> All-in-one platform with native integrations</div>
                    </div>

                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#2 No Calendar Sync</h4>
                        <div class="trigger">"Why can't I see my appointments in Google Calendar?"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> Native two-way Google/Apple/Outlook sync</div>
                    </div>

                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#3 Manual Loyalty Tracking</h4>
                        <div class="trigger">"I have to manually enter Allƒì points for every patient"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> Native Allƒì/ASPIRE integration (first to market!)</div>
                    </div>

                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#4 POS Sync Issues</h4>
                        <div class="trigger">"Inventory is constantly wrong after checkout"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> Real-time inventory deduction from treatment charts</div>
                    </div>

                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#5 No Financing at Checkout</h4>
                        <div class="trigger">"Patients leave because they can't afford treatment upfront"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> Embedded Cherry/PatientFi at checkout</div>
                    </div>

                    <div class="integration-card" style="background: #fff; border-color: #dc3545;">
                        <h4 style="color: #dc3545;">#6 Clunky Rescheduling</h4>
                        <div class="trigger">"Have to cancel and rebook instead of drag-drop"</div>
                        <div class="trigger" style="background: #e7f9ed; border-left-color: #28a745;"><strong>Our Solution:</strong> Drag-drop calendar with conflict detection</div>
                    </div>
                </div>

                <!-- API STRATEGY -->
                <h3 class="section-subtitle">üîß API & Developer Strategy</h3>
                <div class="journey" style="background: #e7f3ff;">
                    <h4 style="color: #2196F3; margin-bottom: 20px;">Open API Philosophy</h4>
                    <div class="journey-step">
                        <div class="journey-number" style="background: #2196F3;">1</div>
                        <div class="journey-content">
                            <h4>Webhooks for Everything</h4>
                            <p>Every event fires a webhook: appointment.created, payment.completed, form.submitted, inventory.low</p>
                        </div>
                    </div>
                    <div class="journey-step">
                        <div class="journey-number" style="background: #2196F3;">2</div>
                        <div class="journey-content">
                            <h4>RESTful API</h4>
                            <p>Full CRUD operations on all resources - patients, appointments, payments, inventory</p>
                        </div>
                    </div>
                    <div class="journey-step">
                        <div class="journey-number" style="background: #2196F3;">3</div>
                        <div class="journey-content">
                            <h4>Zapier Native App</h4>
                            <p>Official Zapier integration - unlike Mangomint, we'll be in the Zapier marketplace</p>
                        </div>
                    </div>
                    <div class="journey-step">
                        <div class="journey-number" style="background: #2196F3;">4</div>
                        <div class="journey-content">
                            <h4>Developer Documentation</h4>
                            <p>Public API docs, SDKs, and sandbox environment for third-party developers</p>
                        </div>
                    </div>
                </div>

                <!-- INTEGRATION ROADMAP -->
                <h3 class="section-subtitle">üìÖ Integration Implementation Roadmap</h3>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.95em;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Phase</th>
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Integrations</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">Effort</th>
                                <th style="padding: 15px; text-align: left; border: 1px solid #ddd;">Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #ffe5e5;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong>MVP (Launch)</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Stripe, Twilio SMS, Google Calendar, Basic Webhooks</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">2-3 weeks</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Can't launch without these</td>
                            </tr>
                            <tr style="background: #fff8e1;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong>Phase 1 (Month 1-2)</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">QuickBooks, Zapier, Cherry/PatientFi, Mailchimp</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">4-6 weeks</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Competitive parity</td>
                            </tr>
                            <tr style="background: #fff8e1;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong>Phase 2 (Month 3-4)</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Allƒì/ASPIRE, Voice AI, Photo Management, Shopify</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">6-8 weeks</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">üéØ Market differentiation</td>
                            </tr>
                            <tr style="background: #e7f9ed;">
                                <td style="padding: 12px; border: 1px solid #ddd;"><strong>Phase 3 (Month 5+)</strong></td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Telehealth, E-Prescribe, Advanced Analytics, RFID Inventory</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Ongoing</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">Enterprise features</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="note" style="background: #e7f9ed; border-color: #28a745; margin-top: 30px;">
                    <strong style="color: #28a745;">Key Insight:</strong> The biggest opportunity is in manufacturer loyalty programs (Allƒì/ASPIRE) and HIPAA-compliant Voice AI. NO competitor does these well. First to market wins.
                </div>

                <!-- SOURCES -->
                <h3 class="section-subtitle" style="margin-top: 40px;">üìö Research Sources</h3>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; font-size: 0.9em;">
                    <p style="margin-bottom: 10px;"><strong>Industry Sources:</strong></p>
                    <ul style="margin-left: 20px; color: #666;">
                        <li><a href="https://www.mangomint.com/learn/managing-your-apps-and-integrations/" target="_blank">Mangomint Apps & Integrations</a></li>
                        <li><a href="https://thesalonbusiness.com/best-medical-spa-software/" target="_blank">The Salon Business - Best Medical Spa Software 2025</a></li>
                        <li><a href="https://aesthetixcrm.com/top-3-online-booking-platforms-for-medical-spas/" target="_blank">Aesthetix CRM - Top Booking Platforms</a></li>
                        <li><a href="https://withcherry.com/medical-aesthetics" target="_blank">Cherry Financing for Med Spas</a></li>
                        <li><a href="https://elevate.aestheticrecord.com/using-brilliant-distinctions-and-aspire-rewards-in-your-practice/" target="_blank">Aesthetic Record - Loyalty Programs</a></li>
                        <li><a href="https://www.keragon.com/blog/med-spa-workflow-automations" target="_blank">Keragon - Med Spa Workflow Automations</a></li>
                        <li><a href="https://workee.net/blog/best-medical-spa-software" target="_blank">Workee - Medical Spa Software Comparison</a></li>
                    </ul>
                    <p style="margin-top: 15px; margin-bottom: 10px;"><strong>Reddit & Forum Research:</strong></p>
                    <ul style="margin-left: 20px; color: #666;">
                        <li>r/Estheticians - Software recommendations threads</li>
                        <li>r/MedSpa - Integration complaints and wishlists</li>
                        <li>G2 & Capterra reviews - User complaints and feature requests</li>
                    </ul>
                    <p style="margin-top: 15px; font-style: italic; color: #999;">Last Updated: December 2025</p>
                </div>
            </div>
        </div>

        <!-- TESTING CHECKLIST TAB -->
        <div class="tab-content" id="testing">
            <div class="section">
                <h2 class="section-title">üß™ Testing Checklist</h2>
                <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    Comprehensive testing checklist for all features. Check items as you test them. Progress is saved locally.
                </p>

                <!-- Express Booking Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #8B5CF6;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üì± Express Booking
                        <span style="background: #8B5CF6; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">NEW</span>
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test the SMS-based quick booking feature</p>

                    <div class="requirements-checklist" id="express-booking-tests">
                        <h4 style="margin-bottom: 10px; color: #555;">Staff Side (Admin)</h4>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to Calendar ‚Üí Click "Express Book" button (purple/pink gradient)</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Enter patient first name, phone number, select service</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Toggle deposit requirement ON/OFF</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Select different expiry times (15m, 30m, 1h, 2h)</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click "Send Booking Link via SMS" ‚Üí Verify success message</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Check your phone - SMS should arrive with booking link</span>
                        </label>

                        <h4 style="margin-top: 20px; margin-bottom: 10px; color: #555;">Patient Side (Mobile)</h4>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click the link in SMS ‚Üí Patient booking page loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Verify appointment details shown (date, time, service, provider)</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Countdown timer visible and counting down</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Fill in form: first name, last name, email, phone</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Accept cancellation policy checkbox</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click "Confirm Booking" ‚Üí Success page appears</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Confirmation SMS received on phone</span>
                        </label>

                        <h4 style="margin-top: 20px; margin-bottom: 10px; color: #555;">Edge Cases</h4>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Wait for link to expire ‚Üí "Link Expired" page shown</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Try to submit without accepting policy ‚Üí Error shown</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Try to use same link after completing ‚Üí "Already completed" message</span>
                        </label>
                    </div>
                </div>

                <!-- Virtual Waiting Room Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #10B981;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üè• Virtual Waiting Room
                        <span style="background: #10B981; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; margin-left: 10px;">COMPLETE</span>
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test the SMS check-in and queue management</p>

                    <div class="requirements-checklist" id="waiting-room-tests">
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /waiting-room ‚Üí Queue dashboard loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /check-in ‚Üí Patient check-in page loads on mobile</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Enter phone number ‚Üí Appointment found</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click "Check In" ‚Üí Patient added to waiting queue</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Staff clicks "Call Patient" ‚Üí SMS sent to patient</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Staff clicks "Mark Checked In" ‚Üí Patient removed from queue</span>
                        </label>
                    </div>
                </div>

                <!-- Messages/SMS Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #3B82F6;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üí¨ Messages & SMS
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test the messaging center and SMS functionality</p>

                    <div class="requirements-checklist" id="messages-tests">
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /messages ‚Üí Conversations list loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click a conversation ‚Üí Messages appear</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Type message ‚Üí Send SMS ‚Üí Message sent (check phone)</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click Quick Reply ‚Üí Message auto-filled</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click "Send Forms" ‚Üí Form templates shown</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Send a form ‚Üí Message with link composed</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Filter: Unread, Today, Post-care ‚Üí List filtered correctly</span>
                        </label>
                    </div>
                </div>

                <!-- Calendar Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #F59E0B;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üìÖ Calendar & Appointments
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test calendar views and appointment management</p>

                    <div class="requirements-checklist" id="calendar-tests">
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /calendar ‚Üí Calendar loads with practitioners</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Switch between Day/Week view</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Navigate: Previous/Next/Today buttons work</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click time slot ‚Üí Appointment modal opens</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Create appointment ‚Üí Appears on calendar</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click appointment ‚Üí Details panel opens</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Add break (lunch/personal) ‚Üí Shows on calendar</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Drag appointment ‚Üí Reschedules correctly</span>
                        </label>
                    </div>
                </div>

                <!-- Patient Management Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #EC4899;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üë• Patient Management
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test patient profiles and management</p>

                    <div class="requirements-checklist" id="patient-tests">
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /patients ‚Üí Patient list loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Search patients ‚Üí Results filter correctly</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Click patient ‚Üí Profile page loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>View tabs: Details, History, Financials, etc.</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Create new patient ‚Üí Form submits successfully</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Edit patient ‚Üí Changes saved</span>
                        </label>
                    </div>
                </div>

                <!-- Billing Tests -->
                <div class="integration-card" style="margin-bottom: 30px; border-left: 5px solid #14B8A6;">
                    <h3 style="color: #333; margin-bottom: 15px;">
                        üí≥ Billing & Payments
                    </h3>
                    <p style="color: #666; margin-bottom: 15px;">Test billing, payments, and packages</p>

                    <div class="requirements-checklist" id="billing-tests">
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /billing ‚Üí Billing page loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Select services ‚Üí Total calculates correctly</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Injectable billing ‚Üí Face chart works, units tracked</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Apply package ‚Üí Discount applied</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Process payment (test mode) ‚Üí Payment succeeds</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Split payment ‚Üí Multiple methods work</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Go to /packages ‚Üí Package list loads</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" onchange="saveTestProgress()">
                            <span>Create package ‚Üí Wizard completes</span>
                        </label>
                    </div>
                </div>

                <!-- Progress Summary -->
                <div style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 25px; border-radius: 15px; margin-top: 40px;">
                    <h3 style="margin-bottom: 15px; color: #333;">üìä Testing Progress</h3>
                    <div id="testing-progress-summary">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="express-booking-progress" style="font-size: 1.5em; font-weight: bold; color: #8B5CF6;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Express Booking</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="waiting-room-progress" style="font-size: 1.5em; font-weight: bold; color: #10B981;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Waiting Room</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="messages-progress" style="font-size: 1.5em; font-weight: bold; color: #3B82F6;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Messages</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="calendar-progress" style="font-size: 1.5em; font-weight: bold; color: #F59E0B;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Calendar</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="patient-progress" style="font-size: 1.5em; font-weight: bold; color: #EC4899;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Patients</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div id="billing-progress" style="font-size: 1.5em; font-weight: bold; color: #14B8A6;">0%</div>
                                <div style="color: #666; font-size: 0.85em;">Billing</div>
                            </div>
                        </div>
                        <button onclick="resetTestProgress()" style="margin-top: 20px; padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer;">
                            üîÑ Reset All Test Progress
                        </button>
                    </div>
                </div>

                <div class="note" style="margin-top: 30px;">
                    <strong>Testing Tips:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Use test phone number: <code>+17652500332</code> for SMS testing</li>
                        <li>Stripe is in test mode - use card <code>4242 4242 4242 4242</code></li>
                        <li>Check browser console (F12) for any errors</li>
                        <li>Progress is saved in your browser - checkboxes persist across sessions</li>
                    </ul>
                </div>
            </div>
        </div>

        <script>
            // Testing progress functions
            function saveTestProgress() {
                const sections = ['express-booking', 'waiting-room', 'messages', 'calendar', 'patient', 'billing'];
                const progress = {};

                sections.forEach(section => {
                    const container = document.getElementById(section + '-tests');
                    if (container) {
                        const checkboxes = container.querySelectorAll('input[type="checkbox"]');
                        progress[section] = Array.from(checkboxes).map(cb => cb.checked);

                        // Update progress display
                        const checked = progress[section].filter(Boolean).length;
                        const total = progress[section].length;
                        const percent = total > 0 ? Math.round((checked / total) * 100) : 0;

                        const progressEl = document.getElementById(section + '-progress');
                        if (progressEl) {
                            progressEl.textContent = percent + '%';
                            progressEl.style.color = percent === 100 ? '#10B981' : percent > 0 ? '#F59E0B' : '#666';
                        }
                    }
                });

                localStorage.setItem('testingProgress', JSON.stringify(progress));
            }

            function loadTestProgress() {
                const saved = localStorage.getItem('testingProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    Object.keys(progress).forEach(section => {
                        const container = document.getElementById(section + '-tests');
                        if (container) {
                            const checkboxes = container.querySelectorAll('input[type="checkbox"]');
                            checkboxes.forEach((cb, index) => {
                                if (progress[section][index] !== undefined) {
                                    cb.checked = progress[section][index];
                                }
                            });
                        }
                    });
                    saveTestProgress(); // Update progress displays
                }
            }

            function resetTestProgress() {
                if (confirm('Reset all testing progress? This cannot be undone.')) {
                    localStorage.removeItem('testingProgress');
                    document.querySelectorAll('#testing input[type="checkbox"]').forEach(cb => cb.checked = false);
                    saveTestProgress();
                }
            }

            // Load test progress on page load
            document.addEventListener('DOMContentLoaded', loadTestProgress);

            // Tab switching functionality
            const tabs = document.querySelectorAll('.nav-tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.remove('active'));

                    // Add active class to clicked tab and corresponding content
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');

                    // Smooth scroll to top of content
                    document.getElementById(tabId).scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });

            // Edge cases collapsible functionality
            const edgeCaseHeaders = document.querySelectorAll('.edge-cases-header');

            edgeCaseHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;

                    // Toggle collapsed class on header
                    header.classList.toggle('collapsed');

                    // Toggle expanded class on content
                    content.classList.toggle('expanded');
                });
            });

            // Print functionality
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                    e.preventDefault();
                    window.print();
                }
            });

            // Expand all edge cases for printing
            window.addEventListener('beforeprint', () => {
                document.querySelectorAll('.edge-cases-content').forEach(content => {
                    content.classList.add('expanded');
                });
            });

            // Collapse edge cases after printing (restore previous state)
            window.addEventListener('afterprint', () => {
                document.querySelectorAll('.edge-cases-header').forEach(header => {
                    if (header.classList.contains('collapsed')) {
                        header.nextElementSibling.classList.remove('expanded');
                    }
                });
            });

            // Implementation Roadmap functions
            function toggleFeatureDetails() {
                const details = document.getElementById('feature-details');
                const btn = event.target;

                if (details.style.display === 'none') {
                    details.style.display = 'block';
                    btn.textContent = '‚ñ≤ Hide Full Specs';
                } else {
                    details.style.display = 'none';
                    btn.textContent = 'üìã View Full Specs & Checklist';
                }
            }

            function updateProgress() {
                const checkboxes = document.querySelectorAll('.requirements-checklist input[type="checkbox"]');
                const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
                const total = checkboxes.length;
                const percent = Math.round((checked / total) * 100);

                const progressBar = document.querySelector('.progress-bar-fill');
                const statusBadge = document.querySelector('.status-badge');

                progressBar.style.width = percent + '%';
                progressBar.textContent = percent + '% Complete';

                // Update status badge
                if (percent === 100) {
                    statusBadge.className = 'status-badge status-complete';
                    statusBadge.textContent = 'üü¢ Complete!';
                } else if (percent >= 60) {
                    statusBadge.className = 'status-badge status-in-progress';
                    statusBadge.textContent = 'üü° In Progress (' + percent + '%)';
                } else if (percent > 0) {
                    statusBadge.className = 'status-badge status-in-progress';
                    statusBadge.textContent = 'üü° In Progress (' + percent + '%)';
                } else {
                    statusBadge.className = 'status-badge status-not-started';
                    statusBadge.textContent = 'üî¥ Not Started';
                }

                // Save progress to localStorage
                localStorage.setItem('currentFeatureProgress', JSON.stringify({
                    checked: Array.from(checkboxes).map(cb => cb.checked),
                    percent: percent
                }));
            }

            function toggleSection(sectionId) {
                const section = document.getElementById(sectionId);
                if (section.style.display === 'none' || section.style.display === '') {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            }

            function switchTab(tabId) {
                // Remove active from all tabs
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                // Add active to selected
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(tabId).classList.add('active');

                // Scroll to top
                document.getElementById(tabId).scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            function promoteToCurrently(queuePosition) {
                alert('Feature promotion coming soon! For now, manually update the "Currently Building" section to work on this feature.');
            }

            // Load saved progress on page load
            window.addEventListener('DOMContentLoaded', () => {
                const saved = localStorage.getItem('currentFeatureProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    const checkboxes = document.querySelectorAll('.requirements-checklist input[type="checkbox"]');
                    checkboxes.forEach((cb, i) => {
                        if (progress.checked[i]) {
                            cb.checked = true;
                        }
                    });
                    updateProgress();
                }
            });
        </script>
    </div>
</body>
</html>