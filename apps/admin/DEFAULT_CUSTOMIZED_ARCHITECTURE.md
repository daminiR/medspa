# Default vs Customized - Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USER                                    â”‚
â”‚                                                                       â”‚
â”‚  Actions: Modify template, Click reset, Toggle settings             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER INTERFACE LAYER                             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  MessageCard Component                       â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Props:                                                       â”‚   â”‚
â”‚  â”‚    â€¢ isUsingDefaults: boolean                               â”‚   â”‚
â”‚  â”‚    â€¢ onResetToDefaults: () => void                          â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Visual Output:                                               â”‚   â”‚
â”‚  â”‚    â€¢ Badge: "Default" (green) or "Customized" (blue)        â”‚   â”‚
â”‚  â”‚    â€¢ Reset Button (when customized + expanded)               â”‚   â”‚
â”‚  â”‚    â€¢ Success Banner (when default + expanded)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Tab Components                               â”‚   â”‚
â”‚  â”‚              (CheckInTab, etc.)                               â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Responsibilities:                                            â”‚   â”‚
â”‚  â”‚    â€¢ Import and use useAutomatedMessages hook                â”‚   â”‚
â”‚  â”‚    â€¢ Initialize state from hook settings                     â”‚   â”‚
â”‚  â”‚    â€¢ Pass isUsingDefaults to MessageCard                     â”‚   â”‚
â”‚  â”‚    â€¢ Implement reset handlers                                â”‚   â”‚
â”‚  â”‚    â€¢ Update hook when user modifies settings                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BUSINESS LOGIC LAYER                             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           useAutomatedMessages() Hook                        â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  State:                                                       â”‚   â”‚
â”‚  â”‚    â€¢ settings: Record<string, AutomatedMessageConfig>       â”‚   â”‚
â”‚  â”‚    â€¢ isLoading: boolean                                      â”‚   â”‚
â”‚  â”‚    â€¢ error: string | null                                    â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Functions:                                                   â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚ isUsingDefaults(eventType)                     â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Deep compares current vs default         â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Returns true if match                    â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚ resetToDefaults(eventType)                     â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Gets default config                      â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Replaces current with default            â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Saves to localStorage                    â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚ updateSettings(eventType, config)              â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Merges new config with existing          â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Saves to localStorage                    â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Triggers re-render                       â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚ getSettings(eventType)                         â”‚       â”‚   â”‚
â”‚  â”‚    â”‚  â””â”€> Returns current config for event         â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Internal:                                                    â”‚   â”‚
â”‚  â”‚    â€¢ getDefaultSettings() - Factory for defaults             â”‚   â”‚
â”‚  â”‚    â€¢ Deep comparison logic (JSON.stringify)                  â”‚   â”‚
â”‚  â”‚    â€¢ Error handling                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PERSISTENCE LAYER                                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      localStorage                            â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Key: 'automatedMessageSettings'                            â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Value: {                                                     â”‚   â”‚
â”‚  â”‚    appointment_booked: { config... },                        â”‚   â”‚
â”‚  â”‚    check_in_reminder: { config... },                         â”‚   â”‚
â”‚  â”‚    patient_waiting: { config... },                           â”‚   â”‚
â”‚  â”‚    provider_ready: { config... },                            â”‚   â”‚
â”‚  â”‚    ...                                                        â”‚   â”‚
â”‚  â”‚  }                                                            â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  Operations:                                                  â”‚   â”‚
â”‚  â”‚    â€¢ Save: JSON.stringify + setItem                          â”‚   â”‚
â”‚  â”‚    â€¢ Load: getItem + JSON.parse                              â”‚   â”‚
â”‚  â”‚    â€¢ Clear: removeItem                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagrams

### Flow 1: Initial Page Load

```
User Opens Page
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component   â”‚
â”‚ Mounts      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useAutomatedMessagesâ”‚
â”‚ Hook Initializes    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load from          â”‚
â”‚ localStorage       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ Found? â”€â”€â”€â”
       â”‚              â”‚
       â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  NO   â”‚    â”‚    YES     â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚
       â–¼              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ Use Defaults â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
       â”‚              â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Set State     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Compare with  â”‚
      â”‚ Defaults      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Render Badge  â”‚
      â”‚ "Default"     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flow 2: User Modifies Template

```
User Edits Template
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onChange Event  â”‚
â”‚ Fires          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tab Component    â”‚
â”‚ Updates State    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Calls            â”‚
â”‚ updateSettings() â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hook Merges      â”‚
â”‚ New Config       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to          â”‚
â”‚ localStorage     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Trigger          â”‚
â”‚ Re-render        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hook Compares    â”‚
â”‚ with Defaults    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Returns false    â”‚
â”‚ (not default)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Badge Changes to â”‚
â”‚ "Customized"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flow 3: User Clicks Reset

```
User Clicks Reset Button
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onResetToDefaultsâ”‚
â”‚ Handler Fires    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Calls            â”‚
â”‚ resetToDefaults()â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hook Gets        â”‚
â”‚ Default Config   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Replace Current  â”‚
â”‚ with Default     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to          â”‚
â”‚ localStorage     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler Gets     â”‚
â”‚ Fresh Defaults   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update ALL       â”‚
â”‚ Local State      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component        â”‚
â”‚ Re-renders       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hook Compares    â”‚
â”‚ with Defaults    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Returns true     â”‚
â”‚ (is default)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Badge Changes to â”‚
â”‚ "Default"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

```
Page: /settings/automated-messages
â”‚
â”œâ”€ Navigation
â”‚
â”œâ”€ Header
â”‚  â”œâ”€ Title: "Automated Messages"
â”‚  â””â”€ Mode Toggle: Simple/Advanced
â”‚
â”œâ”€ Tab Navigation
â”‚  â”œâ”€ Appointment Booked
â”‚  â”œâ”€ Appointment Canceled
â”‚  â”œâ”€ Check-In (âœ… Implemented)
â”‚  â”œâ”€ Form Submitted
â”‚  â”œâ”€ Waitlist
â”‚  â”œâ”€ Sale Closed
â”‚  â”œâ”€ Gift Cards
â”‚  â””â”€ Memberships
â”‚
â””â”€ Tab Content (Example: CheckInTab)
   â”‚
   â”œâ”€ useAutomatedMessages() Hook ğŸ”Œ
   â”‚  â”‚
   â”‚  â”œâ”€ getSettings('check_in_reminder')
   â”‚  â”œâ”€ isUsingDefaults('check_in_reminder') âœ“
   â”‚  â””â”€ resetToDefaults('check_in_reminder') â†»
   â”‚
   â”œâ”€ MessageCard: Pre-Arrival
   â”‚  â”‚
   â”‚  â”œâ”€ Props:
   â”‚  â”‚  â”œâ”€ isUsingDefaults={hook.isUsingDefaults('check_in_reminder')}
   â”‚  â”‚  â””â”€ onResetToDefaults={handleResetPreArrival}
   â”‚  â”‚
   â”‚  â”œâ”€ Badge Rendering Logic
   â”‚  â”‚  â”œâ”€ If collapsed + default â†’ [Default âœ“]
   â”‚  â”‚  â””â”€ If collapsed + custom â†’ [Customized]
   â”‚  â”‚
   â”‚  â”œâ”€ Expanded Content
   â”‚  â”‚  â”œâ”€ If default â†’ Success Banner
   â”‚  â”‚  â”œâ”€ If custom â†’ Reset Button
   â”‚  â”‚  â””â”€ MessageEditor
   â”‚  â”‚
   â”‚  â””â”€ Children
   â”‚     â”œâ”€ Timing Configuration
   â”‚     â”œâ”€ MessageEditor Component
   â”‚     â””â”€ Custom Instructions
   â”‚
   â”œâ”€ MessageCard: Patient Waiting
   â”‚  â””â”€ (Same structure)
   â”‚
   â””â”€ MessageCard: Provider Ready
      â””â”€ (Same structure)
```

---

## State Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  State Layers                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Hook State (Source of Truth)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useAutomatedMessages                                     â”‚
â”‚                                                          â”‚
â”‚ settings: {                                              â”‚
â”‚   check_in_reminder: {                                   â”‚
â”‚     enabled: true,                                       â”‚
â”‚     template: { body: '...', variables: [] },            â”‚
â”‚     timing: { type: 'before', value: 1, unit: 'hours' } â”‚
â”‚   }                                                      â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†• (sync)
Layer 2: Component State (UI State)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CheckInTab                                               â”‚
â”‚                                                          â”‚
â”‚ const [preArrivalEnabled, setPreArrivalEnabled]          â”‚
â”‚ const [preArrivalTemplate, setPreArrivalTemplate]        â”‚
â”‚ const [preArrivalMinutes, setPreArrivalMinutes]          â”‚
â”‚                                                          â”‚
â”‚ Initialized from: getSettings('check_in_reminder')       â”‚
â”‚ Updated via: updateSettings('check_in_reminder', {...})  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†• (render)
Layer 3: Visual State (What User Sees)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MessageCard                                              â”‚
â”‚                                                          â”‚
â”‚ if (isUsingDefaults) {                                   â”‚
â”‚   Badge: "Default" (green)                               â”‚
â”‚   Banner: "Using Recommended Settings"                   â”‚
â”‚ } else {                                                 â”‚
â”‚   Badge: "Customized" (blue)                             â”‚
â”‚   Button: "Reset to Recommended Settings"                â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Comparison Logic

```
isUsingDefaults(eventType) Function
â”‚
â”œâ”€ Get current config from state
â”‚  â””â”€ settings[eventType]
â”‚
â”œâ”€ Get default config from factory
â”‚  â””â”€ getDefaultSettings()[eventType]
â”‚
â”œâ”€ Deep comparison
â”‚  â”œâ”€ JSON.stringify(current)
â”‚  â”œâ”€ JSON.stringify(default)
â”‚  â””â”€ Compare strings
â”‚
â””â”€ Return result
   â”œâ”€ true â†’ Configs match (using defaults)
   â””â”€ false â†’ Configs differ (customized)

Example Comparison:

Current:
{
  enabled: true,
  template: {
    body: "Hi {firstName}, your appointment is in 30 minutes...",
    variables: ['{firstName}']
  },
  timing: { type: 'before', value: 30, unit: 'minutes' }
}

Default:
{
  enabled: true,
  template: {
    body: "Hi {firstName}, your appointment is in 1 hour...",
    variables: ['{firstName}']
  },
  timing: { type: 'before', value: 1, unit: 'hours' }
}

Result: false (customized)
Reason: timing.value differs (30 vs 60 when converted)
```

---

## Reset Process

```
Reset Button Clicked
â”‚
â”œâ”€ Step 1: Call resetToDefaults(eventType)
â”‚  â”‚
â”‚  â”œâ”€ Fetch default config from factory
â”‚  â”œâ”€ Replace current[eventType] with default
â”‚  â””â”€ Save to localStorage
â”‚
â”œâ”€ Step 2: Get fresh defaults
â”‚  â”‚
â”‚  â””â”€ const defaults = getSettings(eventType)
â”‚
â”œâ”€ Step 3: Update component state
â”‚  â”‚
â”‚  â”œâ”€ setEnabled(defaults.enabled)
â”‚  â”œâ”€ setTemplate(defaults.template)
â”‚  â”œâ”€ setTiming(defaults.timing)
â”‚  â””â”€ setOtherFields(defaults.otherFields)
â”‚
â”œâ”€ Step 4: Component re-renders
â”‚  â”‚
â”‚  â””â”€ All inputs show default values
â”‚
â”œâ”€ Step 5: Hook re-compares
â”‚  â”‚
â”‚  â””â”€ isUsingDefaults() returns true
â”‚
â””â”€ Step 6: Visual update
   â”‚
   â”œâ”€ Badge changes: "Customized" â†’ "Default"
   â””â”€ Button disappears, Success banner appears
```

---

## Badge Decision Tree

```
MessageCard Render
â”‚
â”œâ”€ Is card expanded?
â”‚  â”‚
â”‚  â”œâ”€ NO (Collapsed)
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Is using defaults?
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ YES
â”‚  â”‚  â”‚  â”‚  â””â”€ Show: [Default âœ“] (green)
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ NO
â”‚  â”‚  â”‚     â””â”€ Show: [Customized] (blue)
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ Also show: [SMS/Email icons] [Toggle]
â”‚  â”‚
â”‚  â””â”€ YES (Expanded)
     â”‚
     â”œâ”€ Is using defaults?
     â”‚  â”‚
     â”‚  â”œâ”€ YES
     â”‚  â”‚  â””â”€ Show: Success Banner (green)
     â”‚  â”‚       "Using Recommended Settings"
     â”‚  â”‚
     â”‚  â””â”€ NO
     â”‚     â””â”€ Show: Reset Button
     â”‚          "Reset to Recommended Settings"
     â”‚
     â””â”€ Show: [Editor Content]
```

---

## Summary

The architecture is:
- **Clean** - Separation of concerns
- **Simple** - Minimal complexity
- **Efficient** - Fast comparisons, client-side
- **Reliable** - Persistent state, error handling
- **Reusable** - Same pattern across all tabs
- **Maintainable** - Centralized logic in hook

Everything flows from:
1. Hook manages data
2. Component manages UI state
3. MessageCard renders visuals
4. localStorage provides persistence

The pattern is proven and working in CheckInTab! ğŸ‰
